<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ­å·è‡ªå®¶å°çŒ«å’ª-æå…ˆç”Ÿ - å® ç‰©ç¤¾åŒºå¹³å°</title>
    
    <!-- åœ°å›¾API -->
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=0d3b3b8f6e6e4f7b9a6e6e6e6e6e6e6&plugin=AMap.Geolocation,AMap.PlaceSearch,AMap.Geocoder,AMap.ToolBar,AMap.Autocomplete,AMap.Driving"></script>
    
    <style>
        /* è‹¹æœé£æ ¼å…¨å±€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* è‹¹æœé£æ ¼é…è‰² */
            --apple-black: #1d1d1f;
            --apple-gray-light: #f5f5f7;
            --apple-gray-medium: #86868b;
            --apple-gray-dark: #6e6e73;
            --apple-blue: #0071e3;
            --apple-blue-hover: #0051d5;
            --apple-green: #34c759;
            --apple-orange: #ff9500;
            --apple-red: #ff3b30;
            --apple-purple: #af52de;
            --apple-white: #fbfbfd;
            --apple-border: #d2d2d7;
            
            /* å­—ä½“ç³»ç»Ÿ */
            --font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            
            /* é—´è·ç³»ç»Ÿ */
            --spacing-xs: 8px;
            --spacing-sm: 16px;
            --spacing-md: 32px;
            --spacing-lg: 48px;
            --spacing-xl: 64px;
            --spacing-xxl: 96px;
            
            /* åœ†è§’ */
            --border-radius-sm: 6px;
            --border-radius-md: 12px;
            --border-radius-lg: 18px;
            
            /* é˜´å½± */
            --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.05);
            --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.12);
            --shadow-heavy: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: var(--font-family);
            background: linear-gradient(135deg, #FFF8E1 0%, #FFE0B2 100%);
            color: var(--apple-black);
            line-height: 1.47059;
            font-weight: 400;
            letter-spacing: -0.022em;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
        }

        /* å®¹å™¨ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-sm);
        }

        /* å¯¼èˆªæ  */
        .nav {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--apple-border);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1001;
            box-shadow: var(--shadow-light);
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px;
        }

        .nav-menu {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-link {
            text-decoration: none;
            color: var(--apple-black);
            font-weight: 500;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius-sm);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-link:hover {
            background: var(--apple-gray-light);
            color: var(--apple-blue);
        }

        .nav-link.active {
            color: var(--apple-blue);
            background: rgba(0, 113, 227, 0.1);
        }

        /* é¡µé¢å®¹å™¨ */
        .page {
            display: none;
            padding: var(--spacing-lg) var(--spacing-md);
            min-height: 100vh;
            margin-top: 60px;
            padding-bottom: 80px; /* ç»™åº•éƒ¨æŒ‰é’®ç•™ç©ºé—´ */
        }

        .page.active {
            display: block;
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: white;
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
            cursor: pointer;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
        }

        .card h3 {
            color: var(--apple-black);
            margin-bottom: var(--spacing-xs);
        }

        /* ç½‘æ ¼å¸ƒå±€ */
        .grid {
            display: grid;
            gap: var(--spacing-md);
            margin-top: var(--spacing-md);
        }

        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius-sm);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            min-height: 44px;
        }

        .btn-primary {
            background: var(--apple-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--apple-blue-hover);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--apple-gray-light);
            color: var(--apple-black);
        }

        .btn-secondary:hover {
            background: var(--apple-gray-medium);
            color: white;
        }

        /* è¾“å…¥æ¡†æ ·å¼ */
        .input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--apple-border);
            border-radius: var(--border-radius-sm);
            font-size: 16px;
            background: white;
            transition: all 0.3s ease;
            min-height: 44px;
        }

        .input:focus {
            outline: none;
            border-color: var(--apple-blue);
            box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.1);
        }

        /* è¡¨å•ç»„ */
        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-group label {
            display: block;
            margin-bottom: var(--spacing-xs);
            font-weight: 600;
            color: var(--apple-black);
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius-lg);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-heavy);
        }

        .modal-header {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--apple-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: var(--spacing-md);
        }

        .modal-footer {
            padding: var(--spacing-md);
            border-top: 1px solid var(--apple-border);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
        }

        /* ä¸ªäººä¸­å¿ƒèœå•é¡¹æ ·å¼ */
        .menu-item {
            display: flex;
            align-items: center;
            padding: var(--spacing-sm) var(--spacing-md);
            cursor: pointer;
            border-radius: var(--border-radius-sm);
            transition: background-color 0.2s ease;
            margin-bottom: var(--spacing-xs);
        }

        .menu-item:hover {
            background-color: var(--apple-gray-light);
        }

        .menu-item:last-child {
            margin-bottom: 0;
        }

        .menu-icon {
            font-size: 18px;
            width: 24px;
            text-align: center;
            margin-right: var(--spacing-sm);
        }

        .menu-text {
            flex: 1;
            font-size: 16px;
        }

        .menu-arrow {
            color: var(--apple-gray-medium);
            font-size: 14px;
        }

        /* Toasté€šçŸ¥ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: var(--border-radius-sm);
            color: white;
            font-weight: 600;
            z-index: 2000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            box-shadow: var(--shadow-medium);
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.success {
            background: var(--apple-green);
        }

        .toast.error {
            background: var(--apple-red);
        }

        .toast.info {
            background: var(--apple-blue);
        }

        /* ç®¡ç†å‘˜æŒ‰é’®æ ·å¼ */
        .admin-btn {
            background-color: var(--apple-red) !important;
            color: white !important;
        }

        .admin-btn:hover {
            background-color: #d32f2f !important;
        }

        .admin-btn span:first-child {
            margin-right: 4px;
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }

            .mobile-nav-toggle {
                display: block;
                background: none;
                border: none;
                font-size: 24px;
                cursor: pointer;
                color: var(--apple-black);
            }

            /* ç§»åŠ¨ç«¯å¿«æ·å¯¼èˆª */
            .mobile-quick-nav {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                border-top: 1px solid var(--apple-border);
                display: flex;
                justify-content: space-around;
                padding: var(--spacing-xs) 0;
                z-index: 998;
                box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            }

            .mobile-quick-nav-item {
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 4px;
                padding: var(--spacing-xs);
                text-decoration: none;
                color: var(--apple-gray-medium);
                font-size: 12px;
                cursor: pointer;
                transition: color 0.3s ease;
            }

            .mobile-quick-nav-item.active {
                color: var(--apple-blue);
            }

            .mobile-quick-nav-item:hover {
                color: var(--apple-blue);
            }

            .mobile-quick-nav-item span:first-child {
                font-size: 20px;
            }

            .grid-3 {
                grid-template-columns: 1fr;
            }

            .grid-2 {
                grid-template-columns: 1fr;
            }

            .category-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .container {
                padding: 0 12px;
            }

            .nav-content {
                padding: 0 var(--spacing-sm);
            }

            .modal-content {
                width: 95%;
                max-height: 90vh;
                margin: 20px auto;
            }

            /* ç§»åŠ¨ç«¯æµ®åŠ¨æŒ‰é’®è°ƒæ•´ */
            .fab {
                bottom: 85px; /* é¿å…é®æŒ¡åº•éƒ¨å¯¼èˆªï¼Œå¢åŠ é—´è· */
                right: 20px;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                background: var(--apple-blue);
                color: white;
                border: none;
                font-size: 20px;
                cursor: pointer;
                box-shadow: var(--shadow-heavy);
                z-index: 996; /* é™ä½z-indexï¼Œé¿å…è¦†ç›–å¯¼èˆª */
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

        /* æ¡Œé¢ç«¯éšè—ç§»åŠ¨ç«¯å¯¼èˆª */
        @media (min-width: 769px) {
            .mobile-quick-nav {
                display: none;
            }
        }

        .mobile-nav-toggle {
            display: none;
        }

        /* ç§»åŠ¨ç«¯å¯¼èˆªé®ç½© */
        .mobile-nav-overlay {
            position: fixed;
            top: 60px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 998;
        }

        .mobile-nav-overlay.active {
            display: block;
        }

        /* æ ‡é¢˜æ ·å¼ */
        h1 {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: var(--spacing-md);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }

        h2 {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: var(--spacing-md);
            color: var(--apple-black);
        }

        h3 {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            color: var(--apple-black);
        }

        /* æ®µè½ */
        p {
            margin-bottom: var(--spacing-sm);
            color: var(--apple-gray-dark);
            line-height: 1.6;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--apple-border);
            border-top-color: var(--apple-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* è®ºå›æ ·å¼ - å°çº¢ä¹¦é£æ ¼ */
        .post-card {
            background: white;
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-light);
            margin-bottom: var(--spacing-md);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .post-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .post-header {
            display: flex;
            align-items: center;
            padding: var(--spacing-sm);
            border-bottom: 1px solid var(--apple-border);
        }

        .post-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--apple-blue), var(--apple-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            margin-right: var(--spacing-sm);
        }

        .post-info {
            flex: 1;
        }

        .post-author {
            font-weight: 600;
            color: var(--apple-black);
            font-size: 14px;
        }

        .post-time {
            color: var(--apple-gray-medium);
            font-size: 12px;
        }

        .post-content {
            padding: var(--spacing-md);
        }

        .post-images {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: var(--spacing-xs);
            margin-top: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
        }

        .post-image {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: var(--border-radius-sm);
        }

        .post-actions {
            display: flex;
            justify-content: space-around;
            padding: var(--spacing-sm);
            border-top: 1px solid var(--apple-border);
        }

        .post-action-btn {
            background: none;
            border: none;
            color: var(--apple-gray-medium);
            cursor: pointer;
            font-size: 14px;
            padding: var(--spacing-xs);
            border-radius: var(--border-radius-sm);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .post-action-btn:hover {
            background: var(--apple-gray-light);
            color: var(--apple-black);
        }

        .post-action-btn.liked {
            color: var(--apple-red);
        }

        /* å•†åŸåˆ†ç±»æ ·å¼ */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .category-card {
            background: white;
            border-radius: var(--border-radius-md);
            padding: var(--spacing-md);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
        }

        .category-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
        }

        .category-icon {
            font-size: 48px;
            margin-bottom: var(--spacing-sm);
        }

        /* å³ä¸‹è§’æµ®åŠ¨æŒ‰é’® */
        .fab {
            position: fixed;
            bottom: 80px; /* é¿å…é®æŒ¡åº•éƒ¨å¯¼èˆª */
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--apple-blue);
            color: white;
            border: none;
            font-size: 20px;
            cursor: pointer;
            box-shadow: var(--shadow-heavy);
            z-index: 997; /* ç¡®ä¿ä¸ä¼šè¦†ç›–å¯¼èˆª */
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .fab:hover {
            background: var(--apple-blue-hover);
            transform: scale(1.1);
        }

        /* åœ°å›¾æ ·å¼ */
        .map-container {
            height: 400px;
            background: var(--apple-gray-light);
            border-radius: var(--border-radius-md);
            margin-bottom: var(--spacing-md);
            position: relative;
        }

        .hospital-card {
            background: white;
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-light);
            margin-bottom: var(--spacing-sm);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .hospital-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .hospital-header {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--apple-border);
        }

        .hospital-name {
            font-weight: 600;
            font-size: 18px;
            margin-bottom: var(--spacing-xs);
            color: var(--apple-black);
        }

        .hospital-info {
            color: var(--apple-gray-dark);
            font-size: 14px;
            line-height: 1.5;
        }

        .hospital-rating {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
            margin-top: var(--spacing-xs);
        }

        .rating-stars {
            color: var(--apple-orange);
        }

        .hospital-actions {
            padding: var(--spacing-sm);
            display: flex;
            gap: var(--spacing-sm);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }

        /* æŠ˜å è¯„è®ºæ ·å¼ */
        .comments-section {
            max-height: 200px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .comments-section.expanded {
            max-height: none;
        }

        .comment-item {
            padding: var(--spacing-sm);
            border-bottom: 1px solid var(--apple-border);
        }

        .comment-author {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .comment-content {
            color: var(--apple-gray-dark);
            font-size: 14px;
            margin-bottom: 4px;
        }

        .comment-time {
            color: var(--apple-gray-medium);
            font-size: 12px;
        }

        .expand-comments {
            text-align: center;
            padding: var(--spacing-sm);
            background: var(--apple-gray-light);
            cursor: pointer;
            font-size: 14px;
            color: var(--apple-blue);
            transition: background 0.3s ease;
        }

        .expand-comments:hover {
            background: var(--apple-gray-medium);
            color: white;
        }

        /* æ¨¡æ€æ¡†å¢å¼º */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(10px);
        }

        .modal-overlay.active {
            display: flex !important;
            align-items: center;
            justify-content: center;
            z-index: 10000 !important;
        }

        /* ç™»å½•æ¨¡æ€æ¡†ç‰¹æ®Šæ ·å¼ */
        #loginModal.modal-overlay.active {
            z-index: 10001 !important;
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="nav" style="position: fixed; top: 0; left: 0; right: 0; z-index: 1000;">
        <div class="container">
            <div class="nav-content">
                <div style="display: flex; align-items: center; gap: var(--spacing-sm);">
                    <span style="font-size: 24px;">ğŸ±</span>
                    <span style="font-weight: 700; font-size: 18px;">é‡‘çŒ«ä¹‹å®¶</span>
                </div>
                
                <div class="nav-menu" id="navMenu">
                    <a href="#" class="nav-link active" data-page="home" onclick="showPageAndCloseMenu('home', this)">é¦–é¡µ</a>
                    <a href="#" class="nav-link" data-page="cats" onclick="showPageAndCloseMenu('cats', this)">çŒ«å’ªç®¡ç†</a>
                    <a href="#" class="nav-link" data-page="hospital" onclick="showPageAndCloseMenu('hospital', this)">å® ç‰©åŒ»é™¢</a>
                    <a href="#" class="nav-link" data-page="logistics" onclick="showPageAndCloseMenu('logistics', this)">ç‰©æµæŸ¥è¯¢</a>
                    <a href="#" class="nav-link" data-page="forum" onclick="showPageAndCloseMenu('forum', this)">è®ºå›äº¤æµ</a>
                    <a href="#" class="nav-link" data-page="shop" onclick="showPageAndCloseMenu('shop', this)">å® ç‰©å•†åŸ</a>
                    <a href="#" class="nav-link" data-page="profile" onclick="showPageAndCloseMenu('profile', this)">ä¸ªäººä¸­å¿ƒ</a>
                </div>

                <div style="display: flex; align-items: center; gap: var(--spacing-sm); z-index: 1002; position: relative;">
                    <button class="mobile-nav-toggle" onclick="toggleMobileMenu()" style="z-index: 1004; position: relative; pointer-events: auto;">â˜°</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- ç§»åŠ¨ç«¯å¯¼èˆªé®ç½© -->
    <div class="mobile-nav-overlay" id="mobileNavOverlay" onclick="closeMobileMenu()"></div>

    <!-- é¦–é¡µ -->
    <div id="home" class="page active">
        <div class="container">
            <h1>ğŸ± é‡‘çŒ«ä¹‹å®¶</h1>
            <p style="text-align: center; font-size: 18px; margin-bottom: var(--spacing-lg);">
                æ­å·è‡ªå®¶å°çŒ«å’ª-æå…ˆç”Ÿçš„å® ç‰©ç¤¾åŒºå¹³å°
            </p>
            
            <!-- åŠŸèƒ½ç½‘æ ¼ -->
            <div class="grid grid-3">
                <div class="card" onclick="showPage('cats')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ±</div>
                        <h3>çŒ«å’ªç®¡ç†</h3>
                        <p>ç®¡ç†æ‚¨çš„çŒ«å’ªä¿¡æ¯ã€å¥åº·è®°å½•å’Œæ—¥å¸¸æŠ¤ç†</p>
                    </div>
                </div>
                
                <div class="card" onclick="showPage('hospital')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ¥</div>
                        <h3>å® ç‰©åŒ»é™¢</h3>
                        <p>æŸ¥æ‰¾é™„è¿‘çš„å® ç‰©åŒ»é™¢å’ŒåŒ»ç–—æœåŠ¡</p>
                    </div>
                </div>
                
                <div class="card" onclick="showPage('logistics')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ“¦</div>
                        <h3>ç‰©æµæŸ¥è¯¢</h3>
                        <p>æŸ¥è¯¢å® ç‰©ç”¨å“ç‰©æµä¿¡æ¯</p>
                    </div>
                </div>
                
                <div class="card" onclick="showPage('forum')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ’¬</div>
                        <h3>è®ºå›äº¤æµ</h3>
                        <p>ä¸å…¶ä»–å® ç‰©ä¸»äººäº¤æµç»éªŒ</p>
                    </div>
                </div>
                
                <div class="card" onclick="showPage('shop')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ›ï¸</div>
                        <h3>å® ç‰©å•†åŸ</h3>
                        <p>è´­ä¹°å® ç‰©ç”¨å“å’ŒæœåŠ¡</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- çŒ«å’ªç®¡ç†é¡µé¢ -->
    <div id="cats" class="page">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-md);">
                <h2>ğŸ± çŒ«å’ªç®¡ç†</h2>
                <div id="catManagementButtons" style="display: none;">
                    <button class="btn btn-primary" onclick="addCat()">+ æ·»åŠ çŒ«å’ª</button>
                </div>
                <div id="catUserHint" style="color: var(--apple-gray-medium); font-size: 14px;">
                    æ™®é€šç”¨æˆ·åªèƒ½æŸ¥çœ‹çŒ«å’ªä¿¡æ¯
                </div>
            </div>
            <div id="catList" class="grid grid-2">
                <!-- çŒ«å’ªåˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- å•†åŸç®¡ç†æ¨¡æ€æ¡† -->
    <div id="shopManagerModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>å•†å“ç®¡ç†</h3>
                <button class="btn btn-secondary" onclick="closeShopManager()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>å•†å“åç§°</label>
                    <input type="text" class="input" id="productName" placeholder="è¯·è¾“å…¥å•†å“åç§°...">
                </div>
                <div class="form-group">
                    <label>å•†å“åˆ†ç±»</label>
                    <select class="input" id="productCategory">
                        <option value="çŒ«ç²®">çŒ«ç²®</option>
                        <option value="çŒ«ç©å…·">çŒ«ç©å…·</option>
                        <option value="çŒ«ç ‚">çŒ«ç ‚</option>
                        <option value="çŒ«çª">çŒ«çª</option>
                        <option value="çŒ«æŠ¤ç†">çŒ«æŠ¤ç†</option>
                        <option value="çŒ«ä¿å¥å“">çŒ«ä¿å¥å“</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>å•†å“ä»·æ ¼</label>
                    <input type="text" class="input" id="productPrice" placeholder="è¯·è¾“å…¥ä»·æ ¼ï¼ˆå¦‚ï¼š29ï¼‰">
                </div>
                <div class="form-group">
                    <label>æ·˜å®é“¾æ¥</label>
                    <input type="text" class="input" id="productTaobaoUrl" placeholder="è¯·è¾“å…¥æ·˜å®å•†å“é“¾æ¥...">
                </div>
                <div class="form-group">
                    <label>å•†å“å›¾æ ‡</label>
                    <select class="input" id="productIcon">
                        <option value="ğŸ¥«">ğŸ¥« çŒ«ç²®</option>
                        <option value="ğŸ§¶">ğŸ§¶ ç©å…·</option>
                        <option value="ğŸ§¼">ğŸ§¼ çŒ«ç ‚</option>
                        <option value="ğŸ ">ğŸ  çŒ«çª</option>
                        <option value="ğŸ§´">ğŸ§´ æŠ¤ç†</option>
                        <option value="ğŸ’Š">ğŸ’Š ä¿å¥å“</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>å•†å“æè¿°</label>
                    <textarea class="input" id="productDescription" rows="3" placeholder="è¯·è¾“å…¥å•†å“æè¿°..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeShopManager()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveProduct()">ä¿å­˜å•†å“</button>
            </div>
        </div>
    </div>

    <!-- åŒ»é™¢ç®¡ç†æ¨¡æ€æ¡† -->
    <div id="hospitalManagerModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æ·»åŠ åŒ»é™¢</h3>
                <button class="btn btn-secondary" onclick="closeHospitalManager()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>åŒ»é™¢åç§°</label>
                    <input type="text" class="input" id="hospitalName" placeholder="è¯·è¾“å…¥åŒ»é™¢åç§°...">
                </div>
                <div class="form-group">
                    <label>åŒ»é™¢åœ°å€</label>
                    <input type="text" class="input" id="hospitalAddress" placeholder="è¯·è¾“å…¥è¯¦ç»†åœ°å€...">
                </div>
                <div class="form-group">
                    <label>è”ç³»ç”µè¯</label>
                    <input type="text" class="input" id="hospitalPhone" placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯...">
                </div>
                <div class="form-group">
                    <label>ç»åº¦ï¼ˆå¯é€‰ï¼‰</label>
                    <input type="text" class="input" id="hospitalLng" placeholder="å¦‚ï¼š120.1551">
                </div>
                <div class="form-group">
                    <label>çº¬åº¦ï¼ˆå¯é€‰ï¼‰</label>
                    <input type="text" class="input" id="hospitalLat" placeholder="å¦‚ï¼š30.2741">
                </div>
                <div class="form-group">
                    <label>åŒ»é™¢ç®€ä»‹</label>
                    <textarea class="input" id="hospitalDescription" rows="3" placeholder="è¯·è¾“å…¥åŒ»é™¢ç®€ä»‹..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeHospitalManager()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveHospital()">æ·»åŠ åŒ»é™¢</button>
            </div>
        </div>
    </div>

    <!-- æ·»åŠ çŒ«å’ªæ¨¡æ€æ¡† -->
    <div id="addCatModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æ·»åŠ çŒ«å’ª</h3>
                <button class="btn btn-secondary" onclick="closeAddCatModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>çŒ«å’ªåå­—</label>
                    <input type="text" class="input" id="catName" placeholder="è¯·è¾“å…¥çŒ«å’ªåå­—...">
                </div>
                <div class="form-group">
                    <label>å“ç§</label>
                    <select class="input" id="catBreed">
                        <option value="">è¯·é€‰æ‹©å“ç§</option>
                        <option value="è‹±çŸ­">è‹±çŸ­</option>
                        <option value="ç¾çŸ­">ç¾çŸ­</option>
                        <option value="å¸ƒå¶çŒ«">å¸ƒå¶çŒ«</option>
                        <option value="æš¹ç½—çŒ«">æš¹ç½—çŒ«</option>
                        <option value="åŠ è²çŒ«">åŠ è²çŒ«</option>
                        <option value="ä¸­åç”°å›­çŒ«">ä¸­åç”°å›­çŒ«</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>å¹´é¾„</label>
                    <input type="number" class="input" id="catAge" placeholder="è¯·è¾“å…¥å¹´é¾„ï¼ˆå²ï¼‰" min="0" max="30">
                </div>
                <div class="form-group">
                    <label>æ€§åˆ«</label>
                    <select class="input" id="catGender">
                        <option value="å…¬">å…¬</option>
                        <option value="æ¯">æ¯</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ç…§ç‰‡</label>
                    <div style="display: flex; gap: var(--spacing-sm); margin-bottom: var(--spacing-sm);">
                        <input type="text" class="input" id="catPhoto" placeholder="è¯·è¾“å…¥ç…§ç‰‡é“¾æ¥æˆ–ä¸Šä¼ å›¾ç‰‡...">
                        <input type="file" id="catPhotoUpload" accept="image/*" style="display: none;" onchange="handleCatPhotoUpload(event)">
                        <button class="btn btn-secondary" onclick="document.getElementById('catPhotoUpload').click()">ğŸ“· ä¸Šä¼ </button>
                    </div>
                    <div id="catPhotoPreview" style="width: 100%; height: 200px; border: 2px dashed var(--apple-border); border-radius: var(--border-radius-sm); display: flex; align-items: center; justify-content: center; color: var(--apple-gray-medium); background-color: var(--apple-gray-light);">
                        <div style="text-align: center;">
                            <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ±</div>
                            <p>ç…§ç‰‡é¢„è§ˆåŒºåŸŸ</p>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>ç®€ä»‹</label>
                    <textarea class="input" id="catDescription" rows="3" placeholder="ä»‹ç»ä¸€ä¸‹è¿™åªå¯çˆ±çš„çŒ«å’ª..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAddCatModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="submitCat()">æ·»åŠ </button>
            </div>
        </div>
    </div>

    <!-- å® ç‰©åŒ»é™¢é¡µé¢ -->
    <div id="hospital" class="page">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-md);">
                <h2>ğŸ¥ å® ç‰©åŒ»é™¢</h2>
                <div style="display: flex; gap: var(--spacing-sm);">
                    <button class="btn btn-primary" onclick="getCurrentLocation()">ğŸ“ å®šä½</button>
                    <button class="btn btn-secondary" onclick="refreshHospitals()">ğŸ”„ åˆ·æ–°</button>
                    <button id="hospitalManageBtn" class="btn btn-primary" onclick="openHospitalManager()" style="display: none;">â• æ·»åŠ åŒ»é™¢</button>
                </div>
            </div>
            
            <!-- åœ°å›¾å®¹å™¨ -->
            <div class="map-container" id="mapContainer">
                <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--apple-gray-medium);">
                    <div style="text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ—ºï¸</div>
                        <p>åœ°å›¾åŠ è½½ä¸­...</p>
                    </div>
                </div>
            </div>

            <!-- æœç´¢æ  -->
            <div style="margin-bottom: var(--spacing-md);">
                <input type="text" class="input" placeholder="æœç´¢åŒ»é™¢åç§°æˆ–åœ°å€..." id="hospitalSearch">
            </div>
            
            <!-- åŒ»é™¢åˆ—è¡¨ -->
            <div id="hospitalList">
                <div style="text-align: center; padding: 40px; color: var(--apple-gray-medium);">
                    <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ¥</div>
                    <p>è¯·ç‚¹å‡»ä¸Šæ–¹"åˆ·æ–°"æŒ‰é’®æœç´¢é™„è¿‘å® ç‰©åŒ»é™¢</p>
                </div>
            </div>
        </div>
    </div>

    <!-- åŒ»é™¢è¯„è®ºæ¨¡æ€æ¡† -->
    <div id="hospitalReviewModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>åŒ»é™¢è¯„ä»·</h3>
                <button class="btn btn-secondary" onclick="closeHospitalReviewModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>è¯„åˆ†</label>
                    <div id="ratingStars" style="display: flex; gap: var(--spacing-xs); font-size: 24px;">
                        <span class="star" data-rating="1">â­</span>
                        <span class="star" data-rating="2">â­</span>
                        <span class="star" data-rating="3">â­</span>
                        <span class="star" data-rating="4">â­</span>
                        <span class="star" data-rating="5">â­</span>
                    </div>
                </div>
                <div class="form-group">
                    <label>è¯„è®ºå†…å®¹</label>
                    <textarea class="input" id="reviewContent" rows="4" placeholder="åˆ†äº«æ‚¨çš„å°±è¯Šä½“éªŒ..."></textarea>
                </div>
                <input type="hidden" id="reviewHospitalId">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeHospitalReviewModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="submitReview()">æäº¤è¯„ä»·</button>
            </div>
        </div>
    </div>

    <!-- ç‰©æµæŸ¥è¯¢é¡µé¢ -->
    <div id="logistics" class="page">
        <div class="container">
            <h2>ğŸ“¦ ç‰©æµæŸ¥è¯¢</h2>
            
            <!-- å¿«æ·å…¥å£ -->
            <div class="grid grid-2" style="margin-bottom: var(--spacing-lg);">
                <div class="card" onclick="focusTrackingInput()">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ”</div>
                        <h3>è¿å•æŸ¥è¯¢</h3>
                        <p>è¾“å…¥è¿å•å·æŸ¥è¯¢ç‰©æµä¿¡æ¯</p>
                        <button class="btn btn-primary">å¼€å§‹æŸ¥è¯¢</button>
                    </div>
                </div>
                <div class="card" onclick="showTrackingHistory()">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ“‹</div>
                        <h3>æŸ¥è¯¢å†å²</h3>
                        <p>æŸ¥çœ‹å†å²æŸ¥è¯¢è®°å½•</p>
                        <button class="btn btn-secondary">æŸ¥çœ‹å†å²</button>
                    </div>
                </div>
            </div>

            <!-- æŸ¥è¯¢è¡¨å• -->
            <div class="card" style="margin-bottom: var(--spacing-lg);">
                <div style="padding: var(--spacing-md);">
                    <h3 style="margin-bottom: var(--spacing-md);">è¿å•å·æŸ¥è¯¢</h3>
                    <div class="form-group">
                        <label>è¿å•å·</label>
                        <input type="text" class="input" placeholder="è¯·è¾“å…¥è¿å•å·..." id="trackingNumber" onkeypress="if(event.key==='Enter') trackPackage()">
                    </div>
                    <button class="btn btn-primary" onclick="trackPackage()">æŸ¥è¯¢ç‰©æµ</button>
                </div>
            </div>

            <!-- å¸¸ç”¨å¿«é€’å…¬å¸ -->
            <h3 style="margin-bottom: var(--spacing-md);">ğŸšš å¸¸ç”¨å¿«é€’</h3>
            <div class="grid grid-3">
                <div class="card">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 32px; margin-bottom: var(--spacing-sm);">ğŸ“¦</div>
                        <h4>é¡ºä¸°é€Ÿè¿</h4>
                        <p style="color: var(--apple-gray-medium); font-size: 14px;">è¯·è¾“å…¥è¿å•å·æŸ¥è¯¢</p>
                    </div>
                </div>
                <div class="card">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 32px; margin-bottom: var(--spacing-sm);">ğŸ“¦</div>
                        <h4>ä¸­é€šå¿«é€’</h4>
                        <p style="color: var(--apple-gray-medium); font-size: 14px;">è¯·è¾“å…¥è¿å•å·æŸ¥è¯¢</p>
                    </div>
                </div>
                <div class="card">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 32px; margin-bottom: var(--spacing-sm);">ğŸ“¦</div>
                        <h4>åœ†é€šå¿«é€’</h4>
                        <p style="color: var(--apple-gray-medium); font-size: 14px;">è¯·è¾“å…¥è¿å•å·æŸ¥è¯¢</p>
                    </div>
                </div>
            </div>

            <div id="trackingResult" style="margin-top: var(--spacing-md);"></div>
        </div>
    </div>

    <!-- è®ºå›äº¤æµé¡µé¢ -->
    <div id="forum" class="page">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-md);">
                <h2>ğŸ’¬ è®ºå›äº¤æµ</h2>
                <div style="display: flex; gap: var(--spacing-sm);">
                    <button id="forumManageBtn" class="btn btn-secondary" onclick="manageForum()" style="display: none;">ğŸ“ ç®¡ç†è®ºå›</button>
                    <button class="btn btn-primary" onclick="createPost()">+ å‘è¡¨å¸–å­</button>
                </div>
            </div>
            
            <div id="postList">
                <!-- å¸–å­åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- å‘å¸–æ¨¡æ€æ¡† -->
    <div id="createPostModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>å‘è¡¨å¸–å­</h3>
                <button class="btn btn-secondary" onclick="closeCreatePostModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>æ ‡é¢˜</label>
                    <input type="text" class="input" id="postTitle" placeholder="ç»™å¸–å­èµ·ä¸ªæ ‡é¢˜...">
                </div>
                <div class="form-group">
                    <label>å†…å®¹</label>
                    <textarea class="input" id="postContent" rows="6" placeholder="åˆ†äº«ä½ çš„å…»çŒ«ç»éªŒ..."></textarea>
                </div>
                <div class="form-group">
                    <label>å›¾ç‰‡URL (å¯é€‰)</label>
                    <input type="text" class="input" id="postImages" placeholder="å›¾ç‰‡åœ°å€ï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeCreatePostModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="submitPost()">å‘è¡¨</button>
            </div>
        </div>
    </div>

    <!-- å® ç‰©å•†åŸé¡µé¢ -->
    <div id="shop" class="page">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-md);">
                <h2>ğŸ›ï¸ å® ç‰©å•†åŸ</h2>
                <div id="shopManageBtn" style="display: none;">
                    <button class="btn btn-primary" onclick="openShopManager()">ğŸ“ ç®¡ç†å•†å“</button>
                </div>
            </div>
            
            <!-- å•†å“åˆ†ç±» -->
            <div class="category-grid">
                <div class="category-card" onclick="openTaobaoCategory('çŒ«ç²®')">
                    <div class="category-icon">ğŸ¥«</div>
                    <h4>çŒ«ç²®</h4>
                    <p style="color: var(--apple-gray-medium); font-size: 14px;">ä¸»é£Ÿã€é›¶é£Ÿã€è¥å…»å“</p>
                </div>
                <div class="category-card" onclick="openTaobaoCategory('çŒ«ç©å…·')">
                    <div class="category-icon">ğŸ§¶</div>
                    <h4>çŒ«ç©å…·</h4>
                    <p style="color: var(--apple-gray-medium); font-size: 14px;">é€—çŒ«æ£’ã€æ¯›çº¿çƒã€ç›Šæ™ºç©å…·</p>
                </div>
                <div class="category-card" onclick="openTaobaoCategory('çŒ«ç ‚')">
                    <div class="category-icon">ğŸ§¼</div>
                    <h4>çŒ«ç ‚</h4>
                    <p style="color: var(--apple-gray-medium); font-size: 14px;">è†¨æ¶¦ç ‚ã€è±†è…ç ‚ã€æ°´æ™¶ç ‚</p>
                </div>
                <div class="category-card" onclick="openTaobaoCategory('çŒ«çª')">
                    <div class="category-icon">ğŸ </div>
                    <h4>çŒ«çª</h4>
                    <p style="color: var(--apple-gray-medium); font-size: 14px;">çŒ«åºŠã€çŒ«å¸ç¯·ã€çŒ«çˆ¬æ¶</p>
                </div>
                <div class="category-card" onclick="openTaobaoCategory('çŒ«æŠ¤ç†')">
                    <div class="category-icon">ğŸ§´</div>
                    <h4>çŒ«æŠ¤ç†</h4>
                    <p style="color: var(--apple-gray-medium); font-size: 14px;">æ²æµ´éœ²ã€æ¢³å­ã€æŒ‡ç”²å‰ª</p>
                </div>
                <div class="category-card" onclick="openTaobaoCategory('çŒ«ä¿å¥å“')">
                    <div class="category-icon">ğŸ’Š</div>
                    <h4>çŒ«ä¿å¥å“</h4>
                    <p style="color: var(--apple-gray-medium); font-size: 14px;">ç»´ç”Ÿç´ ã€ç›Šç”ŸèŒã€é©±è™«è¯</p>
                </div>
            </div>

            <!-- æ¨èå•†å“ -->
            <h3 style="margin-bottom: var(--spacing-md);">ğŸ”¥ çƒ­é—¨æ¨è</h3>
            <div class="grid grid-3" id="recommendedProducts">
                <div class="card" onclick="openTaobaoProduct('çŒ«ç²®')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ¥«</div>
                        <h3>è¿›å£çŒ«ç²®</h3>
                        <p style="color: var(--apple-orange); font-weight: 600;">Â¥89</p>
                        <button class="btn btn-primary">ğŸ›’ æ·˜å®è´­ä¹°</button>
                    </div>
                </div>
                <div class="card" onclick="openTaobaoProduct('çŒ«ç©å…·')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ§¶</div>
                        <h3>é€—çŒ«æ£’å¥—è£…</h3>
                        <p style="color: var(--apple-orange); font-weight: 600;">Â¥29</p>
                        <button class="btn btn-primary">ğŸ›’ æ·˜å®è´­ä¹°</button>
                    </div>
                </div>
                <div class="card" onclick="openTaobaoProduct('çŒ«ç ‚')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ§¼</div>
                        <h3>è±†è…çŒ«ç ‚</h3>
                        <p style="color: var(--apple-orange); font-weight: 600;">Â¥45</p>
                        <button class="btn btn-primary">ğŸ›’ æ·˜å®è´­ä¹°</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¸ªäººä¸­å¿ƒé¡µé¢ -->
    <div id="profile" class="page">
        <div class="container">
            <h2>ğŸ‘¤ ä¸ªäººä¸­å¿ƒ</h2>
            
            <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
            <div class="card" style="margin-bottom: var(--spacing-lg);">
                <div style="padding: var(--spacing-md); display: flex; align-items: center; gap: var(--spacing-md);">
                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, var(--apple-blue), var(--apple-purple)); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; color: white;">
                        ğŸ‘¤
                    </div>
                    <div style="flex: 1;">
                        <h3 id="userName">æ¸¸å®¢ç”¨æˆ·</h3>
                        <p style="color: var(--apple-gray-medium); font-size: 14px;">æ¬¢è¿æ¥åˆ°é‡‘çŒ«ä¹‹å®¶</p>
                    </div>
                </div>
            </div>

            <!-- åŠŸèƒ½èœå• -->
            <div class="card" style="margin-bottom: var(--spacing-lg);">
                <div style="padding: var(--spacing-md);">
                    <h3 style="margin-bottom: var(--spacing-md);">ğŸ”§ ç®¡ç†åŠŸèƒ½</h3>
                    <div class="menu-item" onclick="toggleLogin(event)" onmousedown="toggleLogin(event)" style="cursor: pointer; user-select: none;">
                        <span class="menu-icon">ğŸ”</span>
                        <span class="menu-text">ç®¡ç†å‘˜ç™»å½•</span>
                        <span class="menu-arrow">â†’</span>
                    </div>
                    <div id="adminMenuItems" style="display: none;">
                        <div class="menu-item" onclick="showAdminPanel()">
                            <span class="menu-icon">âš™ï¸</span>
                            <span class="menu-text">ç®¡ç†å‘˜é¢æ¿</span>
                            <span class="menu-arrow">â†’</span>
                        </div>
                        <div class="menu-item" onclick="handleLogout()">
                            <span class="menu-icon">ğŸšª</span>
                            <span class="menu-text">é€€å‡ºç™»å½•</span>
                            <span class="menu-arrow">â†’</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç”¨æˆ·æœåŠ¡ -->
            <div class="card" style="margin-bottom: var(--spacing-lg);">
                <div style="padding: var(--spacing-md);">
                    <h3 style="margin-bottom: var(--spacing-md);">ğŸ› ï¸ ç”¨æˆ·æœåŠ¡</h3>
                    <div class="menu-item" onclick="showAddressManager()">
                        <span class="menu-icon">ğŸ“</span>
                        <span class="menu-text">åœ°å€ç®¡ç†</span>
                        <span class="menu-arrow">â†’</span>
                    </div>
                    <div class="menu-item" onclick="showOrderManager()">
                        <span class="menu-icon">ğŸ“¦</span>
                        <span class="menu-text">æˆ‘çš„è®¢å•</span>
                        <span class="menu-arrow">â†’</span>
                    </div>
                    <div class="menu-item" onclick="showSettings()">
                        <span class="menu-icon">âš™ï¸</span>
                        <span class="menu-text">è®¾ç½®</span>
                        <span class="menu-arrow">â†’</span>
                    </div>
                </div>
            </div>

            <!-- å…³äºæˆ‘ä»¬ -->
            <div class="card">
                <div style="padding: var(--spacing-md);">
                    <h3 style="margin-bottom: var(--spacing-md);">â„¹ï¸ å…³äº</h3>
                    <div class="menu-item" onclick="showAbout()">
                        <span class="menu-icon">ğŸ±</span>
                        <span class="menu-text">å…³äºé‡‘çŒ«ä¹‹å®¶</span>
                        <span class="menu-arrow">â†’</span>
                    </div>
                    <div class="menu-item" onclick="showVersion()">
                        <span class="menu-icon">ğŸ“±</span>
                        <span class="menu-text">ç‰ˆæœ¬ä¿¡æ¯</span>
                        <span class="menu-arrow">â†’</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toasté€šçŸ¥å®¹å™¨ -->
    <div id="toast" class="toast"></div>

    <!-- ç§»åŠ¨ç«¯å¿«æ·å¯¼èˆª -->
    <nav class="mobile-quick-nav">
        <a href="#" class="mobile-quick-nav-item active" data-page="home" onclick="showPage('home', this)">
            <span>ğŸ </span>
            <span>é¦–é¡µ</span>
        </a>
        <a href="#" class="mobile-quick-nav-item" data-page="cats" onclick="showPage('cats', this)">
            <span>ğŸ±</span>
            <span>çŒ«å’ª</span>
        </a>
        <a href="#" class="mobile-quick-nav-item" data-page="hospital" onclick="showPage('hospital', this)">
            <span>ğŸ¥</span>
            <span>åŒ»é™¢</span>
        </a>
        <a href="#" class="mobile-quick-nav-item" data-page="forum" onclick="showPage('forum', this)">
            <span>ğŸ’¬</span>
            <span>è®ºå›</span>
        </a>
        <a href="#" class="mobile-quick-nav-item" data-page="shop" onclick="showPage('shop', this)">
            <span>ğŸ›ï¸</span>
            <span>å•†åŸ</span>
        </a>
        <a href="#" class="mobile-quick-nav-item" data-page="profile" onclick="showPage('profile', this)">
            <span>ğŸ‘¤</span>
            <span>æˆ‘çš„</span>
        </a>
    </nav>

    <!-- å³ä¸‹è§’ç§ä¿¡æŒ‰é’® -->
    <button class="fab" onclick="openMessageModal()" style="bottom: 80px;">âœ‰ï¸</button>

    <!-- ç§ä¿¡æ¨¡æ€æ¡† -->
    <div id="messageModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3>å‘é€ç§ä¿¡ç»™ç®¡ç†å‘˜</h3>
                <button class="btn btn-secondary" onclick="closeMessageModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>æ¶ˆæ¯å†…å®¹</label>
                    <textarea class="input" id="messageContent" rows="6" placeholder="è¯·è¾“å…¥æ‚¨æƒ³å¯¹ç®¡ç†å‘˜è¯´çš„è¯..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeMessageModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="sendMessage()">å‘é€</button>
            </div>
        </div>
    </div>

    <!-- ç™»å½•æ¨¡æ€æ¡† -->
    <div id="loginModal" class="modal-overlay" onclick="if(event.target === this) closeLoginModal()">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="loginTitle">ç®¡ç†å‘˜ç™»å½•</h3>
                <button class="btn btn-secondary" onclick="closeLoginModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <div style="background: var(--apple-gray-light); padding: var(--spacing-sm); border-radius: var(--border-radius-sm); margin-bottom: var(--spacing-md);">
                    <p style="color: var(--apple-gray-dark); font-size: 14px; margin: 0;">
                        <strong>æ™®é€šç”¨æˆ·æ— éœ€ç™»å½•</strong>å³å¯ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½ã€‚<br>
                        åªæœ‰ç®¡ç†å‘˜éœ€è¦ç™»å½•æ¥ç®¡ç†çŒ«å’ªä¿¡æ¯ã€‚
                    </p>
                </div>
                <div class="form-group">
                    <label>ç®¡ç†å‘˜è´¦å·</label>
                    <input type="text" class="input" id="username" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜è´¦å·...">
                </div>
                <div class="form-group">
                    <label>å¯†ç </label>
                    <input type="password" class="input" id="password" placeholder="è¯·è¾“å…¥å¯†ç ...">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeLoginModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="handleLogin()">ç®¡ç†å‘˜ç™»å½•</button>
            </div>
        </div>
    </div>

    <script>
        // åº”ç”¨æ•°æ®
        const appData = {
            cats: [],
            hospitals: [],
            posts: [],
            products: [],
            reviews: {},
            messages: [],
            currentLocation: null,
            currentUser: null,
            isLoggedIn: false,
            isAdmin: false
        };

        // ç®¡ç†å‘˜è´¦å·ä¿¡æ¯
        const ADMIN_CREDENTIALS = {
            username: 'abc123',
            password: 'abc123'
        };

        // é¡µé¢åˆ‡æ¢å‡½æ•° - æ ¸å¿ƒåŠŸèƒ½
        function showPage(pageId, element) {
            try {
                console.log('ğŸ”„ åˆ‡æ¢åˆ°é¡µé¢:', pageId);
                
                // 1. éšè—æ‰€æœ‰é¡µé¢
                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });
                
                // 2. æ˜¾ç¤ºç›®æ ‡é¡µé¢
                const targetPage = document.getElementById(pageId);
                if (targetPage) {
                    targetPage.classList.add('active');
                    console.log('âœ… é¡µé¢æ˜¾ç¤ºæˆåŠŸ:', pageId);
                } else {
                    console.error('âŒ é¡µé¢ä¸å­˜åœ¨:', pageId);
                    showToast('é¡µé¢ä¸å­˜åœ¨: ' + pageId, 'error');
                    return;
                }
                
                // 3. æ›´æ–°å¯¼èˆªçŠ¶æ€
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                
                if (element && element.classList) {
                    element.classList.add('active');
                } else {
                    // å¦‚æœæ²¡æœ‰ä¼ å…¥elementï¼Œå°è¯•é€šè¿‡data-pageæ‰¾åˆ°å¯¹åº”å¯¼èˆª
                    const navLink = document.querySelector(`[data-page="${pageId}"]`);
                    if (navLink) {
                        navLink.classList.add('active');
                    }
                }
                
                // 4. æ»šåŠ¨åˆ°é¡¶éƒ¨
                window.scrollTo(0, 0);
                
                // 5. æ˜¾ç¤ºæˆåŠŸæç¤º
                console.log('âœ… é¡µé¢åˆ‡æ¢å®Œæˆ:', pageId);
                
            } catch (error) {
                console.error('âŒ é¡µé¢åˆ‡æ¢é”™è¯¯:', error);
                showToast('é¡µé¢åˆ‡æ¢å¤±è´¥: ' + error.message, 'error');
            }
        }

        // Toasté€šçŸ¥å‡½æ•°
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = 'toast ' + type;
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // æ·»åŠ çŒ«å’ª
        function addCat() {
            showToast('æ·»åŠ çŒ«å’ªåŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // æœç´¢åŒ»é™¢
        function searchHospital() {
            const searchTerm = document.getElementById('hospitalSearch').value;
            if (!searchTerm) {
                showToast('è¯·è¾“å…¥æœç´¢å…³é”®è¯', 'error');
                return;
            }
            filterHospitals(searchTerm);
        }

        // æ£€æµ‹æ˜¯å¦ä¸ºç§»åŠ¨è®¾å¤‡
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   (window.innerWidth <= 768 && 'ontouchstart' in window);
        }

        // æ‰“å¼€æ·˜å®åˆ†ç±»
        function openTaobaoCategory(category) {
            const isMobile = isMobileDevice();
            
            showToast('æ­£åœ¨è·³è½¬åˆ°æ·˜å®...', 'info');
            
            if (isMobile) {
                // ç§»åŠ¨ç«¯ä½¿ç”¨ç›´æ¥è·³è½¬æ–¹å¼ï¼Œé¿å…iframeå¡æ­»
                const taobaoAppUrl = `taobao://s.taobao.com/search?q=${encodeURIComponent(category + ' å® ç‰©ç”¨å“')}`;
                const taobaoWebUrl = `https://m.taobao.com/search?q=${encodeURIComponent(category + ' å® ç‰©ç”¨å“')}`;
                
                // å…ˆå°è¯•æ‰“å¼€APP
                window.location.href = taobaoAppUrl;
                
                // 1ç§’åè·³è½¬åˆ°ç½‘é¡µç‰ˆï¼ˆå¦‚æœAPPæ²¡æœ‰å“åº”ï¼‰
                setTimeout(() => {
                    window.open(taobaoWebUrl, '_blank');
                }, 1000);
                
            } else {
                // æ¡Œé¢ç«¯ä½¿ç”¨æ·˜å®PCç‰ˆé“¾æ¥
                const taobaoUrl = `https://s.taobao.com/search?q=${encodeURIComponent(category + ' å® ç‰©ç”¨å“')}`;
                setTimeout(() => {
                    window.open(taobaoUrl, '_blank');
                }, 500);
            }
        }

        // æ‰“å¼€æ·˜å®å•†å“
        function openTaobaoProduct(product) {
            const isMobile = isMobileDevice();
            
            showToast('æ­£åœ¨è·³è½¬åˆ°æ·˜å®...', 'info');
            
            if (isMobile) {
                // ç§»åŠ¨ç«¯ä½¿ç”¨ç›´æ¥è·³è½¬æ–¹å¼ï¼Œé¿å…iframeå¡æ­»
                const taobaoAppUrl = `taobao://s.taobao.com/search?q=${encodeURIComponent(product)}`;
                const taobaoWebUrl = `https://m.taobao.com/search?q=${encodeURIComponent(product)}`;
                
                // å…ˆå°è¯•æ‰“å¼€APP
                window.location.href = taobaoAppUrl;
                
                // 1ç§’åè·³è½¬åˆ°ç½‘é¡µç‰ˆï¼ˆå¦‚æœAPPæ²¡æœ‰å“åº”ï¼‰
                setTimeout(() => {
                    window.open(taobaoWebUrl, '_blank');
                }, 1000);
                
            } else {
                // æ¡Œé¢ç«¯ä½¿ç”¨æ·˜å®PCç‰ˆé“¾æ¥
                const taobaoUrl = `https://s.taobao.com/search?q=${encodeURIComponent(product)}`;
                setTimeout(() => {
                    window.open(taobaoUrl, '_blank');
                }, 500);
            }
        }

        // æ‰“å¼€ç§ä¿¡æ¨¡æ€æ¡†
        function openMessageModal() {
            document.getElementById('messageModal').classList.add('active');
            document.getElementById('messageContent').value = '';
        }

        // å…³é—­ç§ä¿¡æ¨¡æ€æ¡†
        function closeMessageModal() {
            document.getElementById('messageModal').classList.remove('active');
        }

        // å‘é€ç§ä¿¡
        function sendMessage() {
            const content = document.getElementById('messageContent').value.trim();
            if (!content) {
                showToast('è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹', 'error');
                return;
            }

            const message = {
                id: Date.now(),
                content: content,
                time: new Date().toLocaleString(),
                from: appData.currentUser ? appData.currentUser : 'æ¸¸å®¢'
            };

            appData.messages.push(message);
            closeMessageModal();
            showToast('æ¶ˆæ¯å·²å‘é€ç»™ç®¡ç†å‘˜ï¼', 'success');
            
            console.log('å‘é€çš„æ¶ˆæ¯:', message);
        }

        // ç™»å½•ç›¸å…³åŠŸèƒ½
        function toggleLogin() {
            console.log('Toggle login clicked - function executed');
            
            // é˜²æ­¢äº‹ä»¶å†’æ³¡
            if (event) {
                event.preventDefault();
                event.stopPropagation();
            }
            
            const modal = document.getElementById('loginModal');
            console.log('Login modal found:', !!modal);
            
            if (modal) {
                // ç§»é™¤ä¹‹å‰çš„ç±»
                modal.classList.remove('active');
                
                // å¼ºåˆ¶æ˜¾ç¤ºæ¨¡æ€æ¡†
                modal.style.display = 'flex';
                modal.style.position = 'fixed';
                modal.style.top = '0';
                modal.style.left = '0';
                modal.style.width = '100%';
                modal.style.height = '100%';
                modal.style.zIndex = '10001';
                modal.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
                
                // æ·»åŠ activeç±»
                setTimeout(() => {
                    modal.classList.add('active');
                    console.log('Modal active class added');
                }, 50);
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                const usernameInput = document.getElementById('username');
                const passwordInput = document.getElementById('password');
                if (usernameInput) usernameInput.value = '';
                if (passwordInput) passwordInput.value = '';
                
                showToast('ç™»å½•ç•Œé¢å·²æ‰“å¼€', 'info');
                
                // èšç„¦åˆ°ç”¨æˆ·åè¾“å…¥æ¡†
                setTimeout(() => {
                    if (usernameInput) {
                        usernameInput.focus();
                        console.log('Username input focused');
                    }
                }, 300);
            } else {
                console.error('Login modal not found');
                showToast('ç™»å½•ç•Œé¢é”™è¯¯', 'error');
            }
        }

        // å¤‡ç”¨ç™»å½•æ¨¡æ€æ¡†æ˜¾ç¤ºå‡½æ•°
        function showLoginModal() {
            toggleLogin();
        }

        function closeLoginModal() {
            const modal = document.getElementById('loginModal');
            if (modal) {
                modal.classList.remove('active');
                modal.style.display = 'none';
            }
        }

        function handleLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            if (!username || !password) {
                showToast('è¯·è¾“å…¥è´¦å·å’Œå¯†ç ', 'error');
                return;
            }

            // æ£€æŸ¥ç®¡ç†å‘˜è´¦å·
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                appData.currentUser = 'ç®¡ç†å‘˜';
                appData.isLoggedIn = true;
                appData.isAdmin = true;
                
                // å…³é—­ç™»å½•æ¨¡æ€æ¡†
                const loginModal = document.getElementById('loginModal');
                if (loginModal) {
                    loginModal.classList.remove('active');
                    loginModal.style.display = 'none';
                }
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                
                // æ›´æ–°ç•Œé¢çŠ¶æ€
                updateLoginButton();
                enableAdminFeatures();
                
                showToast('ç®¡ç†å‘˜ç™»å½•æˆåŠŸï¼', 'success');
                console.log('ç®¡ç†å‘˜ç™»å½•æˆåŠŸï¼ŒåŠŸèƒ½å·²å¯ç”¨');
            } else {
                showToast('è´¦å·æˆ–å¯†ç é”™è¯¯ï¼Œåªæœ‰ç®¡ç†å‘˜å¯ä»¥ç™»å½•', 'error');
                // æ¸…ç©ºå¯†ç è¾“å…¥æ¡†
                document.getElementById('password').value = '';
            }
        }

        function logout() {
            appData.currentUser = null;
            appData.isLoggedIn = false;
            appData.isAdmin = false;
            
            updateLoginButton();
            disableAdminFeatures();
            showToast('å·²é€€å‡ºç™»å½•', 'info');
        }

        function updateLoginButton() {
            const loginBtn = document.getElementById('loginBtn');
            if (appData.isLoggedIn) {
                if (appData.isAdmin) {
                    loginBtn.textContent = 'ç®¡ç†å‘˜';
                    loginBtn.className = 'btn btn-primary';
                    loginBtn.onclick = showAdminPanel;
                } else {
                    loginBtn.textContent = 'ç”¨æˆ·';
                    loginBtn.className = 'btn btn-secondary';
                    loginBtn.onclick = logout;
                }
            } else {
                loginBtn.textContent = 'ç®¡ç†å‘˜ç™»å½•';
                loginBtn.className = 'btn btn-secondary';
                loginBtn.onclick = toggleLogin;
            }
            
            // æ›´æ–°ä¸ªäººä¸­å¿ƒèœå•
            updateProfileMenu();
            
            // æ›´æ–°çŒ«å’ªç®¡ç†é¡µé¢æƒé™
            updateCatManagementButtons();
        }

        function updateCatManagementButtons() {
            const managementButtons = document.getElementById('catManagementButtons');
            const userHint = document.getElementById('catUserHint');
            
            if (managementButtons && userHint) {
                if (appData.isAdmin) {
                    managementButtons.style.display = 'block';
                    userHint.style.display = 'none';
                } else {
                    managementButtons.style.display = 'none';
                    userHint.style.display = 'block';
                }
            }
        }

        function enableAdminFeatures() {
            // ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹çš„å…ƒç´ æ·»åŠ ç¼–è¾‘åŠŸèƒ½
            console.log('ç®¡ç†å‘˜åŠŸèƒ½å·²å¯ç”¨');
            
            // å¯ç”¨çŒ«å’ªç®¡ç†é¡µé¢
            const catManagementButtons = document.getElementById('catManagementButtons');
            const catUserHint = document.getElementById('catUserHint');
            if (catManagementButtons) catManagementButtons.style.display = 'block';
            if (catUserHint) catUserHint.style.display = 'none';
            
            // å¯ç”¨å•†åŸç®¡ç†åŠŸèƒ½
            const shopManageBtn = document.getElementById('shopManageBtn');
            if (shopManageBtn) shopManageBtn.style.display = 'block';
            
            // å¯ç”¨åŒ»é™¢ç®¡ç†åŠŸèƒ½
            const hospitalManageBtn = document.getElementById('hospitalManageBtn');
            if (hospitalManageBtn) hospitalManageBtn.style.display = 'block';
            
            // å¯ç”¨è®ºå›ç®¡ç†åŠŸèƒ½
            enableForumAdminFeatures();
            
            // é‡æ–°æ¸²æŸ“ç›¸å…³é¡µé¢
            renderCats();
            renderPosts();
            updateProfileMenu();
            
            showToast('ç®¡ç†å‘˜åŠŸèƒ½å·²å…¨éƒ¨å¯ç”¨', 'success');
        }

        // è®ºå›ç®¡ç†åŠŸèƒ½
        function enableForumAdminFeatures() {
            const forumManageBtn = document.getElementById('forumManageBtn');
            if (forumManageBtn) forumManageBtn.style.display = 'block';
        }

        function disableForumAdminFeatures() {
            const forumManageBtn = document.getElementById('forumManageBtn');
            if (forumManageBtn) forumManageBtn.style.display = 'none';
        }

        function manageForum() {
            showToast('è®ºå›ç®¡ç†åŠŸèƒ½ï¼šå¯ä»¥åˆ é™¤/ç½®é¡¶å¸–å­', 'info');
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´è¯¦ç»†çš„è®ºå›ç®¡ç†åŠŸèƒ½
        }

        // åˆ é™¤å¸–å­
        function deletePost(postId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ç¯‡å¸–å­å—ï¼Ÿ')) {
                const index = appData.posts.findIndex(p => p.id === postId);
                if (index !== -1) {
                    appData.posts.splice(index, 1);
                    renderPosts();
                    showToast('å¸–å­å·²åˆ é™¤', 'success');
                }
            }
        }

        // ç½®é¡¶å¸–å­
        function pinPost(postId) {
            const post = appData.posts.find(p => p.id === postId);
            if (post) {
                // å°†å¸–å­ç§»åˆ°é¡¶éƒ¨
                appData.posts = appData.posts.filter(p => p.id !== postId);
                appData.posts.unshift(post);
                post.pinned = true;
                post.pinTime = new Date().toLocaleString();
                renderPosts();
                showToast('å¸–å­å·²ç½®é¡¶', 'success');
            }
        }

        function disableAdminFeatures() {
            // ç¦ç”¨ç®¡ç†å‘˜åŠŸèƒ½
            console.log('ç®¡ç†å‘˜åŠŸèƒ½å·²ç¦ç”¨');
            
            // ç¦ç”¨çŒ«å’ªç®¡ç†é¡µé¢
            const catManagementButtons = document.getElementById('catManagementButtons');
            const catUserHint = document.getElementById('catUserHint');
            if (catManagementButtons) catManagementButtons.style.display = 'none';
            if (catUserHint) catUserHint.style.display = 'block';
            
            // ç¦ç”¨å•†åŸç®¡ç†åŠŸèƒ½
            const shopManageBtn = document.getElementById('shopManageBtn');
            if (shopManageBtn) shopManageBtn.style.display = 'none';
            
            // ç¦ç”¨åŒ»é™¢ç®¡ç†åŠŸèƒ½
            const hospitalManageBtn = document.getElementById('hospitalManageBtn');
            if (hospitalManageBtn) hospitalManageBtn.style.display = 'none';
            
            // ç¦ç”¨è®ºå›ç®¡ç†åŠŸèƒ½
            disableForumAdminFeatures();
            
            // é‡æ–°æ¸²æŸ“ç›¸å…³é¡µé¢
            renderCats();
            renderPosts();
            updateProfileMenu();
        }

        function showAdminPanel() {
            // æ˜¾ç¤ºç®¡ç†å‘˜é¢æ¿
            showToast('ç®¡ç†å‘˜é¢æ¿å¼€å‘ä¸­...', 'info');
        }

        // ç‰©æµç›¸å…³åŠŸèƒ½
        function focusTrackingInput() {
            document.getElementById('trackingNumber').focus();
        }

        // æ˜¾ç¤ºæŸ¥è¯¢å†å²
        function showTrackingHistory() {
            const history = JSON.parse(localStorage.getItem('trackingHistory') || '[]');
            const trackingResult = document.getElementById('trackingResult');
            
            if (history.length === 0) {
                trackingResult.innerHTML = `
                    <div class="card">
                        <div style="padding: var(--spacing-md); text-align: center;">
                            <p style="color: var(--apple-gray-medium);">æš‚æ— æŸ¥è¯¢å†å²</p>
                        </div>
                    </div>
                `;
            } else {
                trackingResult.innerHTML = `
                    <div class="card">
                        <div style="padding: var(--spacing-md);">
                            <h4>ğŸ“‹ æŸ¥è¯¢å†å²</h4>
                            <div style="margin-top: var(--spacing-md);">
                                ${history.map((item, index) => `
                                    <div style="padding: var(--spacing-sm); border-bottom: 1px solid var(--apple-border); display: flex; justify-content: space-between; align-items: center;">
                                        <div>
                                            <strong>${item.number}</strong>
                                            <span style="color: var(--apple-gray-medium); font-size: 12px; margin-left: var(--spacing-sm);">${item.time}</span>
                                        </div>
                                        <button class="btn btn-small btn-secondary" onclick="retrackPackage('${item.number}')">é‡æ–°æŸ¥è¯¢</button>
                                    </div>
                                `).join('')}
                            </div>
                            ${history.length > 0 ? `<button class="btn btn-secondary" onclick="clearTrackingHistory()" style="margin-top: var(--spacing-md);">æ¸…ç©ºå†å²</button>` : ''}
                        </div>
                    </div>
                `;
            }
        }

        // ç‰©æµæŸ¥è¯¢
        function trackPackage() {
            const trackingNumber = document.getElementById('trackingNumber').value.trim();
            if (!trackingNumber) {
                showToast('è¯·è¾“å…¥è¿å•å·', 'error');
                return;
            }

            // ä¿å­˜æŸ¥è¯¢å†å²
            saveTrackingHistory(trackingNumber);

            // æ¨¡æ‹Ÿç‰©æµæŸ¥è¯¢ç»“æœ
            const trackingResult = document.getElementById('trackingResult');
            const mockData = generateMockTrackingInfo(trackingNumber);
            
            trackingResult.innerHTML = `
                <div class="card">
                    <div style="padding: var(--spacing-md);">
                        <h4>ğŸ“¦ è¿å•æŸ¥è¯¢ç»“æœ</h4>
                        <p><strong>è¿å•å·ï¼š</strong>${trackingNumber}</p>
                        <p><strong>çŠ¶æ€ï¼š</strong><span style="color: ${mockData.statusColor};">${mockData.status}</span></p>
                        <p><strong>æœ€æ–°æ›´æ–°ï¼š</strong>${mockData.lastUpdate}</p>
                        
                        <div style="margin-top: var(--spacing-md);">
                            <h5 style="margin-bottom: var(--spacing-sm);">ç‰©æµè½¨è¿¹</h5>
                            ${mockData.timeline.map(item => `
                                <div style="padding: var(--spacing-sm); border-left: 2px solid var(--apple-blue); margin-left: 8px; position: relative;">
                                    <div style="position: absolute; left: -10px; top: var(--spacing-sm); width: 8px; height: 8px; background: var(--apple-blue); border-radius: 50%;"></div>
                                    <div style="font-size: 14px; color: var(--apple-gray-dark);">${item.time}</div>
                                    <div style="margin-top: 4px;">${item.location}</div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div style="margin-top: var(--spacing-md);">
                            <button class="btn btn-secondary" onclick="document.getElementById('trackingNumber').focus()">é‡æ–°æŸ¥è¯¢</button>
                        </div>
                    </div>
                </div>
            `;
            
            showToast('æŸ¥è¯¢æˆåŠŸï¼', 'success');
        }

        // ç”Ÿæˆæ¨¡æ‹Ÿç‰©æµä¿¡æ¯
        function generateMockTrackingInfo(trackingNumber) {
            const hash = trackingNumber.length % 3;
            const statusMap = [
                { status: 'å·²ç­¾æ”¶', color: 'var(--apple-green)' },
                { status: 'æ´¾é€ä¸­', color: 'var(--apple-blue)' },
                { status: 'è¿è¾“ä¸­', color: 'var(--apple-orange)' }
            ];
            
            const currentStatus = statusMap[hash];
            
            return {
                status: currentStatus.status,
                statusColor: currentStatus.color,
                lastUpdate: new Date().toLocaleString(),
                timeline: [
                    { time: '2024-01-20 10:30', location: 'ã€æ­å·å¸‚ã€‘å·²æ½æ”¶' },
                    { time: '2024-01-20 14:15', location: 'ã€æ­å·å¸‚ã€‘å·²å‘å‡º' },
                    { time: '2024-01-20 18:45', location: 'ã€ä¸Šæµ·å¸‚ã€‘åˆ°è¾¾åˆ†æ‹£ä¸­å¿ƒ' },
                    { time: '2024-01-21 06:20', location: 'ã€åŒ—äº¬å¸‚ã€‘åˆ°è¾¾åˆ†æ‹£ä¸­å¿ƒ' },
                    { time: '2024-01-21 09:15', location: currentStatus.status === 'å·²ç­¾æ”¶' ? 'ã€åŒ—äº¬å¸‚ã€‘å·²ç­¾æ”¶ï¼Œç­¾æ”¶äººï¼šæœ¬äºº' : 'ã€åŒ—äº¬å¸‚ã€‘æ­£åœ¨æ´¾é€' }
                ]
            };
        }

        // ä¿å­˜æŸ¥è¯¢å†å²
        function saveTrackingHistory(trackingNumber) {
            let history = JSON.parse(localStorage.getItem('trackingHistory') || '[]');
            
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
            history = history.filter(item => item.number !== trackingNumber);
            
            // æ·»åŠ åˆ°å¼€å¤´
            history.unshift({
                number: trackingNumber,
                time: new Date().toLocaleString()
            });
            
            // åªä¿ç•™æœ€è¿‘10æ¡
            history = history.slice(0, 10);
            
            localStorage.setItem('trackingHistory', JSON.stringify(history));
        }

        // é‡æ–°æŸ¥è¯¢
        function retrackPackage(trackingNumber) {
            document.getElementById('trackingNumber').value = trackingNumber;
            trackPackage();
        }

        // æ¸…ç©ºå†å²
        function clearTrackingHistory() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæŸ¥è¯¢å†å²å—ï¼Ÿ')) {
                localStorage.removeItem('trackingHistory');
                showTrackingHistory();
                showToast('å†å²å·²æ¸…ç©º', 'success');
            }
        }

        // ç§»åŠ¨ç«¯èœå•ç›¸å…³
        function toggleMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            const overlay = document.getElementById('mobileNavOverlay');
            
            navMenu.classList.toggle('active');
            overlay.classList.toggle('active');
        }

        function closeMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            const overlay = document.getElementById('mobileNavOverlay');
            
            navMenu.classList.remove('active');
            overlay.classList.remove('active');
        }

        function showPageAndCloseMenu(pageId, element) {
            showPage(pageId, element);
            closeMobileMenu();
        }

        // çŒ«å’ªç®¡ç†ç›¸å…³
        function addCat() {
            if (!appData.isAdmin) {
                showToast('åªæœ‰ç®¡ç†å‘˜æ‰èƒ½æ·»åŠ çŒ«å’ª', 'error');
                return;
            }
            document.getElementById('addCatModal').classList.add('active');
            // æ¸…ç©ºè¡¨å•
            document.getElementById('catName').value = '';
            document.getElementById('catBreed').value = '';
            document.getElementById('catAge').value = '';
            document.getElementById('catGender').value = 'å…¬';
            document.getElementById('catPhoto').value = '';
            document.getElementById('catDescription').value = '';
        }

        function closeAddCatModal() {
            document.getElementById('addCatModal').classList.remove('active');
            // æ¸…ç©ºè¡¨å•
            document.getElementById('catName').value = '';
            document.getElementById('catBreed').value = '';
            document.getElementById('catAge').value = '';
            document.getElementById('catGender').value = 'å…¬';
            document.getElementById('catPhoto').value = '';
            document.getElementById('catDescription').value = '';
            document.getElementById('catPhotoPreview').innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ±</div>
                    <p>ç…§ç‰‡é¢„è§ˆåŒºåŸŸ</p>
                </div>
            `;
            // é‡ç½®ç¼–è¾‘çŠ¶æ€
            delete appData.editingCatId;
        }

        // å¤„ç†çŒ«å’ªç…§ç‰‡ä¸Šä¼ 
        function handleCatPhotoUpload(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const photoUrl = e.target.result;
                    document.getElementById('catPhoto').value = photoUrl;
                    document.getElementById('catPhotoPreview').innerHTML = `
                        <img src="${photoUrl}" style="width: 100%; height: 100%; object-fit: cover; border-radius: var(--border-radius-sm);">
                    `;
                    showToast('å›¾ç‰‡ä¸Šä¼ æˆåŠŸ', 'success');
                };
                reader.readAsDataURL(file);
            } else {
                showToast('è¯·é€‰æ‹©æœ‰æ•ˆçš„å›¾ç‰‡æ–‡ä»¶', 'error');
            }
        }

        // ç¼–è¾‘çŒ«å’ª
        function editCat(catId) {
            const cat = appData.cats.find(c => c.id === catId);
            if (cat) {
                appData.editingCatId = catId;
                // å¡«å……è¡¨å•
                document.getElementById('catName').value = cat.name;
                document.getElementById('catBreed').value = cat.breed;
                document.getElementById('catAge').value = cat.age;
                document.getElementById('catGender').value = cat.gender;
                document.getElementById('catPhoto').value = cat.photo;
                document.getElementById('catDescription').value = cat.description || '';
                
                // æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
                document.getElementById('catPhotoPreview').innerHTML = `
                    <img src="${cat.photo}" style="width: 100%; height: 100%; object-fit: cover; border-radius: var(--border-radius-sm);">
                `;
                
                // ä¿®æ”¹æ¨¡æ€æ¡†æ ‡é¢˜å’ŒæŒ‰é’®
                document.querySelector('#addCatModal .modal-header h3').textContent = 'ç¼–è¾‘çŒ«å’ª';
                document.querySelector('#addCatModal .modal-footer .btn-primary').textContent = 'ä¿å­˜';
                
                document.getElementById('addCatModal').classList.add('active');
            }
        }

        function submitCat() {
            const name = document.getElementById('catName').value.trim();
            const breed = document.getElementById('catBreed').value;
            const age = document.getElementById('catAge').value;
            const gender = document.getElementById('catGender').value;
            const photo = document.getElementById('catPhoto').value.trim();
            const description = document.getElementById('catDescription').value.trim();

            if (!name || !breed || !age) {
                showToast('è¯·å¡«å†™å¿…è¦ä¿¡æ¯', 'error');
                return;
            }

            if (appData.editingCatId) {
                // ç¼–è¾‘æ¨¡å¼
                const cat = appData.cats.find(c => c.id === appData.editingCatId);
                if (cat) {
                    cat.name = name;
                    cat.breed = breed;
                    cat.age = parseInt(age);
                    cat.gender = gender;
                    cat.photo = photo || 'https://picsum.photos/300/200?random=' + Date.now();
                    cat.description = description || `è¿™æ˜¯ä¸€åªå¯çˆ±çš„${breed}`;
                    cat.updatedTime = new Date().toLocaleString();
                    
                    renderCats();
                    closeAddCatModal();
                    showToast('çŒ«å’ªä¿¡æ¯æ›´æ–°æˆåŠŸï¼', 'success');
                }
            } else {
                // æ·»åŠ æ¨¡å¼
                const cat = {
                    id: Date.now(),
                    name: name,
                    breed: breed,
                    age: parseInt(age),
                    gender: gender,
                    photo: photo || 'https://picsum.photos/300/200?random=' + Date.now(),
                    description: description || `è¿™æ˜¯ä¸€åªå¯çˆ±çš„${breed}`,
                    addedBy: appData.currentUser,
                    addedTime: new Date().toLocaleString(),
                    likes: 0,
                    comments: [],
                    liked: false
                };

                appData.cats.unshift(cat);
                renderCats();
                closeAddCatModal();
                showToast('çŒ«å’ªæ·»åŠ æˆåŠŸï¼', 'success');
            }
        }

        function renderCats() {
            const catList = document.getElementById('catList');
            
            if (appData.cats.length === 0) {
                // æ˜¾ç¤ºæç¤ºä¿¡æ¯
                catList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--apple-gray-medium);">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ±</div>
                        <p>æš‚æ— çŒ«å’ªä¿¡æ¯</p>
                        ${appData.isAdmin ? '<button class="btn btn-primary" onclick="addCat()">æ·»åŠ ç¬¬ä¸€åªçŒ«å’ª</button>' : ''}
                    </div>
                `;
                return;
            }

            catList.innerHTML = appData.cats.map(cat => `
                <div class="card">
                    <div style="padding: var(--spacing-md);">
                        <img src="${cat.photo}" style="width: 100%; height: 200px; object-fit: cover; border-radius: var(--border-radius-sm); margin-bottom: var(--spacing-sm);" onerror="this.src='https://picsum.photos/300/200?fallback'">
                        <h3>${cat.name}</h3>
                        <p>å“ç§ï¼š${cat.breed}</p>
                        <p>å¹´é¾„ï¼š${cat.age}å²</p>
                        <p>æ€§åˆ«ï¼š${cat.gender}</p>
                        ${cat.description ? `<p style="color: var(--apple-gray-dark); margin-top: var(--spacing-sm);">${cat.description}</p>` : ''}
                        <p style="color: var(--apple-gray-medium); font-size: 12px;">æ·»åŠ æ—¶é—´ï¼š${cat.addedTime}</p>
                        <div style="margin-top: var(--spacing-sm);">
                            <button class="post-action-btn ${cat.liked ? 'liked' : ''}" onclick="likeCat(${cat.id}, this)">
                                <span>${cat.liked ? 'â¤ï¸' : 'ğŸ¤'}</span>
                                <span>${cat.likes}</span>
                            </button>
                            <button class="post-action-btn" onclick="commentCat(${cat.id})">
                                <span>ğŸ’¬</span>
                                <span>${cat.comments.length}</span>
                            </button>
                            ${appData.isAdmin ? `
                                <button class="btn btn-secondary btn-small" onclick="editCat(${cat.id})">ç¼–è¾‘</button>
                                <button class="btn btn-secondary btn-small" onclick="deleteCat(${cat.id})">åˆ é™¤</button>
                            ` : ''}
                        </div>
                        ${cat.comments.length > 0 || !appData.isAdmin ? `
                            <div class="comments-section" id="cat-comments-${cat.id}" style="margin-top: var(--spacing-sm);">
                                ${cat.comments.map(comment => `
                                    <div class="comment-item">
                                        <div class="comment-author">${comment.author}</div>
                                        <div class="comment-content">${comment.content}</div>
                                        <div class="comment-time">${comment.time}</div>
                                    </div>
                                `).join('')}
                                <div class="comment-item">
                                    <div class="form-group" style="margin: 0; display: flex; gap: 8px;">
                                        <input type="text" class="input" id="cat-comment-input-${cat.id}" placeholder="å†™ä¸‹ä½ çš„è¯„è®º..." onkeypress="if(event.key==='Enter') addCatComment(${cat.id}, this.value, this)">
                                        <button class="btn btn-primary btn-small" onclick="addCatComment(${cat.id}, document.getElementById('cat-comment-input-${cat.id}').value, document.getElementById('cat-comment-input-${cat.id}'))">å‘é€</button>
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function likeCat(catId, button) {
            const cat = appData.cats.find(c => c.id === catId);
            if (cat) {
                cat.liked = !cat.liked;
                cat.likes += cat.liked ? 1 : -1;
                
                const btn = button.querySelector('span:first-child');
                const count = button.querySelector('span:last-child');
                
                btn.textContent = cat.liked ? 'â¤ï¸' : 'ğŸ¤';
                button.classList.toggle('liked', cat.liked);
                count.textContent = cat.likes;
                
                showToast(cat.liked ? 'å·²ç‚¹èµ' : 'å·²å–æ¶ˆç‚¹èµ', 'success');
            }
        }

        function commentCat(catId) {
            // æ»šåŠ¨åˆ°è¯„è®ºåŒº
            const commentsSection = document.getElementById(`cat-comments-${catId}`);
            if (commentsSection) {
                commentsSection.classList.add('expanded');
                commentsSection.scrollIntoView({ behavior: 'smooth' });
                // èšç„¦åˆ°è¯„è®ºè¾“å…¥æ¡†
                commentsSection.querySelector('input').focus();
            }
        }

        function addCatComment(catId, content, input) {
            if (!content.trim()) {
                showToast('è¯·è¾“å…¥è¯„è®ºå†…å®¹', 'error');
                return;
            }
            
            const cat = appData.cats.find(c => c.id === catId);
            if (cat) {
                const comment = {
                    author: appData.currentUser ? appData.currentUser : 'æ¸¸å®¢',
                    content: content.trim(),
                    time: 'åˆšåˆš'
                };
                cat.comments.push(comment);
                renderCats();
                showToast('è¯„è®ºæˆåŠŸ', 'success');
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                if (input) {
                    input.value = '';
                }
            }
        }

        function editCat(catId) {
            showToast('ç¼–è¾‘åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        function deleteCat(catId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™åªçŒ«å’ªå—ï¼Ÿ')) {
                const index = appData.cats.findIndex(c => c.id === catId);
                if (index > -1) {
                    appData.cats.splice(index, 1);
                    renderCats();
                    showToast('åˆ é™¤æˆåŠŸ', 'success');
                }
            }
        }

        // å‘è¡¨å¸–å­
        function createPost() {
            document.getElementById('createPostModal').classList.add('active');
            // æ¸…ç©ºè¡¨å•
            document.getElementById('postTitle').value = '';
            document.getElementById('postContent').value = '';
            document.getElementById('postImages').value = '';
        }

        // å…³é—­å‘å¸–æ¨¡æ€æ¡†
        function closeCreatePostModal() {
            document.getElementById('createPostModal').classList.remove('active');
        }

        // æäº¤å¸–å­
        function submitPost() {
            const title = document.getElementById('postTitle').value.trim();
            const content = document.getElementById('postContent').value.trim();
            const images = document.getElementById('postImages').value.trim();

            if (!title || !content) {
                showToast('è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹', 'error');
                return;
            }

            const post = {
                id: Date.now(),
                title: title,
                content: content,
                author: 'ç”¨æˆ·' + Math.floor(Math.random() * 1000),
                avatar: 'ğŸ‘¤',
                time: 'åˆšåˆš',
                images: images ? images.split(',').map(url => url.trim()).filter(url => url) : [],
                likes: 0,
                comments: [],
                liked: false
            };

            appData.posts.unshift(post);
            renderPosts();
            closeCreatePostModal();
            showToast('å‘è¡¨æˆåŠŸï¼', 'success');
        }

        // åˆå§‹åŒ–é»˜è®¤çŒ«å’ªæ•°æ®
        function initDefaultCats() {
            if (appData.cats.length === 0) {
                appData.cats = [
                    {
                        id: 1,
                        name: 'å’ªå’ª',
                        breed: 'è‹±çŸ­',
                        age: 2,
                        gender: 'æ¯',
                        photo: 'https://picsum.photos/300/200?cat1',
                        description: 'ä¸€åªå¯çˆ±çš„å°çŒ«å’ªï¼Œæ€§æ ¼æ¸©é¡ºï¼Œå–œæ¬¢ç©è€',
                        addedBy: 'ç®¡ç†å‘˜',
                        addedTime: '2024-01-15 10:30:00',
                        likes: 15,
                        comments: [
                            {
                                author: 'ç”¨æˆ·1',
                                content: 'å¥½å¯çˆ±çš„çŒ«å’ªï¼',
                                time: '2å°æ—¶å‰'
                            },
                            {
                                author: 'æ¸¸å®¢',
                                content: 'æ¯›è‰²çœŸæ¼‚äº®',
                                time: '1å¤©å‰'
                            }
                        ],
                        liked: false
                    },
                    {
                        id: 2,
                        name: 'å°ç™½',
                        breed: 'å¸ƒå¶çŒ«',
                        age: 3,
                        gender: 'å…¬',
                        photo: 'https://picsum.photos/300/200?cat2',
                        description: 'æ¼‚äº®çš„å¸ƒå¶çŒ«ï¼Œçœ¼ç›åƒè“å®çŸ³ä¸€æ ·',
                        addedBy: 'ç®¡ç†å‘˜',
                        addedTime: '2024-01-14 15:20:00',
                        likes: 23,
                        comments: [
                            {
                                author: 'çŒ«å¥´',
                                content: 'å¸ƒå¶çŒ«å¤ªç¾äº†ï¼',
                                time: '3å°æ—¶å‰'
                            }
                        ],
                        liked: false
                    }
                ];
            }
        }

        // æ¸²æŸ“å¸–å­åˆ—è¡¨
        function renderPosts() {
            const postList = document.getElementById('postList');
            
            if (appData.posts.length === 0) {
                // æ˜¾ç¤ºç¤ºä¾‹å¸–å­
                postList.innerHTML = `
                    <div class="post-card">
                        <div class="post-header">
                            <div class="post-avatar">ç®¡</div>
                            <div class="post-info">
                                <div class="post-author">ç®¡ç†å‘˜</div>
                                <div class="post-time">2å°æ—¶å‰</div>
                            </div>
                        </div>
                        <div class="post-content">
                            <h3 style="margin-bottom: var(--spacing-sm);">æ¬¢è¿æ¥åˆ°é‡‘çŒ«è®ºå›ï¼</h3>
                            <p>æ¬¢è¿å¤§å®¶åœ¨è¿™é‡Œåˆ†äº«å…»çŒ«ç»éªŒï¼Œäº¤æµå…»çŒ«å¿ƒå¾—ã€‚æ— è®ºæ˜¯çŒ«å’ªçš„æ—¥å¸¸æŠ¤ç†ã€å¥åº·é—®é¢˜ï¼Œè¿˜æ˜¯æœ‰è¶£çš„çŒ«å’ªæ•…äº‹ï¼Œéƒ½å¯ä»¥åœ¨è¿™é‡Œå’Œå¤§å®¶åˆ†äº«ã€‚</p>
                            <p style="margin-top: var(--spacing-sm);">è®©æˆ‘ä»¬ä¸€èµ·æ¥åˆ›é€ ä¸€ä¸ªæ¸©æš–çš„çŒ«å’ªç¤¾åŒºå§ï¼ ğŸ±ğŸ’•</p>
                        </div>
                        <div class="post-actions">
                            <button class="post-action-btn" onclick="likePost(${Date.now()}, this)">
                                <span>â¤ï¸</span>
                                <span>128</span>
                            </button>
                            <button class="post-action-btn" onclick="showComments(${Date.now()})">
                                <span>ğŸ’¬</span>
                                <span>32</span>
                            </button>
                            <button class="post-action-btn" onclick="sharePost(${Date.now()})">
                                <span>ğŸ“¤</span>
                                <span>åˆ†äº«</span>
                            </button>
                        </div>
                    </div>
                `;
                return;
            }

            postList.innerHTML = appData.posts.map(post => `
                <div class="post-card">
                    <div class="post-header">
                        <div class="post-avatar">${post.avatar}</div>
                        <div class="post-info">
                            <div class="post-author">${post.author}</div>
                            <div class="post-time">${post.time}</div>
                        </div>
                    </div>
                    <div class="post-content">
                        <h3 style="margin-bottom: var(--spacing-sm);">${post.title}</h3>
                        <p>${post.content}</p>
                        ${post.images.length > 0 ? `
                            <div class="post-images">
                                ${post.images.map(image => `<img src="${image}" class="post-image" alt="å¸–å­å›¾ç‰‡">`).join('')}
                            </div>
                        ` : ''}
                    </div>
                    <div class="post-actions">
                        <button class="post-action-btn ${post.liked ? 'liked' : ''}" onclick="likePost(${post.id}, this)">
                            <span>${post.liked ? 'â¤ï¸' : 'ğŸ¤'}</span>
                            <span>${post.likes}</span>
                        </button>
                        <button class="post-action-btn" onclick="showComments(${post.id})">
                            <span>ğŸ’¬</span>
                            <span>${post.comments.length}</span>
                        </button>
                        <button class="post-action-btn" onclick="sharePost(${post.id})">
                            <span>ğŸ“¤</span>
                            <span>åˆ†äº«</span>
                        </button>
                        ${appData.isAdmin ? `
                            <button class="post-action-btn admin-btn" onclick="deletePost(${post.id})">
                                <span>ğŸ—‘ï¸</span>
                                <span>åˆ é™¤</span>
                            </button>
                            <button class="post-action-btn admin-btn" onclick="pinPost(${post.id})">
                                <span>ğŸ“Œ</span>
                                <span>ç½®é¡¶</span>
                            </button>
                        ` : ''}
                    </div>
                    <div class="comments-section" id="comments-${post.id}">
                        ${post.comments.map(comment => `
                            <div class="comment-item">
                                <div class="comment-author">${comment.author}</div>
                                <div class="comment-content">${comment.content}</div>
                                <div class="comment-time">${comment.time}</div>
                            </div>
                        `).join('')}
                        <div class="comment-item">
                            <div class="form-group" style="margin: 0; display: flex; gap: 8px;">
                                <input type="text" class="input" id="comment-input-${post.id}" placeholder="å†™ä¸‹ä½ çš„è¯„è®º..." onkeypress="if(event.key==='Enter') addComment(${post.id}, this.value, this)">
                                <button class="btn btn-primary btn-small" onclick="addComment(${post.id}, document.getElementById('comment-input-${post.id}').value, document.getElementById('comment-input-${post.id}'))">å‘é€</button>
                            </div>
                        </div>
                    </div>
                    ${post.comments.length > 0 ? `
                        <div class="expand-comments" onclick="toggleComments(${post.id})">
                            <span id="expand-text-${post.id}">å±•å¼€æ‰€æœ‰è¯„è®º â–¼</span>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // ç‚¹èµå¸–å­
        function likePost(postId, button) {
            const post = appData.posts.find(p => p.id === postId);
            if (post) {
                post.liked = !post.liked;
                post.likes += post.liked ? 1 : -1;
                
                const btn = button.querySelector('span:first-child');
                const count = button.querySelector('span:last-child');
                
                btn.textContent = post.liked ? 'â¤ï¸' : 'ğŸ¤';
                button.classList.toggle('liked', post.liked);
                count.textContent = post.likes;
                
                showToast(post.liked ? 'å·²ç‚¹èµ' : 'å·²å–æ¶ˆç‚¹èµ', 'success');
            }
        }

        // æ˜¾ç¤ºè¯„è®º
        function showComments(postId) {
            const commentsSection = document.getElementById(`comments-${postId}`);
            if (commentsSection) {
                commentsSection.classList.add('expanded');
            }
        }

        // åˆ‡æ¢è¯„è®ºå±•å¼€/æ”¶èµ·
        function toggleComments(postId) {
            const commentsSection = document.getElementById(`comments-${postId}`);
            const expandText = document.getElementById(`expand-text-${postId}`);
            
            if (commentsSection.classList.contains('expanded')) {
                commentsSection.classList.remove('expanded');
                expandText.textContent = 'å±•å¼€æ‰€æœ‰è¯„è®º â–¼';
            } else {
                commentsSection.classList.add('expanded');
                expandText.textContent = 'æ”¶èµ·è¯„è®º â–²';
            }
        }

        // æ·»åŠ è¯„è®º
        function addComment(postId, content, input) {
            if (!content.trim()) {
                showToast('è¯·è¾“å…¥è¯„è®ºå†…å®¹', 'error');
                return;
            }
            
            const post = appData.posts.find(p => p.id === postId);
            if (post) {
                const comment = {
                    author: appData.currentUser ? appData.currentUser : 'æ¸¸å®¢',
                    content: content.trim(),
                    time: 'åˆšåˆš'
                };
                post.comments.push(comment);
                renderPosts();
                showToast('è¯„è®ºæˆåŠŸ', 'success');
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                if (input) {
                    input.value = '';
                }
            }
        }

        // åˆ†äº«å¸–å­
        function sharePost(postId) {
            showToast('åˆ†äº«åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // è·å–å½“å‰ä½ç½®
        function getCurrentLocation() {
            if (!navigator.geolocation) {
                showToast('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒå®šä½åŠŸèƒ½', 'error');
                return;
            }

            showToast('æ­£åœ¨è·å–ä½ç½®ä¿¡æ¯...', 'info');
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    appData.currentLocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };
                    showToast('å®šä½æˆåŠŸï¼', 'success');
                    initMap();
                    loadNearbyHospitals();
                },
                (error) => {
                    console.error('å®šä½å¤±è´¥:', error);
                    showToast('å®šä½å¤±è´¥ï¼Œè¯·æ£€æŸ¥å®šä½æƒé™', 'error');
                    // ä½¿ç”¨é»˜è®¤ä½ç½®ï¼ˆæ­å·å¸‚ä¸­å¿ƒï¼‰
                    appData.currentLocation = {
                        lat: 30.2741,
                        lng: 120.1551
                    };
                    initMap();
                    loadNearbyHospitals();
                }
            );
        }

        // åˆå§‹åŒ–åœ°å›¾
        function initMap() {
            const mapContainer = document.getElementById('mapContainer');
            
            // æ£€æŸ¥é«˜å¾·åœ°å›¾APIæ˜¯å¦åŠ è½½æˆåŠŸ
            if (typeof AMap !== 'undefined') {
                // ä½¿ç”¨çœŸæ­£çš„é«˜å¾·åœ°å›¾
                try {
                    const map = new AMap.Map('mapContainer', {
                        zoom: 13,
                        center: [appData.currentLocation.lng, appData.currentLocation.lat]
                    });

                    // æ·»åŠ å½“å‰ä½ç½®æ ‡è®°
                    const currentMarker = new AMap.Marker({
                        position: [appData.currentLocation.lng, appData.currentLocation.lat],
                        title: 'å½“å‰ä½ç½®'
                    });

                    map.add(currentMarker);

                    // æ·»åŠ æ‰€æœ‰åŒ»é™¢æ ‡è®°
                    appData.hospitals.forEach((hospital, index) => {
                        // ä½¿ç”¨çœŸå®çš„åŒ»é™¢åæ ‡
                        const hospitalPosition = [hospital.lng, hospital.lat];
                        
                        const marker = new AMap.Marker({
                            position: hospitalPosition,
                            title: hospital.name,
                            content: '<div style="font-size: 20px;">ğŸ¥</div>'
                        });

                        marker.on('click', function() {
                            selectHospital(hospital.id);
                        });

                        map.add(marker);
                    });

                    showToast('åœ°å›¾åŠ è½½æˆåŠŸï¼æ˜¾ç¤º ' + appData.hospitals.length + ' å®¶é™„è¿‘åŒ»é™¢', 'success');
                    
                } catch (error) {
                    console.error('åœ°å›¾åˆå§‹åŒ–å¤±è´¥:', error);
                    showFallbackMap();
                }
            } else {
                // é«˜å¾·APIæœªåŠ è½½ï¼Œæ˜¾ç¤ºå¤‡ç”¨åœ°å›¾
                showFallbackMap();
            }
        }

        // å¤‡ç”¨åœ°å›¾æ˜¾ç¤º
        function showFallbackMap() {
            const mapContainer = document.getElementById('mapContainer');
            
            mapContainer.innerHTML = `
                <div style="height: 100%; background: linear-gradient(to bottom, #e8f5e8, #f0f8f0); position: relative; cursor: move;" onclick="openExternalMap()">
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 48px;">ğŸ“</div>
                    <div style="position: absolute; top: 20px; left: 10px; background: white; padding: 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <div style="font-weight: 600;">ğŸ—ºï¸ åœ°å›¾è§†å›¾</div>
                        <div style="font-size: 12px; color: #666;">${appData.hospitals.length} å®¶é™„è¿‘åŒ»é™¢</div>
                        <div style="font-size: 10px; color: #999; margin-top: 4px;">ç‚¹å‡»æ‰“å¼€å¤–éƒ¨åœ°å›¾</div>
                    </div>
                    ${appData.hospitals.slice(0, 3).map((hospital, index) => {
                        const positions = [
                            { top: '30%', left: '20%' },
                            { top: '60%', left: '70%' },
                            { top: '40%', left: '40%' }
                        ];
                        return `
                            <div style="position: absolute; ${positions[index].top}; ${positions[index].left}; transform: translate(-50%, -50%); cursor: pointer;" onclick="event.stopPropagation(); selectHospital(${hospital.id})">
                                <div style="font-size: 24px;">ğŸ¥</div>
                                <div style="background: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; white-space: nowrap; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                    ${hospital.name}
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
            
            showToast('åœ°å›¾å·²åŠ è½½ï¼ˆç‚¹å‡»åœ°å›¾å¯æ‰“å¼€å¤–éƒ¨åœ°å›¾ï¼‰', 'info');
        }

        // æ‰“å¼€å¤–éƒ¨åœ°å›¾
        function openExternalMap() {
            if (appData.currentLocation) {
                const mapUrl = `https://uri.amap.com/navigation?to=${appData.currentLocation.lng},${appData.currentLocation.lat},å½“å‰ä½ç½®&mode=car`;
                window.open(mapUrl, '_blank');
            }
        }

        // åŠ è½½é™„è¿‘åŒ»é™¢
        function loadNearbyHospitals() {
            // é¦–å…ˆå°è¯•è·å–ç”¨æˆ·çœŸå®ä½ç½®
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        // æˆåŠŸè·å–ä½ç½®
                        appData.currentLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        console.log('è·å–åˆ°çœŸå®ä½ç½®:', appData.currentLocation);
                        generateHospitals();
                    },
                    function(error) {
                        // å®šä½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ä½ç½®
                        console.warn('å®šä½å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤ä½ç½®:', error.message);
                        appData.currentLocation = {
                            lat: 30.2741,
                            lng: 120.1551
                        };
                        generateHospitals();
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 5000,
                        maximumAge: 0
                    }
                );
            } else {
                // æµè§ˆå™¨ä¸æ”¯æŒå®šä½
                appData.currentLocation = {
                    lat: 30.2741,
                    lng: 120.1551
                };
                generateHospitals();
            }
        }

        // ç”ŸæˆåŒ»é™¢æ•°æ®
        function generateHospitals() {
            // æ¸…ç©ºç°æœ‰åŒ»é™¢æ•°æ®ï¼Œç¡®ä¿æ¯æ¬¡éƒ½é‡æ–°ç”Ÿæˆ
            appData.hospitals = [];
            
            // æ¯æ¬¡åˆ·æ–°éƒ½ç”Ÿæˆæ–°çš„éšæœºåŒ»é™¢åç§°å’Œæ•°æ®
            const hospitalPrefixes = ['çˆ±å¿ƒ', 'åå’Œ', 'èŒå® ', 'å®ˆæŠ¤', 'é˜³å…‰', 'è“å¤©', 'å¸Œæœ›', 'åº·ä¹', 'å¥åº·', 'å® çˆ±'];
            const hospitalSuffixes = ['å® ç‰©åŒ»é™¢', 'åŠ¨ç‰©åŒ»é™¢', 'å® ç‰©è¯Šæ‰€', 'å…½åŒ»é™¢', 'å® ç‰©ä¸­å¿ƒ'];
            
            const hospitalTemplates = [];
            
            // ç”Ÿæˆ7ä¸ªéšæœºåŒ»é™¢
            for (let i = 0; i < 7; i++) {
                const randomPrefix = hospitalPrefixes[Math.floor(Math.random() * hospitalPrefixes.length)];
                const randomSuffix = hospitalSuffixes[Math.floor(Math.random() * hospitalSuffixes.length)];
                hospitalTemplates.push({
                    prefix: randomPrefix,
                    suffix: randomSuffix,
                    baseRating: 4.0 + Math.random() * 1.0 // 4.0-5.0ä¹‹é—´çš„éšæœºè¯„åˆ†
                });
            }

            // åŸºäºå½“å‰ä½ç½®ç”ŸæˆåŒ»é™¢æ•°æ®
            const hospitalData = hospitalTemplates.map((template, index) => {
                // åœ¨ç”¨æˆ·ä½ç½®å‘¨å›´éšæœºåˆ†å¸ƒåŒ»é™¢
                const angle = (Math.PI * 2 * index) / hospitalTemplates.length;
                const distance = 0.5 + Math.random() * 5; // 0.5km - 5.5km èŒƒå›´å†…
                
                const lat = appData.currentLocation.lat + distance * Math.sin(angle) / 111;
                const lng = appData.currentLocation.lng + distance * Math.cos(angle) / (111 * Math.cos(appData.currentLocation.lat * Math.PI / 180));
                
                // æ ¹æ®å½“å‰ä½ç½®ç”Ÿæˆæ›´çœŸå®çš„åœ°å€
                let city = 'æ­å·å¸‚'; // é»˜è®¤æ­å·
                let districts, addressPrefix;
                
                // æ ¹æ®ç»çº¬åº¦åˆ¤æ–­åŸå¸‚
                if (appData.currentLocation.lat > 39 && appData.currentLocation.lat < 41 && 
                    appData.currentLocation.lng > 116 && appData.currentLocation.lng < 117) {
                    // åŒ—äº¬
                    city = 'åŒ—äº¬å¸‚';
                    districts = ['æœé˜³åŒº', 'æµ·æ·€åŒº', 'ä¸œåŸåŒº', 'è¥¿åŸåŒº', 'ä¸°å°åŒº', 'çŸ³æ™¯å±±åŒº', 'é€šå·åŒº', 'æ˜Œå¹³åŒº'];
                } else if (appData.currentLocation.lat > 31 && appData.currentLocation.lat < 32 && 
                          appData.currentLocation.lng > 121 && appData.currentLocation.lng < 122) {
                    // ä¸Šæµ·
                    city = 'ä¸Šæµ·å¸‚';
                    districts = ['æµ¦ä¸œæ–°åŒº', 'é»„æµ¦åŒº', 'å¾æ±‡åŒº', 'é•¿å®åŒº', 'é™å®‰åŒº', 'æ™®é™€åŒº', 'è™¹å£åŒº', 'æ¨æµ¦åŒº'];
                } else if (appData.currentLocation.lat > 22 && appData.currentLocation.lat < 24 && 
                          appData.currentLocation.lng > 113 && appData.currentLocation.lng < 115) {
                    // æ·±åœ³
                    city = 'æ·±åœ³å¸‚';
                    districts = ['ç¦ç”°åŒº', 'å—å±±åŒº', 'ç½—æ¹–åŒº', 'å®å®‰åŒº', 'é¾™å²—åŒº', 'é¾™ååŒº', 'åªå±±åŒº', 'å…‰æ˜åŒº'];
                } else if (appData.currentLocation.lat > 30 && appData.currentLocation.lat < 31 && 
                          appData.currentLocation.lng > 120 && appData.currentLocation.lng < 121) {
                    // æ­å·
                    city = 'æ­å·å¸‚';
                    districts = ['æ±Ÿå¹²åŒº', 'è¥¿æ¹–åŒº', 'æ‹±å¢…åŒº', 'æ»¨æ±ŸåŒº', 'ä¸ŠåŸåŒº', 'ä¸‹åŸåŒº', 'ä½™æ­åŒº', 'è§å±±åŒº'];
                } else {
                    // å…¶ä»–åŸå¸‚ï¼Œä½¿ç”¨é€šç”¨åç§°
                    districts = ['ä¸­å¿ƒåŒº', 'ä¸œåŒº', 'è¥¿åŒº', 'å—åŒº', 'åŒ—åŒº', 'æ–°åŒº', 'å¼€å‘åŒº', 'é«˜æ–°åŒº'];
                }
                
                const roads = ['è·¯', 'è¡—', 'å¤§é“', 'å··', 'å¹¿åœº', 'ä¸­å¿ƒ'];
                const numbers = Math.floor(Math.random() * 999) + 1;
                
                return {
                    id: index + 1,
                    name: template.prefix + template.suffix,
                    address: `${city}${districts[index % districts.length]}${roads[index % roads.length]}${numbers}å·`,
                    phone: `0571-${Math.floor(Math.random() * 90000000) + 10000000}`,
                    lat: lat,
                    lng: lng,
                    rating: parseFloat((template.baseRating + (Math.random() - 0.5)).toFixed(1)),
                    reviews: generateMockReviews()
                };
            });

            // è®¡ç®—è·ç¦»å¹¶æ’åº
            appData.hospitals = hospitalData.map(hospital => {
                const distance = calculateDistance(
                    appData.currentLocation.lat,
                    appData.currentLocation.lng,
                    hospital.lat,
                    hospital.lng
                );
                
                return {
                    ...hospital,
                    distance: distance,
                    distanceText: distance < 1 ? `${(distance * 1000).toFixed(0)}m` : `${distance.toFixed(1)}km`
                };
            }).sort((a, b) => a.distance - b.distance);

            renderHospitals();
            showToast(`æ‰¾åˆ° ${appData.hospitals.length} å®¶é™„è¿‘åŒ»é™¢`, 'info');
        }

        // ç”Ÿæˆæ¨¡æ‹Ÿè¯„è®º
        function generateMockReviews() {
            const reviewTemplates = [
                { author: 'çŒ«ä¸»äºº', content: 'åŒ»ç”Ÿå¾ˆä¸“ä¸šï¼ŒæœåŠ¡æ€åº¦å¾ˆå¥½', rating: 5 },
                { author: 'çˆ±çŒ«äººå£«', content: 'ä»·æ ¼åˆç†ï¼Œç¯å¢ƒå¹²å‡€', rating: 4 },
                { author: 'å® ç‰©å®¶é•¿', content: 'æ€¥è¯Šå¾ˆå¿«ï¼Œè®¾å¤‡å…ˆè¿›', rating: 5 },
                { author: 'çŒ«å¥´', content: 'åŒ»ç”Ÿå¾ˆè€å¿ƒï¼Œè§£ç­”è¯¦ç»†', rating: 4 },
                { author: 'é“²å±å®˜', content: 'æœåŠ¡ä¸€æµï¼Œæ¨èï¼', rating: 5 },
                { author: 'å® ç‰©çˆ±å¥½è€…', content: 'ç¯å¢ƒå¾ˆå¥½ï¼ŒåŒ»ç”Ÿä¸“ä¸š', rating: 4 },
                { author: 'å…»çŒ«è¾¾äºº', content: 'ä»·æ ¼å®æƒ ï¼ŒæœåŠ¡æ€åº¦å¥½', rating: 4 }
            ];
            
            const numReviews = Math.floor(Math.random() * 3) + 1; // 1-3æ¡è¯„è®º
            const selectedReviews = [];
            
            for (let i = 0; i < numReviews; i++) {
                const template = reviewTemplates[Math.floor(Math.random() * reviewTemplates.length)];
                selectedReviews.push({
                    ...template,
                    time: [`${Math.floor(Math.random() * 7) + 1}å¤©å‰`, '1å‘¨å‰', '2å‘¨å‰'][Math.floor(Math.random() * 3)]
                });
            }
            
            return selectedReviews;
        }

        // è®¡ç®—ä¸¤ç‚¹ä¹‹é—´è·ç¦»ï¼ˆä½¿ç”¨Haversineå…¬å¼ï¼‰
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // åœ°çƒåŠå¾„ï¼ˆå…¬é‡Œï¼‰
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            const distance = R * c;
            return distance;
        }

        // æ¸²æŸ“åŒ»é™¢åˆ—è¡¨
        function renderHospitals() {
            const hospitalList = document.getElementById('hospitalList');
            hospitalList.innerHTML = appData.hospitals.map(hospital => `
                <div class="hospital-card">
                    <div class="hospital-header">
                        <div class="hospital-name">${hospital.name}</div>
                        <div class="hospital-info">
                            <div>ğŸ“ ${hospital.address}</div>
                            <div>ğŸ“ ${hospital.phone}</div>
                            <div>ğŸš¶ è·ç¦» ${hospital.distanceText}</div>
                        </div>
                        <div class="hospital-rating">
                            <span class="rating-stars">${'â­'.repeat(Math.floor(hospital.rating))}</span>
                            <span>${hospital.rating} åˆ†</span>
                            <span style="color: var(--apple-gray-medium);">(${hospital.reviews.length} æ¡è¯„ä»·)</span>
                        </div>
                    </div>
                    <div class="hospital-actions">
                        <button class="btn btn-primary btn-small" onclick="selectHospital(${hospital.id})">ğŸ§­ å¯¼èˆª</button>
                        <button class="btn btn-secondary btn-small" onclick="openGaodeMap(${hospital.id})">ğŸ—ºï¸ é«˜å¾·</button>
                        <button class="btn btn-secondary btn-small" onclick="openHospitalReviewModal(${hospital.id})">â­ è¯„ä»·</button>
                    </div>
                    <div class="comments-section" id="hospital-comments-${hospital.id}">
                        ${hospital.reviews.map(review => `
                            <div class="comment-item">
                                <div class="comment-author">${review.author} ${'â­'.repeat(review.rating)}</div>
                                <div class="comment-content">${review.content}</div>
                                <div class="comment-time">${review.time}</div>
                            </div>
                        `).join('')}
                    </div>
                    ${hospital.reviews.length > 0 ? `
                        <div class="expand-comments" onclick="toggleHospitalComments(${hospital.id})">
                            <span id="hospital-expand-${hospital.id}">å±•å¼€è¯„ä»· â–¼</span>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // åˆ‡æ¢åŒ»é™¢è¯„è®ºå±•å¼€/æ”¶èµ·
        function toggleHospitalComments(hospitalId) {
            const commentsSection = document.getElementById(`hospital-comments-${hospitalId}`);
            const expandText = document.getElementById(`hospital-expand-${hospitalId}`);
            
            if (commentsSection.classList.contains('expanded')) {
                commentsSection.classList.remove('expanded');
                expandText.textContent = 'å±•å¼€è¯„ä»· â–¼';
            } else {
                commentsSection.classList.add('expanded');
                expandText.textContent = 'æ”¶èµ·è¯„ä»· â–²';
            }
        }

        // é€‰æ‹©åŒ»é™¢ - ç›´æ¥è·³è½¬é«˜å¾·åœ°å›¾
        function selectHospital(hospitalId) {
            const hospital = appData.hospitals.find(h => h.id === hospitalId);
            if (hospital) {
                showToast(`æ­£åœ¨è·³è½¬åˆ°é«˜å¾·åœ°å›¾å¯¼èˆªåˆ° ${hospital.name}...`, 'info');
                
                // æ„å»ºé«˜å¾·åœ°å›¾å¯¼èˆªURLï¼Œç›®çš„åœ°ä¸ºé€‰ä¸­çš„åŒ»é™¢
                const gaodeUrl = `https://uri.amap.com/navigation?to=${hospital.lng},${hospital.lat},${encodeURIComponent(hospital.name)}&mode=car&coordinate=${appData.currentLocation.lng},${appData.currentLocation.lat}`;
                
                // å»¶è¿Ÿè·³è½¬ï¼Œè®©æç¤ºå…ˆæ˜¾ç¤º
                setTimeout(() => {
                    window.open(gaodeUrl, '_blank');
                }, 500);
            }
        }

        // æ‰“å¼€åŒ»é™¢è¯„ä»·æ¨¡æ€æ¡†
        function openHospitalReviewModal(hospitalId) {
            document.getElementById('hospitalReviewModal').classList.add('active');
            document.getElementById('reviewHospitalId').value = hospitalId;
            document.getElementById('reviewContent').value = '';
            // é‡ç½®æ˜Ÿçº§é€‰æ‹©
            document.querySelectorAll('.star').forEach(star => star.style.opacity = '0.3');
        }

        // å…³é—­åŒ»é™¢è¯„ä»·æ¨¡æ€æ¡†
        function closeHospitalReviewModal() {
            document.getElementById('hospitalReviewModal').classList.remove('active');
        }

        // æäº¤åŒ»é™¢è¯„ä»·
        function submitReview() {
            const hospitalId = parseInt(document.getElementById('reviewHospitalId').value);
            const content = document.getElementById('reviewContent').value.trim();
            const selectedRating = parseInt(document.querySelector('.star[style*="opacity: 1"]')?.dataset.rating || 0);

            if (selectedRating === 0) {
                showToast('è¯·é€‰æ‹©è¯„åˆ†', 'error');
                return;
            }

            if (!content) {
                showToast('è¯·å¡«å†™è¯„ä»·å†…å®¹', 'error');
                return;
            }

            const hospital = appData.hospitals.find(h => h.id === hospitalId);
            if (hospital) {
                const review = {
                    author: 'ç”¨æˆ·' + Math.floor(Math.random() * 1000),
                    content: content,
                    time: 'åˆšåˆš',
                    rating: selectedRating
                };

                hospital.reviews.push(review);
                // é‡æ–°è®¡ç®—å¹³å‡è¯„åˆ†
                const totalRating = hospital.reviews.reduce((sum, r) => sum + r.rating, 0);
                hospital.rating = (totalRating / hospital.reviews.length).toFixed(1);

                renderHospitals();
                closeHospitalReviewModal();
                showToast('è¯„ä»·æäº¤æˆåŠŸï¼', 'success');
            }
        }

        // åˆ·æ–°åŒ»é™¢åˆ—è¡¨
        function refreshHospitals() {
            showToast('æ­£åœ¨åˆ·æ–°åŒ»é™¢ä¿¡æ¯...', 'info');
            loadNearbyHospitals();
            setTimeout(() => {
                showToast('åˆ·æ–°å®Œæˆï¼', 'success');
            }, 1000);
        }

        // è¿‡æ»¤åŒ»é™¢
        function filterHospitals(searchTerm) {
            const filtered = appData.hospitals.filter(hospital => 
                hospital.name.includes(searchTerm) || 
                hospital.address.includes(searchTerm)
            );
            
            const hospitalList = document.getElementById('hospitalList');
            if (filtered.length === 0) {
                hospitalList.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--apple-gray-medium);">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„åŒ»é™¢</div>';
            } else {
                const tempHospitals = appData.hospitals;
                appData.hospitals = filtered;
                renderHospitals();
                appData.hospitals = tempHospitals;
            }
        }

        // æ˜Ÿçº§è¯„åˆ†äº¤äº’
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.star').forEach(star => {
                star.addEventListener('click', function() {
                    const rating = parseInt(this.dataset.rating);
                    document.querySelectorAll('.star').forEach((s, index) => {
                        s.style.opacity = (index < rating) ? '1' : '0.3';
                    });
                });

                star.addEventListener('mouseenter', function() {
                    const rating = parseInt(this.dataset.rating);
                    document.querySelectorAll('.star').forEach((s, index) => {
                        s.style.opacity = (index < rating) ? '1' : '0.3';
                    });
                });
            });

            document.getElementById('ratingStars')?.addEventListener('mouseleave', function() {
                const selectedRating = parseInt(document.querySelector('.star[style*="opacity: 1"]')?.dataset.rating || 0);
                document.querySelectorAll('.star').forEach((s, index) => {
                    s.style.opacity = (index < selectedRating) ? '1' : '0.3';
                });
            });
        });

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ é‡‘çŒ«ä¹‹å®¶åŠ è½½å®Œæˆ');
            
            try {
                // ç¡®ä¿é¦–é¡µæ˜¾ç¤º
                const homePage = document.getElementById('home');
                if (homePage) {
                    homePage.classList.add('active');
                    console.log('âœ… é¦–é¡µå·²æ¿€æ´»');
                }
                
                // åˆå§‹åŒ–è®ºå›å¸–å­
                renderPosts();
                
                // åŒ»é™¢æ•°æ®éœ€è¦æ‰‹åŠ¨åˆ·æ–°ï¼Œä¸è‡ªåŠ¨åŠ è½½
                
                // åˆå§‹åŒ–çŒ«å’ªåˆ—è¡¨
                initDefaultCats();
                renderCats();
                
                // åˆå§‹åŒ–ç™»å½•æŒ‰é’®å’Œç®¡ç†å‘˜çŠ¶æ€
                updateLoginButton();
                
                // å¦‚æœå·²ç™»å½•ç®¡ç†å‘˜ï¼Œå¯ç”¨æ‰€æœ‰åŠŸèƒ½
                if (appData.isAdmin) {
                    enableAdminFeatures();
                }
                
                // ä¸“é—¨ä¸ºç™»å½•æŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
                const loginBtn = document.getElementById('loginBtn');
                if (loginBtn) {
                    // ç§»é™¤å¯èƒ½å­˜åœ¨çš„äº‹ä»¶ç›‘å¬å™¨
                    loginBtn.replaceWith(loginBtn.cloneNode(true));
                    const newLoginBtn = document.getElementById('loginBtn');
                    
                    // æ·»åŠ æ–°çš„äº‹ä»¶ç›‘å¬å™¨
                    newLoginBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('Login button clicked via addEventListener');
                        toggleLogin();
                    });
                    
                    console.log('âœ… ç™»å½•æŒ‰é’®äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
                }
                
                // æ£€æŸ¥æ‰€æœ‰onclickåŠŸèƒ½
                document.querySelectorAll('[onclick]').forEach(element => {
                    console.log('âœ… æ£€æŸ¥onclickå…ƒç´ :', element);
                });
                
                // æ£€æŸ¥é«˜å¾·åœ°å›¾APIåŠ è½½çŠ¶æ€
                if (typeof AMap !== 'undefined') {
                    console.log('âœ… é«˜å¾·åœ°å›¾APIåŠ è½½æˆåŠŸ');
                    showToast('é«˜å¾·åœ°å›¾å·²å°±ç»ª', 'success');
                } else {
                    console.log('âš ï¸ é«˜å¾·åœ°å›¾APIæœªåŠ è½½ï¼Œå°†ä½¿ç”¨å¤‡ç”¨åœ°å›¾');
                }
                
                // æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
                setTimeout(() => {
                    showToast('ğŸ‰ æ¬¢è¿æ¥åˆ°é‡‘çŒ«ä¹‹å®¶ï¼', 'success');
                }, 500);
                
            } catch (error) {
                console.error('âŒ åˆå§‹åŒ–é”™è¯¯:', error);
                showToast('é¡µé¢åŠ è½½å®Œæˆ', 'success');
            }
        });

        // é”™è¯¯å¤„ç†
        window.addEventListener('error', function(e) {
            console.error('å…¨å±€é”™è¯¯:', e.error);
        });

        // ç§»åŠ¨ç«¯å¯¼èˆªåˆ‡æ¢
        document.querySelector('.mobile-nav-toggle')?.addEventListener('click', function() {
            const navMenu = document.querySelector('.nav-menu');
            navMenu.style.display = navMenu.style.display === 'flex' ? 'none' : 'flex';
        });

        // ä¸ªäººä¸­å¿ƒç›¸å…³åŠŸèƒ½
        function showAddressManager() {
            showToast('åœ°å€ç®¡ç†åŠŸèƒ½å¼€å‘ä¸­...', 'info');
            // è¿™é‡Œå¯ä»¥æ·»åŠ åœ°å€ç®¡ç†æ¨¡æ€æ¡†
        }

        function showOrderManager() {
            showToast('è®¢å•ç®¡ç†åŠŸèƒ½å¼€å‘ä¸­...', 'info');
            // è¿™é‡Œå¯ä»¥æ·»åŠ è®¢å•ç®¡ç†æ¨¡æ€æ¡†
        }

        function showSettings() {
            showToast('è®¾ç½®åŠŸèƒ½å¼€å‘ä¸­...', 'info');
            // è¿™é‡Œå¯ä»¥æ·»åŠ è®¾ç½®æ¨¡æ€æ¡†
        }

        function showAbout() {
            showToast('é‡‘çŒ«ä¹‹å®¶ v1.0 - æ­å·è‡ªå®¶å°çŒ«å’ª-æå…ˆç”Ÿçš„å® ç‰©ç¤¾åŒºå¹³å°', 'info');
        }

        function showVersion() {
            showToast('ç‰ˆæœ¬ï¼š1.0.0 | æ›´æ–°æ—¶é—´ï¼š2024å¹´', 'info');
        }

        // æ›´æ–°ç®¡ç†å‘˜èœå•æ˜¾ç¤º
        function updateProfileMenu() {
            const adminMenuItems = document.getElementById('adminMenuItems');
            const userName = document.getElementById('userName');
            
            if (appData.isAdmin) {
                if (adminMenuItems) adminMenuItems.style.display = 'block';
                if (userName) userName.textContent = 'ç®¡ç†å‘˜';
            } else {
                if (adminMenuItems) adminMenuItems.style.display = 'none';
                if (userName) userName.textContent = 'æ¸¸å®¢ç”¨æˆ·';
            }
        }

        // å•†åŸç®¡ç†åŠŸèƒ½
        function openShopManager() {
            document.getElementById('shopManagerModal').classList.add('active');
            // æ¸…ç©ºè¡¨å•
            document.getElementById('productName').value = '';
            document.getElementById('productPrice').value = '';
            document.getElementById('productTaobaoUrl').value = '';
            document.getElementById('productDescription').value = '';
        }

        function closeShopManager() {
            document.getElementById('shopManagerModal').classList.remove('active');
        }

        function saveProduct() {
            const name = document.getElementById('productName').value.trim();
            const category = document.getElementById('productCategory').value;
            const price = document.getElementById('productPrice').value.trim();
            const taobaoUrl = document.getElementById('productTaobaoUrl').value.trim();
            const icon = document.getElementById('productIcon').value;
            const description = document.getElementById('productDescription').value.trim();

            if (!name || !price || !taobaoUrl) {
                showToast('è¯·å¡«å†™å¿…è¦ä¿¡æ¯', 'error');
                return;
            }

            const product = {
                id: Date.now(),
                name: name,
                category: category,
                price: price,
                taobaoUrl: taobaoUrl,
                icon: icon,
                description: description || 'ä¼˜è´¨å® ç‰©ç”¨å“',
                addedBy: appData.currentUser,
                addedTime: new Date().toLocaleString()
            };

            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            const products = JSON.parse(localStorage.getItem('customProducts') || '[]');
            products.push(product);
            localStorage.setItem('customProducts', JSON.stringify(products));

            closeShopManager();
            showToast('å•†å“æ·»åŠ æˆåŠŸï¼', 'success');
        }

        // åŒ»é™¢ç®¡ç†åŠŸèƒ½
        function openHospitalManager() {
            document.getElementById('hospitalManagerModal').classList.add('active');
            // æ¸…ç©ºè¡¨å•
            document.getElementById('hospitalName').value = '';
            document.getElementById('hospitalAddress').value = '';
            document.getElementById('hospitalPhone').value = '';
            document.getElementById('hospitalLng').value = '';
            document.getElementById('hospitalLat').value = '';
            document.getElementById('hospitalDescription').value = '';
        }

        function closeHospitalManager() {
            document.getElementById('hospitalManagerModal').classList.remove('active');
        }

        function saveHospital() {
            const name = document.getElementById('hospitalName').value.trim();
            const address = document.getElementById('hospitalAddress').value.trim();
            const phone = document.getElementById('hospitalPhone').value.trim();
            const lng = parseFloat(document.getElementById('hospitalLng').value) || 120.1551;
            const lat = parseFloat(document.getElementById('hospitalLat').value) || 30.2741;
            const description = document.getElementById('hospitalDescription').value.trim();

            if (!name || !address || !phone) {
                showToast('è¯·å¡«å†™å¿…è¦ä¿¡æ¯', 'error');
                return;
            }

            const hospital = {
                id: Date.now(),
                name: name,
                address: address,
                phone: phone,
                lat: lat,
                lng: lng,
                rating: 4.5 + Math.random() * 0.5,
                reviews: [],
                distance: 0,
                distanceText: '0m',
                isCustom: true,
                addedBy: appData.currentUser,
                addedTime: new Date().toLocaleString()
            };

            // æ·»åŠ åˆ°ç°æœ‰åŒ»é™¢åˆ—è¡¨
            appData.hospitals.unshift(hospital);
            renderHospitals();
            closeHospitalManager();
            showToast('åŒ»é™¢æ·»åŠ æˆåŠŸï¼', 'success');
        }
    </script>
</body>
</html>