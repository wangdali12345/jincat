<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>æ­å·è‡ªå®¶å°çŒ«å’ª-æå…ˆç”Ÿ - å® ç‰©ç¤¾åŒºå¹³å°</title>
    
    <!-- åœ°å›¾API -->
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=0d3b3b8f6e6e4f7b9a6e6e6e6e6e6e6&plugin=AMap.Geolocation,AMap.PlaceSearch,AMap.Geocoder,AMap.ToolBar,AMap.Autocomplete,AMap.Driving"></script>
    
    <style>
        /* è‹¹æœé£æ ¼å…¨å±€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* è‹¹æœé£æ ¼é…è‰² */
            --apple-black: #1d1d1f;
            --apple-gray-light: #f5f5f7;
            --apple-gray-medium: #86868b;
            --apple-gray-dark: #6e6e73;
            --apple-blue: #0071e3;
            --apple-blue-hover: #0051d5;
            --apple-green: #34c759;
            --apple-orange: #ff9500;
            --apple-red: #ff3b30;
            --apple-purple: #af52de;
            --apple-white: #fbfbfd;
            --apple-border: #d2d2d7;
            
            /* å­—ä½“ç³»ç»Ÿ */
            --font-family: "SF Pro Display", "SF Pro Text", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            
            /* é—´è·ç³»ç»Ÿ */
            --spacing-xs: 8px;
            --spacing-sm: 16px;
            --spacing-md: 32px;
            --spacing-lg: 48px;
            --spacing-xl: 64px;
            --spacing-xxl: 96px;
            
            /* åœ†è§’ */
            --border-radius-sm: 6px;
            --border-radius-md: 12px;
            --border-radius-lg: 18px;
            
            /* é˜´å½± */
            --shadow-light: 0 4px 20px rgba(0, 0, 0, 0.05);
            --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.12);
            --shadow-heavy: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: var(--font-family);
            background: linear-gradient(135deg, #FFF8E1 0%, #FFE0B2 100%);
            color: var(--apple-black);
            line-height: 1.47059;
            font-weight: 400;
            letter-spacing: -0.022em;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
        }

        /* å®¹å™¨ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-sm);
        }

        /* å¯¼èˆªæ  */
        .nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--apple-border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px;
        }

        .nav-menu {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-link {
            text-decoration: none;
            color: var(--apple-black);
            font-weight: 500;
            transition: color 0.3s ease;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
        }

        .nav-link:hover, .nav-link.active {
            color: var(--apple-blue);
            background: rgba(0, 113, 227, 0.1);
        }

        .logo {
            font-size: 16px;
            font-weight: 600;
            color: var(--apple-black);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ç”¨æˆ·èœå• */
        .user-menu {
            position: relative;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--apple-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .user-avatar:hover {
            background: var(--apple-blue-hover);
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-heavy);
            min-width: 200px;
            display: none;
            z-index: 1000;
            margin-top: 8px;
        }

        .user-dropdown.active {
            display: block;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dropdown-item {
            padding: 12px 16px;
            cursor: pointer;
            transition: background 0.3s ease;
            border-bottom: 1px solid var(--apple-gray-light);
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item:hover {
            background: var(--apple-gray-light);
        }

        .dropdown-item:first-child {
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        }

        .dropdown-item:last-child {
            border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
        }

        /* é¡µé¢åˆ‡æ¢ */
        .page {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* é¡µé¢æ ‡é¢˜ */
        .page-title {
            font-size: 48px;
            font-weight: 600;
            text-align: center;
            margin: var(--spacing-xl) 0 var(--spacing-lg);
            background: linear-gradient(135deg, var(--apple-blue), var(--apple-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-light);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
        }

        /* ç½‘æ ¼å¸ƒå±€ */
        .grid {
            display: grid;
            gap: var(--spacing-md);
        }

        .grid-2 {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }

        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .grid-4 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            background: var(--apple-blue);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .btn:hover {
            background: var(--apple-blue-hover);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 113, 227, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--apple-gray-medium);
        }

        .btn-secondary:hover {
            background: var(--apple-gray-dark);
        }

        .btn-success {
            background: var(--apple-green);
        }

        .btn-success:hover {
            background: #2da54a;
        }

        .btn-danger {
            background: var(--apple-red);
        }

        .btn-danger:hover {
            background: #d12b20;
        }

        .btn-warning {
            background: var(--apple-orange);
        }

        .btn-warning:hover {
            background: #e68500;
        }

        /* è¡¨å•æ ·å¼ */
        .form-group {
            margin-bottom: var(--spacing-sm);
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--apple-black);
        }

        .form-control {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--apple-border);
            border-radius: var(--border-radius-sm);
            font-size: 16px;
            font-family: inherit;
            background: white;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--apple-blue);
            box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.1);
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236e6e73' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            padding-right: 36px;
        }

        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius-lg);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        .modal-header {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--apple-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 24px;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: var(--apple-gray-medium);
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: var(--apple-gray-light);
            color: var(--apple-black);
        }

        .modal-body {
            padding: var(--spacing-md);
        }

        .modal-footer {
            padding: var(--spacing-md);
            border-top: 1px solid var(--apple-border);
            display: flex;
            gap: var(--spacing-sm);
            justify-content: flex-end;
        }

        /* å›¾ç‰‡ä¸Šä¼  */
        .image-upload {
            border: 2px dashed var(--apple-border);
            border-radius: var(--border-radius-md);
            padding: var(--spacing-md);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .image-upload:hover {
            border-color: var(--apple-blue);
            background: rgba(0, 113, 227, 0.05);
        }

        .image-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: var(--spacing-sm);
            margin-top: var(--spacing-sm);
        }

        .preview-image {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .preview-image:hover {
            transform: scale(1.05);
        }

        /* çŒ«å’ªå¡ç‰‡ */
        .cat-card {
            background: white;
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .cat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
        }

        .cat-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .cat-info {
            padding: var(--spacing-sm);
        }

        .cat-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .cat-details {
            color: var(--apple-gray-medium);
            font-size: 14px;
            line-height: 1.4;
        }

        /* æœç´¢å’Œç­›é€‰ */
        .search-bar {
            display: flex;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
            flex-wrap: wrap;
        }

        .search-bar .form-control {
            flex: 1;
            min-width: 200px;
        }

        .search-bar .form-select {
            min-width: 150px;
        }

        /* è¯„è®ºæ ·å¼ */
        .comment-item {
            background: var(--apple-gray-light);
            border-radius: var(--border-radius-md);
            padding: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .comment-author {
            font-weight: 600;
            color: var(--apple-blue);
        }

        .comment-time {
            font-size: 12px;
            color: var(--apple-gray-medium);
        }

        .comment-content {
            line-height: 1.4;
        }

        /* è®ºå›å¸–å­ */
        .forum-post {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
            box-shadow: var(--shadow-light);
        }

        .forum-post-header {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-sm);
        }

        .forum-post-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--apple-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .forum-post-info {
            flex: 1;
        }

        .forum-post-author {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .forum-post-time {
            font-size: 12px;
            color: var(--apple-gray-medium);
        }

        .forum-post-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
        }

        .forum-post-content {
            line-height: 1.5;
            color: var(--apple-black);
            margin-bottom: var(--spacing-sm);
        }

        .forum-post-stats {
            display: flex;
            gap: var(--spacing-md);
            color: var(--apple-gray-medium);
            font-size: 14px;
        }

        /* å•†å“å¡ç‰‡ */
        .product-card {
            background: white;
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .product-info {
            padding: var(--spacing-sm);
        }

        .product-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .product-price {
            color: var(--apple-red);
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .product-description {
            color: var(--apple-gray-medium);
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: var(--spacing-sm);
        }

        /* è´­ç‰©è½¦ */
        .cart-item {
            display: flex;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            border-bottom: 1px solid var(--apple-border);
            align-items: center;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: var(--border-radius-sm);
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .cart-item-price {
            color: var(--apple-red);
            font-weight: 600;
        }

        .cart-item-quantity {
            display: flex;
            align-items: center;
            gap: var(--spacing-xs);
        }

        .quantity-btn {
            width: 24px;
            height: 24px;
            border: 1px solid var(--apple-border);
            background: white;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .quantity-btn:hover {
            background: var(--apple-gray-light);
        }

        /* åœ°å›¾ */
        #mapContainer {
            height: 500px;
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            margin-bottom: var(--spacing-md);
        }

        .hospital-list {
            background: white;
            border-radius: var(--border-radius-lg);
            overflow: hidden;
        }

        .hospital-item {
            padding: var(--spacing-sm);
            border-bottom: 1px solid var(--apple-border);
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .hospital-item:hover {
            background: var(--apple-gray-light);
        }

        .hospital-name {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .hospital-address {
            color: var(--apple-gray-medium);
            font-size: 14px;
            margin-bottom: 4px;
        }

        .hospital-phone {
            color: var(--apple-blue);
            font-size: 14px;
        }

        /* ç‰©æµè¿½è¸ª */
        .logistics-item {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
            box-shadow: var(--shadow-light);
        }

        .logistics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-sm);
            padding-bottom: var(--spacing-sm);
            border-bottom: 1px solid var(--apple-border);
        }

        .logistics-company {
            font-weight: 600;
            font-size: 18px;
        }

        .logistics-number {
            color: var(--apple-gray-medium);
            font-size: 14px;
        }

        .logistics-status {
            color: var(--apple-green);
            font-weight: 600;
        }

        .timeline {
            position: relative;
            padding-left: 20px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--apple-border);
        }

        .timeline-item {
            position: relative;
            padding-bottom: var(--spacing-sm);
            padding-left: var(--spacing-sm);
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -6px;
            top: 6px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--apple-blue);
        }

        .timeline-item.completed::before {
            background: var(--apple-green);
        }

        .timeline-time {
            font-size: 12px;
            color: var(--apple-gray-medium);
            margin-bottom: 2px;
        }

        .timeline-content {
            font-size: 14px;
            line-height: 1.4;
        }

        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .stat-card {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-md);
            text-align: center;
            box-shadow: var(--shadow-light);
        }

        .stat-number {
            font-size: 36px;
            font-weight: 700;
            color: var(--apple-blue);
            margin-bottom: var(--spacing-xs);
        }

        .stat-label {
            color: var(--apple-gray-medium);
            font-size: 14px;
        }

        /* ç©ºçŠ¶æ€ */
        .empty-state {
            text-align: center;
            padding: var(--spacing-xxl);
            color: var(--apple-gray-medium);
        }

        .empty-state h3 {
            margin-bottom: var(--spacing-sm);
            font-size: 20px;
        }

        /* Toast æç¤º */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--apple-black);
            color: white;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-heavy);
            display: none;
            align-items: center;
            gap: var(--spacing-sm);
            animation: slideUp 0.3s ease;
            z-index: 2000;
        }

        .toast.active {
            display: flex;
        }

        .toast.success {
            background: var(--apple-green);
        }

        .toast.error {
            background: var(--apple-red);
        }

        .toast.warning {
            background: var(--apple-orange);
        }

        /* ç®¡ç†å‘˜é¢æ¿ */
        .admin-section {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            box-shadow: var(--shadow-light);
        }

        .admin-section h3 {
            margin-bottom: var(--spacing-sm);
            font-size: 20px;
            font-weight: 600;
        }

        .activity-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm);
            background: var(--apple-gray-light);
            border-radius: var(--border-radius-md);
        }

        .activity-icon {
            font-size: 20px;
        }

        .activity-info {
            flex: 1;
        }

        .activity-text {
            font-size: 14px;
            line-height: 1.4;
        }

        .activity-time {
            font-size: 12px;
            color: var(--apple-gray-medium);
        }

        /* ç™»å½•è¡¨å• */
        .login-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--apple-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            margin: 0 auto var(--spacing-md);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 0 12px;
            }

            .nav-menu {
                flex-direction: column;
                gap: 8px;
            }

            .page-title {
                font-size: 32px;
                margin: var(--spacing-lg) 0 var(--spacing-md);
            }

            .grid-2,
            .grid-3,
            .grid-4 {
                grid-template-columns: 1fr;
            }

            .search-bar {
                flex-direction: column;
            }

            .search-bar .form-control,
            .search-bar .form-select {
                min-width: auto;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .modal-content {
                width: 95%;
                margin: 10px;
            }

            .cart-item {
                flex-direction: column;
                align-items: flex-start;
            }

            #mapContainer {
                height: 300px;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .nav-content {
                flex-direction: column;
                height: auto;
                padding: 10px 0;
            }

            .user-dropdown {
                position: fixed;
                top: auto;
                bottom: 0;
                left: 0;
                right: 0;
                border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
                margin: 0;
                animation: slideUp 0.3s ease;
            }
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--apple-gray-light);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--apple-gray-medium);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--apple-gray-dark);
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="nav">
        <div class="container">
            <div class="nav-content">
                <a href="#" class="logo">ğŸ± é‡‘çŒ«ä¹‹å®¶</a>
                <div class="nav-menu">
                    <a href="#" class="nav-link active" data-page="home">ğŸ  é¦–é¡µ</a>
                    <a href="#" class="nav-link" data-page="cats">ğŸ± çŒ«å’ª</a>
                    <a href="#" class="nav-link" data-page="hospital">ğŸ¥ å® ç‰©åŒ»é™¢</a>
                    <a href="#" class="nav-link" data-page="logistics">ğŸ“¦ ç‰©æµæŸ¥è¯¢</a>
                    <a href="#" class="nav-link" data-page="forum">ğŸ’¬ è®ºå›</a>
                    <a href="#" class="nav-link" data-page="shop">ğŸ›ï¸ å•†åŸ</a>
                </div>
                
                <div class="user-menu">
                    <div class="user-avatar" onclick="toggleUserMenu()">ğŸ‘¤</div>
                    <div id="cartCount" class="cart-count" style="position: absolute; top: -5px; right: -5px; background: var(--apple-red); color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; display: none;">0</div>
                    <div id="userDropdown" class="user-dropdown">
                        <div class="dropdown-item" onclick="showProfile()">ğŸ‘¤ ä¸ªäººä¸­å¿ƒ</div>
                        <div class="dropdown-item" onclick="showCart()">ğŸ›’ è´­ç‰©è½¦</div>
                        <div class="dropdown-item" onclick="showOrders()">ğŸ“‹ æˆ‘çš„è®¢å•</div>
                        <div class="dropdown-item" onclick="showLoginModal()">ğŸ” ç®¡ç†å‘˜ç™»å½•</div>
                        <div class="dropdown-item" onclick="adminLogout()" style="display: none;" id="logoutBtn">ğŸšª é€€å‡ºç™»å½•</div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»é¡µ -->
    <div id="home" class="page active">
        <div class="container">
            <h1 class="page-title">ğŸ± é‡‘çŒ«ä¹‹å®¶</h1>
            
            <!-- åŠŸèƒ½ç½‘æ ¼ -->
            <div class="grid grid-3">
                <div class="card" onclick="showPage('cats')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ±</div>
                        <h3>çŒ«å’ªç®¡ç†</h3>
                        <p style="color: var(--apple-gray-medium);">æŸ¥çœ‹å’Œç®¡ç†çŒ«å’ªä¿¡æ¯</p>
                    </div>
                </div>
                
                <div class="card" onclick="showPage('hospital')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ¥</div>
                        <h3>å® ç‰©åŒ»é™¢</h3>
                        <p style="color: var(--apple-gray-medium);">æŸ¥æ‰¾é™„è¿‘å® ç‰©åŒ»é™¢</p>
                    </div>
                </div>
                
                <div class="card" onclick="showPage('logistics')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ“¦</div>
                        <h3>ç‰©æµæŸ¥è¯¢</h3>
                        <p style="color: var(--apple-gray-medium);">è¿½è¸ªç‰©æµä¿¡æ¯</p>
                    </div>
                </div>
                
                <div class="card" onclick="showPage('forum')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ’¬</div>
                        <h3>è®ºå›äº¤æµ</h3>
                        <p style="color: var(--apple-gray-medium);">ä¸å…¶ä»–å® ç‰©ä¸»äººäº¤æµ</p>
                    </div>
                </div>
                
                <div class="card" onclick="showPage('shop')">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">ğŸ›ï¸</div>
                        <h3>å® ç‰©å•†åŸ</h3>
                        <p style="color: var(--apple-gray-medium);">è´­ä¹°å® ç‰©ç”¨å“</p>
                    </div>
                </div>
                
                <div class="card" onclick="showLoginModal()">
                    <div style="padding: var(--spacing-md); text-align: center;">
                        <div style="font-size: 48px; margin-bottom: var(--spacing-sm);">âš™ï¸</div>
                        <h3>ç®¡ç†ä¸­å¿ƒ</h3>
                        <p style="color: var(--apple-gray-medium);">ç®¡ç†å‘˜æ§åˆ¶å°</p>
                    </div>
                </div>
            </div>

            <!-- æœ€æ–°åŠ¨æ€ -->
            <div class="admin-section" style="margin-top: var(--spacing-lg);">
                <h3>ğŸ“Š æœ€æ–°åŠ¨æ€</h3>
                <div id="recentActivities" class="activity-list"></div>
            </div>
        </div>
    </div>

    <!-- çŒ«å’ªé¡µé¢ -->
    <div id="cats" class="page">
        <div class="container">
            <h1 class="page-title">ğŸ± çŒ«å’ªç®¡ç†</h1>
            
            <!-- æœç´¢å’Œç­›é€‰ -->
            <div class="search-bar">
                <input type="text" class="form-control" id="searchInput" placeholder="æœç´¢çŒ«å’ªåå­—ã€å“ç§ã€æ€§æ ¼...">
                <select class="form-select form-control" id="genderFilter">
                    <option value="">æ‰€æœ‰æ€§åˆ«</option>
                    <option value="male">å…¬çŒ«</option>
                    <option value="female">æ¯çŒ«</option>
                </select>
                <select class="form-select form-control" id="sortBy">
                    <option value="name">æŒ‰åå­—æ’åº</option>
                    <option value="age">æŒ‰å¹´é¾„æ’åº</option>
                    <option value="breed">æŒ‰å“ç§æ’åº</option>
                </select>
                <button class="btn" onclick="filterCats()">æœç´¢</button>
                <button class="btn btn-secondary" onclick="resetFilters()">é‡ç½®</button>
                <button class="btn" onclick="showAddCatModal()" id="addCatBtn" style="display: none;">â• æ·»åŠ çŒ«å’ª</button>
            </div>

            <!-- çŒ«å’ªç½‘æ ¼ -->
            <div id="catsGrid" class="grid grid-3"></div>
        </div>
    </div>

    <!-- å® ç‰©åŒ»é™¢é¡µé¢ -->
    <div id="hospital" class="page">
        <div class="container">
            <h1 class="page-title">ğŸ¥ å® ç‰©åŒ»é™¢</h1>
            
            <!-- æœç´¢æ  -->
            <div class="search-bar">
                <input type="text" class="form-control" id="hospitalSearch" placeholder="æœç´¢åŒ»é™¢åç§°...">
                <select class="form-select form-control" id="hospitalFilter">
                    <option value="">é™„è¿‘5å…¬é‡Œ</option>
                    <option value="10">é™„è¿‘10å…¬é‡Œ</option>
                    <option value="20">é™„è¿‘20å…¬é‡Œ</option>
                    <option value="50">é™„è¿‘50å…¬é‡Œ</option>
                </select>
                <button class="btn" onclick="searchHospitals()">æœç´¢</button>
                <button class="btn btn-secondary" onclick="getCurrentLocation()">ğŸ“ è·å–ä½ç½®</button>
            </div>

            <!-- åœ°å›¾ -->
            <div id="mapContainer"></div>

            <!-- åŒ»é™¢åˆ—è¡¨ -->
            <div id="hospitalList" class="hospital-list"></div>
        </div>
    </div>

    <!-- ç‰©æµæŸ¥è¯¢é¡µé¢ -->
    <div id="logistics" class="page">
        <div class="container">
            <h1 class="page-title">ğŸ“¦ ç‰©æµæŸ¥è¯¢</h1>
            
            <!-- æ·»åŠ å¿«é€’ -->
            <div class="search-bar">
                <select class="form-select form-control" id="logisticsCompany">
                    <option value="">é€‰æ‹©å¿«é€’å…¬å¸</option>
                    <option value="é¡ºä¸°é€Ÿè¿">é¡ºä¸°é€Ÿè¿</option>
                    <option value="ä¸­é€šå¿«é€’">ä¸­é€šå¿«é€’</option>
                    <option value="åœ†é€šé€Ÿé€’">åœ†é€šé€Ÿé€’</option>
                    <option value="ç”³é€šå¿«é€’">ç”³é€šå¿«é€’</option>
                    <option value="éŸµè¾¾é€Ÿé€’">éŸµè¾¾é€Ÿé€’</option>
                    <option value="é‚®æ”¿EMS">é‚®æ”¿EMS</option>
                    <option value="å¾·é‚¦å¿«é€’">å¾·é‚¦å¿«é€’</option>
                    <option value="äº¬ä¸œç‰©æµ">äº¬ä¸œç‰©æµ</option>
                </select>
                <input type="text" class="form-control" id="trackingNumber" placeholder="è¾“å…¥å¿«é€’å•å·...">
                <button class="btn" onclick="queryLogistics()">æŸ¥è¯¢</button>
                <button class="btn btn-secondary" onclick="showAddTrackingModal()">â• æ·»åŠ å¿«é€’</button>
            </div>

            <!-- å¿«é€’åˆ—è¡¨ -->
            <div id="logisticsList"></div>
        </div>
    </div>

    <!-- è®ºå›é¡µé¢ -->
    <div id="forum" class="page">
        <div class="container">
            <h1 class="page-title">ğŸ’¬ å® ç‰©è®ºå›</h1>
            
            <button class="btn" onclick="showNewPostModal()" style="margin-bottom: var(--spacing-md);">â• å‘è¡¨æ–°å¸–</button>

            <!-- å¸–å­åˆ—è¡¨ -->
            <div id="forumPosts"></div>
        </div>
    </div>

    <!-- å•†åŸé¡µé¢ -->
    <div id="shop" class="page">
        <div class="container">
            <h1 class="page-title">ğŸ›ï¸ å® ç‰©å•†åŸ</h1>
            
            <!-- æœç´¢å’Œç­›é€‰ -->
            <div class="search-bar">
                <input type="text" class="form-control" id="productSearch" placeholder="æœç´¢å•†å“..." oninput="filterProducts()">
                <select class="form-select form-control" id="categoryFilter" onchange="filterProducts()">
                    <option value="">æ‰€æœ‰åˆ†ç±»</option>
                    <option value="food">é£Ÿå“</option>
                    <option value="toy">ç©å…·</option>
                    <option value="care">æŠ¤ç†ç”¨å“</option>
                    <option value="accessory">é…é¥°</option>
                </select>
            </div>

            <!-- å•†å“ç½‘æ ¼ -->
            <div id="productsGrid" class="grid grid-4"></div>
        </div>
    </div>

    <!-- è´­ç‰©è½¦é¡µé¢ -->
    <div id="cart" class="page">
        <div class="container">
            <h1 class="page-title">ğŸ›’ è´­ç‰©è½¦</h1>
            
            <div id="cartItems"></div>
            
            <div style="margin-top: var(--spacing-lg); padding: var(--spacing-md); background: white; border-radius: var(--border-radius-lg);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-sm);">
                    <span style="font-size: 18px; font-weight: 600;">æ€»è®¡</span>
                    <span id="totalPrice" style="font-size: 24px; font-weight: 600; color: var(--apple-red);">Â¥0.00</span>
                </div>
                <button class="btn" style="width: 100%;" onclick="checkout()">ç«‹å³ç»“ç®—</button>
            </div>
        </div>
    </div>

    <!-- ä¸ªäººä¸­å¿ƒé¡µé¢ -->
    <div id="profile" class="page">
        <div class="container">
            <h1 class="page-title">ğŸ‘¤ ä¸ªäººä¸­å¿ƒ</h1>
            
            <div class="admin-section">
                <h3>ğŸ‘¤ åŸºæœ¬ä¿¡æ¯</h3>
                <div class="form-group">
                    <label class="form-label">ç”¨æˆ·å</label>
                    <input type="text" class="form-control" id="profileUsername" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
                </div>
                <div class="form-group">
                    <label class="form-label">é‚®ç®±</label>
                    <input type="email" class="form-control" id="profileEmail" placeholder="è¯·è¾“å…¥é‚®ç®±">
                </div>
                <button class="btn" onclick="updateProfile()">æ›´æ–°ä¿¡æ¯</button>
            </div>

            <div class="admin-section">
                <h3>ğŸ›’ æˆ‘çš„è®¢å•</h3>
                <div id="userOrders"></div>
            </div>
        </div>
    </div>

    <!-- è®¢å•é¡µé¢ -->
    <div id="orders" class="page">
        <div class="container">
            <h1 class="page-title">ğŸ“‹ æˆ‘çš„è®¢å•</h1>
            
            <div id="ordersList"></div>
        </div>
    </div>

    <!-- ç®¡ç†å‘˜é¡µé¢ -->
    <div id="admin" class="page">
        <div class="container">
            <h1 class="page-title">âš™ï¸ ç®¡ç†åå°</h1>
            
            <!-- ç»Ÿè®¡æ•°æ® -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalCats">0</div>
                    <div class="stat-label">çŒ«å’ªæ€»æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalPosts">0</div>
                    <div class="stat-label">å¸–å­æ€»æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalComments">0</div>
                    <div class="stat-label">è¯„è®ºæ€»æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalOrders">0</div>
                    <div class="stat-label">è®¢å•æ€»æ•°</div>
                </div>
            </div>

            <!-- æœ€æ–°è¯„è®º -->
            <div class="admin-section">
                <h3>ğŸ’¬ æœ€æ–°è¯„è®º</h3>
                <div id="recentComments" class="activity-list"></div>
            </div>

            <!-- è®¢å•ç®¡ç† -->
            <div class="admin-section">
                <h3>ğŸ“¦ è®¢å•ç®¡ç†</h3>
                <div id="orderManagement" class="activity-list"></div>
            </div>
        </div>
    </div>

    <!-- æ·»åŠ çŒ«å’ªæ¨¡æ€æ¡† -->
    <div id="addCatModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>â• æ·»åŠ çŒ«å’ª</h2>
                <button class="close-btn" onclick="closeModal('addCatModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">åå­—</label>
                    <input type="text" class="form-control" id="catName" placeholder="è¯·è¾“å…¥çŒ«å’ªåå­—">
                </div>
                <div class="form-group">
                    <label class="form-label">å“ç§</label>
                    <select class="form-select form-control" id="catBreed">
                        <option value="è‹±çŸ­">è‹±çŸ­</option>
                        <option value="ç¾çŸ­">ç¾çŸ­</option>
                        <option value="å¸ƒå¶çŒ«">å¸ƒå¶çŒ«</option>
                        <option value="æš¹ç½—çŒ«">æš¹ç½—çŒ«</option>
                        <option value="æ³¢æ–¯çŒ«">æ³¢æ–¯çŒ«</option>
                        <option value="ç¼…å› çŒ«">ç¼…å› çŒ«</option>
                        <option value="ç”°å›­çŒ«">ç”°å›­çŒ«</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">å¹´é¾„</label>
                    <input type="number" class="form-control" id="catAge" placeholder="è¯·è¾“å…¥å¹´é¾„" min="0" max="30">
                </div>
                <div class="form-group">
                    <label class="form-label">æ€§åˆ«</label>
                    <select class="form-select form-control" id="catGender">
                        <option value="male">å…¬çŒ«</option>
                        <option value="female">æ¯çŒ«</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">æ€§æ ¼ç‰¹ç‚¹</label>
                    <input type="text" class="form-control" id="catPersonality" placeholder="å¦‚ï¼šæ´»æ³¼ã€æ¸©é¡ºã€ç‹¬ç«‹ç­‰">
                </div>
                <div class="form-group">
                    <label class="form-label">è¯¦ç»†æè¿°</label>
                    <textarea class="form-control" id="catDescription" rows="4" placeholder="æè¿°ä¸€ä¸‹ä½ çš„çŒ«å’ª..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">ä¸Šä¼ ç…§ç‰‡</label>
                    <div class="image-upload" onclick="document.getElementById('catImages').click()">
                        <div>ğŸ“· ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡</div>
                        <input type="file" id="catImages" multiple accept="image/*" style="display: none;" onchange="previewCatImages(event)">
                    </div>
                    <div id="catImagePreview" class="image-preview"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addCatModal')">å–æ¶ˆ</button>
                <button class="btn" onclick="addCat()">æ·»åŠ </button>
            </div>
        </div>
    </div>

    <!-- çŒ«å’ªè¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="catDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="catDetailTitle">çŒ«å’ªè¯¦æƒ…</h2>
                <button class="close-btn" onclick="closeModal('catDetailModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="catDetailContent">
                    <!-- çŒ«å’ªè¯¦æƒ…å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
                
                <!-- è¯„è®ºåŒº -->
                <div class="comments-section">
                    <h3>ğŸ’¬ è¯„è®ºåŒº</h3>
                    <div class="form-group">
                        <textarea class="form-control" id="newComment" rows="3" placeholder="å†™ä¸‹ä½ çš„è¯„è®º..."></textarea>
                    </div>
                    <button class="btn btn-secondary" onclick="addComment()">å‘è¡¨è¯„è®º</button>
                    <button class="btn" onclick="sendPrivateMessage()">ğŸ“© ç§ä¿¡ç®¡ç†å‘˜</button>
                    
                    <div id="commentsList" style="margin-top: var(--spacing-md);"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('catDetailModal')">å…³é—­</button>
                <button class="btn" id="editCatBtn" onclick="editCat()" style="display: none;">âœï¸ ç¼–è¾‘</button>
                <button class="btn btn-danger" id="deleteCatBtn" onclick="deleteCat()" style="display: none;">ğŸ—‘ï¸ åˆ é™¤</button>
            </div>
        </div>
    </div>

    <!-- å‘è¡¨å¸–å­æ¨¡æ€æ¡† -->
    <div id="newPostModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>â• å‘è¡¨æ–°å¸–</h2>
                <button class="close-btn" onclick="closeModal('newPostModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">æ ‡é¢˜</label>
                    <input type="text" class="form-control" id="postTitle" placeholder="è¯·è¾“å…¥å¸–å­æ ‡é¢˜">
                </div>
                <div class="form-group">
                    <label class="form-label">å†…å®¹</label>
                    <textarea class="form-control" id="postContent" rows="6" placeholder="åˆ†äº«ä½ çš„å…»å® ç»éªŒæˆ–é—®é¢˜..."></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">ä¸Šä¼ å›¾ç‰‡</label>
                    <div class="image-upload" onclick="document.getElementById('postImages').click()">
                        <div>ğŸ“· ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡</div>
                        <input type="file" id="postImages" multiple accept="image/*" style="display: none;" onchange="previewPostImages(event)">
                    </div>
                    <div id="postImagePreview" class="image-preview"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('newPostModal')">å–æ¶ˆ</button>
                <button class="btn" onclick="createPost()">å‘è¡¨</button>
            </div>
        </div>
    </div>

    <!-- å•†å“è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="productTitle">å•†å“è¯¦æƒ…</h2>
                <button class="close-btn" onclick="closeModal('productModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="productContent">
                    <!-- å•†å“è¯¦æƒ…å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('productModal')">å…³é—­</button>
                <button class="btn" onclick="addToCart()">åŠ å…¥è´­ç‰©è½¦</button>
            </div>
        </div>
    </div>

    <!-- æ·»åŠ å¿«é€’æ¨¡æ€æ¡† -->
    <div id="addTrackingModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>â• æ·»åŠ å¿«é€’</h2>
                <button class="close-btn" onclick="closeModal('addTrackingModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">å¿«é€’å…¬å¸</label>
                    <select class="form-select form-control" id="trackingCompany">
                        <option value="é¡ºä¸°é€Ÿè¿">é¡ºä¸°é€Ÿè¿</option>
                        <option value="ä¸­é€šå¿«é€’">ä¸­é€šå¿«é€’</option>
                        <option value="åœ†é€šé€Ÿé€’">åœ†é€šé€Ÿé€’</option>
                        <option value="ç”³é€šå¿«é€’">ç”³é€šå¿«é€’</option>
                        <option value="éŸµè¾¾é€Ÿé€’">éŸµè¾¾é€Ÿé€’</option>
                        <option value="é‚®æ”¿EMS">é‚®æ”¿EMS</option>
                        <option value="å¾·é‚¦å¿«é€’">å¾·é‚¦å¿«é€’</option>
                        <option value="äº¬ä¸œç‰©æµ">äº¬ä¸œç‰©æµ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">å¿«é€’å•å·</label>
                    <input type="text" class="form-control" id="trackingNumberInput" placeholder="è¯·è¾“å…¥å¿«é€’å•å·">
                </div>
                <div class="form-group">
                    <label class="form-label">å¤‡æ³¨</label>
                    <input type="text" class="form-control" id="trackingNote" placeholder="è¯·è¾“å…¥å¤‡æ³¨ä¿¡æ¯">
                </div>
                <div class="form-group">
                    <label class="form-label">å…³è”è®¢å•</label>
                    <select class="form-select form-control" id="relatedOrder">
                        <option value="">ä¸å…³è”è®¢å•</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addTrackingModal')">å–æ¶ˆ</button>
                <button class="btn" onclick="addTracking()">æ·»åŠ </button>
            </div>
        </div>
    </div>

    <!-- ç®¡ç†å‘˜ç™»å½•æ¨¡æ€æ¡† -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ” ç®¡ç†å‘˜ç™»å½•</h2>
                <button class="close-btn" onclick="closeModal('loginModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="login-avatar">ğŸ‘¤</div>
                <div class="form-group">
                    <label class="form-label">è´¦å·</label>
                    <input type="text" class="form-control" id="adminUsername" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜è´¦å·">
                </div>
                <div class="form-group">
                    <label class="form-label">å¯†ç </label>
                    <input type="password" class="form-control" id="adminPassword" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('loginModal')">å–æ¶ˆ</button>
                <button class="btn" onclick="adminLogin()">ç™»å½•</button>
            </div>
        </div>
    </div>

    <!-- Toast æç¤º -->
    <div id="toast" class="toast">
        <div id="toastMessage"></div>
    </div>

    <script>
        // å…¨å±€æ•°æ®å­˜å‚¨
        let appData = {
            cats: [],
            posts: [],
            comments: [],
            products: [],
            cart: [],
            orders: [],
            logistics: [],
            users: [],
            currentUser: null,
            isAdmin: false,
            currentCatId: null,
            map: null,
            currentLocation: null
        };

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            initializeEventListeners();
            loadInitialData();
            renderHomePage();
        });

        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
        function initializeEventListeners() {
            // å¯¼èˆªç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    if (page) {
                        showPage(page);
                    }
                });
            });
        }

        // åŠ è½½åˆå§‹æ•°æ®
        function loadInitialData() {
            // åˆå§‹åŒ–çŒ«å’ªæ•°æ®
            if (appData.cats.length === 0) {
                appData.cats = [
                    {
                        id: 1,
                        name: 'å°èŠ±',
                        breed: 'è‹±çŸ­',
                        age: 2,
                        gender: 'female',
                        personality: 'æ¸©é¡ºå¯çˆ±',
                        description: 'ä¸€åªéå¸¸æ¸©é¡ºçš„è‹±çŸ­çŒ«å’ªï¼Œå–œæ¬¢å’Œäººäº’åŠ¨ï¼Œæ¯›å‘æŸ”è½¯ç¾ä¸½ã€‚',
                        images: ['https://picsum.photos/seed/cat1/300/300.jpg'],
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        name: 'å¤§æ©˜',
                        breed: 'ç”°å›­çŒ«',
                        age: 3,
                        gender: 'male',
                        personality: 'æ´»æ³¼å¥½åŠ¨',
                        description: 'é˜³å…‰å¤§æ©˜ï¼Œæ€§æ ¼å¼€æœ—ï¼Œæœ€å–œæ¬¢åœ¨é˜³å…‰ä¸‹ç¡è§‰ã€‚',
                        images: ['https://picsum.photos/seed/cat2/300/300.jpg'],
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 3,
                        name: 'é›ªçƒ',
                        breed: 'å¸ƒå¶çŒ«',
                        age: 1,
                        gender: 'female',
                        personality: 'æ–‡é™ä¼˜é›…',
                        description: 'ç¾ä¸½çš„å¸ƒå¶çŒ«ï¼Œçœ¼ç›åƒè“å®çŸ³ä¸€æ ·ç¾ä¸½ï¼Œæ€§æ ¼æ–‡é™ã€‚',
                        images: ['https://picsum.photos/seed/cat3/300/300.jpg'],
                        createdAt: new Date().toISOString()
                    }
                ];
            }

            // åˆå§‹åŒ–å•†å“æ•°æ®
            if (appData.products.length === 0) {
                appData.products = [
                    {
                        id: 1,
                        name: 'é«˜ç«¯çŒ«ç²®',
                        category: 'food',
                        price: 89.90,
                        description: 'å¤©ç„¶è¥å…»é…æ–¹ï¼Œé€‚åˆæˆçŒ«é£Ÿç”¨',
                        image: 'https://picsum.photos/seed/product1/200/200.jpg',
                        stock: 100
                    },
                    {
                        id: 2,
                        name: 'é€—çŒ«æ£’å¥—è£…',
                        category: 'toy',
                        price: 25.90,
                        description: 'å¤šç§æ¬¾å¼çŒ«å’ªç©å…·å¥—è£…',
                        image: 'https://picsum.photos/seed/product2/200/200.jpg',
                        stock: 150
                    },
                    {
                        id: 3,
                        name: 'çŒ«ç ‚ç›†',
                        category: 'care',
                        price: 129.00,
                        description: 'åŠ åšé˜²æ¼è®¾è®¡ï¼Œæ¸…æ´æ–¹ä¾¿',
                        image: 'https://picsum.photos/seed/product3/200/200.jpg',
                        stock: 80
                    },
                    {
                        id: 4,
                        name: 'çŒ«å’ªé¡¹åœˆ',
                        category: 'accessory',
                        price: 35.00,
                        description: 'ç²¾ç¾çŒ«å’ªé¡¹åœˆï¼Œå¸¦å°é“ƒé“›',
                        image: 'https://picsum.photos/seed/product4/200/200.jpg',
                        stock: 80
                    },
                    {
                        id: 5,
                        name: 'çŒ«å’ªæŠ“æ¿',
                        category: 'toy',
                        price: 45.00,
                        description: 'ç“¦æ¥çº¸æè´¨ï¼Œè€ç£¨è€ç”¨',
                        image: 'https://picsum.photos/seed/product5/200/200.jpg',
                        stock: 60
                    },
                    {
                        id: 6,
                        name: 'å® ç‰©æ²æµ´éœ²',
                        category: 'care',
                        price: 55.00,
                        description: 'æ¸©å’Œæ— åˆºæ¿€ï¼Œé€‚åˆçŒ«å’ªä½¿ç”¨',
                        image: 'https://picsum.photos/seed/product6/200/200.jpg',
                        stock: 40
                    }
                ];
            }

            // åˆå§‹åŒ–è®ºå›æ•°æ®
            if (appData.posts.length === 0) {
                appData.posts = [
                    {
                        id: 1,
                        title: 'æ±‚åŠ©ï¼šçŒ«å’ªä¸çˆ±åƒé¥­æ€ä¹ˆåŠï¼Ÿ',
                        content: 'æœ€è¿‘æˆ‘å®¶å¤§æ©˜é£Ÿæ¬²ä¸æŒ¯ï¼Œä»€ä¹ˆå¥½åƒçš„éƒ½ä¸çˆ±åƒï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆå¥½åŠæ³•ï¼Ÿ',
                        author: 'ç„¦æ€¥çš„é“²å±å®˜',
                        likes: 8,
                        comments: 15,
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        title: 'åˆ†äº«ï¼šæˆ‘å®¶çŒ«å’ªçš„æç¬‘ç¬é—´',
                        content: 'ä»Šå¤©æˆ‘å®¶å°èŠ±è¿½ç€è‡ªå·±çš„å°¾å·´è½¬åœˆåœˆï¼Œæœ€åæŠŠè‡ªå·±è½¬æ™•äº†ï¼ŒçœŸçš„å¤ªå¯çˆ±äº†ï¼',
                        author: 'å¿«ä¹çš„çŒ«å¥´',
                        likes: 23,
                        comments: 6,
                        createdAt: new Date().toISOString()
                    }
                ];
            }

            // åˆå§‹åŒ–ç‰©æµæ•°æ®
            if (appData.logistics.length === 0) {
                appData.logistics = [
                    {
                        id: 1,
                        company: 'é¡ºä¸°é€Ÿè¿',
                        trackingNumber: 'SF1234567890',
                        note: 'è´­ä¹°çš„çŒ«ç²®',
                        status: 'è¿è¾“ä¸­',
                        timeline: [
                            { time: '2024-01-20 10:30', content: 'å¿«ä»¶å·²å‘å‡º' },
                            { time: '2024-01-21 15:30', content: 'å¿«ä»¶å·²åˆ°è¾¾æ­å·' }
                        ],
                        createdAt: new Date().toISOString()
                    }
                ];
            }

            saveData();
        }

        // ä¿å­˜æ•°æ®åˆ°localStorage
        function saveData() {
            localStorage.setItem('jincatData', JSON.stringify(appData));
        }

        // ä»localStorageåŠ è½½æ•°æ®
        function loadData() {
            const savedData = localStorage.getItem('jincatData');
            if (savedData) {
                appData = JSON.parse(savedData);
            }
        }

        // é¡µé¢åˆ‡æ¢
        function showPage(pageId) {
            // éšè—æ‰€æœ‰é¡µé¢
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });

            // æ˜¾ç¤ºç›®æ ‡é¡µé¢
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
            }

            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            const activeLink = document.querySelector(`[data-page="${pageId}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }

            // æ¸²æŸ“é¡µé¢å†…å®¹
            switch(pageId) {
                case 'home':
                    renderHomePage();
                    break;
                case 'cats':
                    renderCatsPage();
                    break;
                case 'hospital':
                    initMap();
                    break;
                case 'logistics':
                    renderLogisticsPage();
                    break;
                case 'forum':
                    renderForumPage();
                    break;
                case 'shop':
                    renderShopPage();
                    break;
                case 'admin':
                    if (appData.isAdmin) {
                        renderAdminPage();
                    } else {
                        showToast('è¯·å…ˆç™»å½•ç®¡ç†å‘˜è´¦å·', 'error');
                        showLoginModal();
                        showPage('home');
                    }
                    break;
                case 'cart':
                    renderCartPage();
                    break;
                case 'profile':
                    renderProfilePage();
                    break;
                case 'orders':
                    renderOrdersPage();
                    break;
            }

            // å…³é—­ç”¨æˆ·èœå•
            document.getElementById('userDropdown').classList.remove('active');
        }

        // æ¸²æŸ“ä¸»é¡µ
        function renderHomePage() {
            const activities = document.getElementById('recentActivities');
            
            // è·å–æœ€æ–°æ´»åŠ¨
            const recentItems = [
                ...appData.cats.slice(-3).map(cat => ({
                    type: 'cat',
                    title: `æ–°å¢çŒ«å’ªï¼š${cat.name}`,
                    time: cat.createdAt,
                    icon: 'ğŸ±'
                })),
                ...appData.comments.slice(-5).map(comment => ({
                    type: 'comment',
                    title: `æ–°è¯„è®ºï¼š${comment.content.substring(0, 20)}...`,
                    time: comment.createdAt,
                    icon: 'ğŸ’­'
                }))
            ].sort((a, b) => new Date(b.time) - new Date(a.time)).slice(0, 5);

            if (recentItems.length === 0) {
                activities.innerHTML = '<div class="empty-state">æš‚æ— åŠ¨æ€</div>';
                return;
            }

            activities.innerHTML = recentItems.map(item => `
                <div class="activity-item">
                    <div class="activity-icon">${item.icon}</div>
                    <div class="activity-info">
                        <div class="activity-text">${item.title}</div>
                        <div class="activity-time">${formatTime(item.time)}</div>
                    </div>
                </div>
            `).join('');
        }

        // æ¸²æŸ“çŒ«å’ªé¡µé¢
        function renderCatsPage() {
            const grid = document.getElementById('catsGrid');
            const addCatBtn = document.getElementById('addCatBtn');
            
            // åªæœ‰ç®¡ç†å‘˜æ˜¾ç¤ºæ·»åŠ æŒ‰é’®
            addCatBtn.style.display = appData.isAdmin ? 'inline-block' : 'none';
            
            if (appData.cats.length === 0) {
                grid.innerHTML = '<div class="empty-state">æš‚æ— çŒ«å’ªä¿¡æ¯</div>';
                return;
            }

            grid.innerHTML = appData.cats.map(cat => `
                <div class="cat-card" onclick="showCatDetail(${cat.id})">
                    <img src="${cat.images[0] || 'https://picsum.photos/seed/defaultcat/300/300.jpg'}" 
                         alt="${cat.name}" class="cat-image">
                    <div class="cat-info">
                        <div class="cat-name">${cat.name}</div>
                        <div class="cat-details">
                            ${cat.breed} â€¢ ${cat.age}å² â€¢ ${cat.gender === 'male' ? 'â™‚ï¸å…¬çŒ«' : 'â™€ï¸æ¯çŒ«'}<br>
                            æ€§æ ¼ï¼š${cat.personality}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // ç­›é€‰çŒ«å’ª
        function filterCats() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const genderFilter = document.getElementById('genderFilter').value;
            const sortBy = document.getElementById('sortBy').value;

            let filteredCats = appData.cats.filter(cat => {
                const matchesSearch = cat.name.toLowerCase().includes(searchTerm) ||
                                     cat.breed.toLowerCase().includes(searchTerm) ||
                                     cat.personality.toLowerCase().includes(searchTerm);
                const matchesGender = !genderFilter || cat.gender === genderFilter;
                return matchesSearch && matchesGender;
            });

            // æ’åº
            filteredCats.sort((a, b) => {
                switch(sortBy) {
                    case 'name':
                        return a.name.localeCompare(b.name);
                    case 'age':
                        return a.age - b.age;
                    case 'breed':
                        return a.breed.localeCompare(b.breed);
                    default:
                        return 0;
                }
            });

            // æ¸²æŸ“ç»“æœ
            const grid = document.getElementById('catsGrid');
            if (filteredCats.length === 0) {
                grid.innerHTML = '<div class="empty-state">æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„çŒ«å’ª</div>';
                return;
            }

            grid.innerHTML = filteredCats.map(cat => `
                <div class="cat-card" onclick="showCatDetail(${cat.id})">
                    <img src="${cat.images[0] || 'https://picsum.photos/seed/defaultcat/300/300.jpg'}" 
                         alt="${cat.name}" class="cat-image">
                    <div class="cat-info">
                        <div class="cat-name">${cat.name}</div>
                        <div class="cat-details">
                            ${cat.breed} â€¢ ${cat.age}å² â€¢ ${cat.gender === 'male' ? 'â™‚ï¸å…¬çŒ«' : 'â™€ï¸æ¯çŒ«'}<br>
                            æ€§æ ¼ï¼š${cat.personality}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // é‡ç½®ç­›é€‰
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('genderFilter').value = '';
            document.getElementById('sortBy').value = 'name';
            renderCatsPage();
        }

        // æ˜¾ç¤ºçŒ«å’ªè¯¦æƒ…
        function showCatDetail(catId) {
            const cat = appData.cats.find(c => c.id === catId);
            if (!cat) return;

            appData.currentCatId = catId;
            const modal = document.getElementById('catDetailModal');
            const title = document.getElementById('catDetailTitle');
            const content = document.getElementById('catDetailContent');
            const editBtn = document.getElementById('editCatBtn');
            const deleteBtn = document.getElementById('deleteCatBtn');

            title.textContent = cat.name;
            content.innerHTML = `
                <div style="display: flex; gap: var(--spacing-md);">
                    <img src="${cat.images[0] || 'https://picsum.photos/seed/defaultcat/300/300.jpg'}" 
                         alt="${cat.name}" style="width: 200px; height: 200px; object-fit: cover; border-radius: var(--border-radius-md);">
                    <div style="flex: 1;">
                        <p><strong>å“ç§ï¼š</strong>${cat.breed}</p>
                        <p><strong>å¹´é¾„ï¼š</strong>${cat.age}å²</p>
                        <p><strong>æ€§åˆ«ï¼š</strong>${cat.gender === 'male' ? 'å…¬çŒ«' : 'æ¯çŒ«'}</p>
                        <p><strong>æ€§æ ¼ï¼š</strong>${cat.personality}</p>
                    </div>
                </div>
                <div style="margin-top: var(--spacing-sm);">
                    <p><strong>è¯¦ç»†æè¿°ï¼š</strong></p>
                    <p>${cat.description}</p>
                </div>
            `;

            // åªæœ‰ç®¡ç†å‘˜æ˜¾ç¤ºç¼–è¾‘å’Œåˆ é™¤æŒ‰é’®
            editBtn.style.display = appData.isAdmin ? 'inline-block' : 'none';
            deleteBtn.style.display = appData.isAdmin ? 'inline-block' : 'none';

            // æ¸²æŸ“è¯„è®º
            renderComments();
            modal.classList.add('active');
        }

        // æ¸²æŸ“è¯„è®º
        function renderComments() {
            const commentsList = document.getElementById('commentsList');
            const catComments = appData.comments.filter(comment => comment.catId === appData.currentCatId);

            if (catComments.length === 0) {
                commentsList.innerHTML = '<div class="empty-state">æš‚æ— è¯„è®º</div>';
                return;
            }

            commentsList.innerHTML = catComments.map(comment => `
                <div class="comment-item">
                    <div class="comment-header">
                        <span class="comment-author">${comment.author}</span>
                        <span class="comment-time">${formatTime(comment.createdAt)}</span>
                        ${appData.isAdmin ? `<button class="btn btn-danger" style="margin-left: auto; padding: 4px 8px; font-size: 12px;" onclick="deleteComment(${comment.id})">åˆ é™¤</button>` : ''}
                    </div>
                    <div class="comment-content">${comment.content}</div>
                </div>
            `).join('');
        }

        // æ·»åŠ è¯„è®º
        function addComment() {
            const content = document.getElementById('newComment').value.trim();
            if (!content) {
                showToast('è¯·è¾“å…¥è¯„è®ºå†…å®¹', 'error');
                return;
            }

            const comment = {
                id: Date.now(),
                catId: appData.currentCatId,
                author: appData.currentUser?.username || 'åŒ¿åç”¨æˆ·',
                content: content,
                createdAt: new Date().toISOString()
            };

            appData.comments.push(comment);
            saveData();
            
            document.getElementById('newComment').value = '';
            renderComments();
            showToast('è¯„è®ºå‘è¡¨æˆåŠŸ', 'success');
        }

        // åˆ é™¤è¯„è®º
        function deleteComment(commentId) {
            if (!appData.isAdmin) {
                showToast('åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ é™¤è¯„è®º', 'error');
                return;
            }

            appData.comments = appData.comments.filter(c => c.id !== commentId);
            saveData();
            renderComments();
            showToast('è¯„è®ºå·²åˆ é™¤', 'success');
        }

        // å‘é€ç§ä¿¡
        function sendPrivateMessage() {
            const content = document.getElementById('newComment').value.trim();
            if (!content) {
                showToast('è¯·è¾“å…¥ç§ä¿¡å†…å®¹', 'error');
                return;
            }

            // è¿™é‡Œåº”è¯¥è°ƒç”¨åç«¯APIå‘é€ç§ä¿¡
            showToast('ç§ä¿¡å·²å‘é€ç»™ç®¡ç†å‘˜', 'success');
            document.getElementById('newComment').value = '';
        }

        // æ˜¾ç¤ºæ·»åŠ çŒ«å’ªæ¨¡æ€æ¡†
        function showAddCatModal() {
            if (!appData.isAdmin) {
                showToast('åªæœ‰ç®¡ç†å‘˜å¯ä»¥æ·»åŠ çŒ«å’ª', 'error');
                return;
            }
            document.getElementById('addCatModal').classList.add('active');
        }

        // æ·»åŠ çŒ«å’ª
        function addCat() {
            const name = document.getElementById('catName').value.trim();
            const breed = document.getElementById('catBreed').value;
            const age = parseInt(document.getElementById('catAge').value);
            const gender = document.getElementById('catGender').value;
            const personality = document.getElementById('catPersonality').value.trim();
            const description = document.getElementById('catDescription').value.trim();

            if (!name || !breed || !age || !personality || !description) {
                showToast('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯', 'error');
                return;
            }

            const cat = {
                id: Date.now(),
                name: name,
                breed: breed,
                age: age,
                gender: gender,
                personality: personality,
                description: description,
                images: [], // è¿™é‡Œåº”è¯¥å¤„ç†å›¾ç‰‡ä¸Šä¼ 
                createdAt: new Date().toISOString()
            };

            appData.cats.push(cat);
            saveData();
            
            closeModal('addCatModal');
            renderCatsPage();
            showToast('çŒ«å’ªæ·»åŠ æˆåŠŸ', 'success');

            // æ¸…ç©ºè¡¨å•
            document.getElementById('catName').value = '';
            document.getElementById('catAge').value = '';
            document.getElementById('catPersonality').value = '';
            document.getElementById('catDescription').value = '';
        }

        // ç¼–è¾‘çŒ«å’ª
        function editCat() {
            if (!appData.isAdmin) {
                showToast('åªæœ‰ç®¡ç†å‘˜å¯ä»¥ç¼–è¾‘çŒ«å’ª', 'error');
                return;
            }

            const cat = appData.cats.find(c => c.id === appData.currentCatId);
            if (!cat) return;

            // å¡«å……è¡¨å•
            document.getElementById('catName').value = cat.name;
            document.getElementById('catBreed').value = cat.breed;
            document.getElementById('catAge').value = cat.age;
            document.getElementById('catGender').value = cat.gender;
            document.getElementById('catPersonality').value = cat.personality;
            document.getElementById('catDescription').value = cat.description;

            closeModal('catDetailModal');
            document.getElementById('addCatModal').classList.add('active');

            // æ›´æ–°æŒ‰é’®æ–‡æœ¬
            document.querySelector('#addCatModal .btn').textContent = 'æ›´æ–°';
        }

        // åˆ é™¤çŒ«å’ª
        function deleteCat() {
            if (!appData.isAdmin) {
                showToast('åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ é™¤çŒ«å’ª', 'error');
                return;
            }

            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™åªçŒ«å’ªå—ï¼Ÿ')) {
                appData.cats = appData.cats.filter(c => c.id !== appData.currentCatId);
                saveData();
                closeModal('catDetailModal');
                renderCatsPage();
                showToast('çŒ«å’ªå·²åˆ é™¤', 'success');
            }
        }

        // åˆå§‹åŒ–åœ°å›¾
        function initMap() {
            if (!appData.map) {
                appData.map = new AMap.Map('mapContainer', {
                    zoom: 13,
                    center: [120.1551, 30.2741], // æ­å·åæ ‡
                    resizeEnable: true
                });

                // æ·»åŠ å®šä½æ§ä»¶
                appData.map.plugin('AMap.Geolocation', function() {
                    const geolocation = new AMap.Geolocation({
                        enableHighAccuracy: true,
                        timeout: 10000,
                        buttonPosition: 'RB',
                        buttonOffset: new AMap.Pixel(10, 20),
                        zoomToAccuracy: true
                    });
                    appData.map.addControl(geolocation);
                    geolocation.getCurrentPosition();
                });

                // æ·»åŠ å·¥å…·æ¡
                appData.map.plugin('AMap.ToolBar', function() {
                    const toolbar = new AMap.ToolBar();
                    appData.map.addControl(toolbar);
                });

                // è‡ªåŠ¨æœç´¢é™„è¿‘åŒ»é™¢
                searchNearbyHospitals();
            }
        }

        // æœç´¢é™„è¿‘åŒ»é™¢
        function searchNearbyHospitals() {
            if (!appData.map) return;

            // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
            const hospitals = [
                {
                    name: 'æ­å·å® ç‰©åŒ»é™¢',
                    address: 'æ­å·å¸‚æ±Ÿå¹²åŒºé’±æ±Ÿæ–°åŸ',
                    lat: 30.2941,
                    lng: 120.1751,
                    phone: '0571-11223344'
                },
                {
                    name: 'åå’Œå® ç‰©åŒ»é™¢',
                    address: 'æ­å·å¸‚è¥¿æ¹–åŒºæ–‡ä¸‰è·¯',
                    lat: 30.2841,
                    lng: 120.1551,
                    phone: '0571-55667788'
                },
                {
                    name: 'çˆ±å¿ƒå® ç‰©åŒ»é™¢',
                    address: 'æ­å·å¸‚æ‹±å¢…åŒºè«å¹²å±±è·¯',
                    lat: 30.3041,
                    lng: 120.1651,
                    phone: '0571-99887766'
                }
            ];

            // æ¸…é™¤åŸæœ‰æ ‡è®°
            appData.map.clearMap();

            // æ·»åŠ åŒ»é™¢æ ‡è®°
            hospitals.forEach(hospital => {
                const marker = new AMap.Marker({
                    position: [hospital.lng, hospital.lat],
                    title: hospital.name
                });

                appData.map.addMarker(marker);

                // æ·»åŠ ä¿¡æ¯çª—ä½“
                const infoWindow = new AMap.InfoWindow({
                    content: `
                        <div style="padding: 10px;">
                            <h4>${hospital.name}</h4>
                            <p>åœ°å€ï¼š${hospital.address}</p>
                            <p>ç”µè¯ï¼š${hospital.phone}</p>
                            <button onclick="startNavigation(${hospital.lat}, ${hospital.lng})" style="margin-top: 8px; padding: 4px 8px; background: #0071e3; color: white; border: none; border-radius: 4px; cursor: pointer;">å¯¼èˆª</button>
                        </div>
                    `,
                    offset: new AMap.Pixel(0, -30)
                });

                marker.on('click', function() {
                    infoWindow.open(appData.map, marker.getPosition());
                });
            });

            // æ¸²æŸ“åŒ»é™¢åˆ—è¡¨
            renderHospitalList(hospitals);
        }

        // æ¸²æŸ“åŒ»é™¢åˆ—è¡¨
        function renderHospitalList(hospitals) {
            const list = document.getElementById('hospitalList');
            list.innerHTML = hospitals.map(hospital => `
                <div class="hospital-item" onclick="focusHospital(${hospital.lat}, ${hospital.lng})">
                    <div class="hospital-name">${hospital.name}</div>
                    <div class="hospital-address">ğŸ“ ${hospital.address}</div>
                    <div class="hospital-phone">ğŸ“ ${hospital.phone}</div>
                    <button class="btn" style="margin-top: 8px;" onclick="event.stopPropagation(); startNavigation(${hospital.lat}, ${hospital.lng})">å¯¼èˆª</button>
                </div>
            `).join('');
        }

        // èšç„¦åˆ°åŒ»é™¢ä½ç½®
        function focusHospital(lat, lng) {
            if (appData.map) {
                appData.map.setCenter([lng, lat]);
                appData.map.setZoom(16);
            }
        }

        // å¼€å§‹å¯¼èˆª
        function startNavigation(targetLat, targetLng) {
            if (!appData.map) return;

            appData.map.plugin('AMap.Driving', function() {
                const driving = new AMap.Driving({
                    map: appData.map,
                    panel: 'mapContainer'
                });

                // æ ¹æ®å½“å‰ä½ç½®è§„åˆ’è·¯çº¿ï¼ˆè¿™é‡Œä½¿ç”¨æ¨¡æ‹Ÿä½ç½®ï¼‰
                driving.search(
                    [120.1551, 30.2741], // èµ·ç‚¹
                    [targetLng, targetLat], // ç»ˆç‚¹
                    function(status, result) {
                        if (status === 'complete') {
                            showToast('è·¯çº¿è§„åˆ’æˆåŠŸ', 'success');
                        } else {
                            showToast('è·¯çº¿è§„åˆ’å¤±è´¥', 'error');
                        }
                    }
                );
            });
        }

        // æœç´¢åŒ»é™¢
        function searchHospitals() {
            const searchTerm = document.getElementById('hospitalSearch').value.trim();
            const distance = document.getElementById('hospitalFilter').value || 5;
            
            if (!searchTerm) {
                searchNearbyHospitals();
                return;
            }

            // è¿™é‡Œåº”è¯¥è°ƒç”¨å®é™…çš„åœ°å›¾æœç´¢API
            showToast(`æœç´¢ï¼š${searchTerm}ï¼ˆ${distance}å…¬é‡Œå†…ï¼‰`, 'success');
            searchNearbyHospitals(); // æš‚æ—¶ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
        }

        // è·å–å½“å‰ä½ç½®
        function getCurrentLocation() {
            if (!appData.map) {
                initMap();
                return;
            }

            appData.map.plugin('AMap.Geolocation', function() {
                const geolocation = new AMap.Geolocation({
                    enableHighAccuracy: true,
                    timeout: 10000,
                    showButton: false
                });

                geolocation.getCurrentPosition(function(status, result) {
                    if (status === 'complete') {
                        appData.currentLocation = [result.position.lng, result.position.lat];
                        appData.map.setCenter(appData.currentLocation);
                        
                        // æ·»åŠ å½“å‰ä½ç½®æ ‡è®°
                        new AMap.Marker({
                            position: appData.currentLocation,
                            title: 'å½“å‰ä½ç½®',
                            icon: 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png'
                        }).setMap(appData.map);
                        
                        showToast('å®šä½æˆåŠŸ', 'success');
                        
                        // é‡æ–°æœç´¢é™„è¿‘åŒ»é™¢
                        searchNearbyHospitals();
                    } else {
                        showToast('å®šä½å¤±è´¥ï¼Œè¯·æ£€æŸ¥å®šä½æƒé™', 'error');
                    }
                });
            });
        }

        // æ¸²æŸ“ç‰©æµé¡µé¢
        function renderLogisticsPage() {
            renderLogisticsList();
            updateOrderSelect();
        }

        // æ¸²æŸ“ç‰©æµåˆ—è¡¨
        function renderLogisticsList() {
            const list = document.getElementById('logisticsList');
            
            if (appData.logistics.length === 0) {
                list.innerHTML = '<div class="empty-state">æš‚æ— ç‰©æµä¿¡æ¯</div>';
                return;
            }

            list.innerHTML = appData.logistics.map((item, index) => `
                <div class="logistics-item ${index === 0 ? 'completed' : ''}">
                    <div class="logistics-header">
                        <div>
                            <div class="logistics-company">${item.company}</div>
                            <div class="logistics-number">å•å·ï¼š${item.trackingNumber}</div>
                        </div>
                        <div class="logistics-status">${item.status}</div>
                    </div>
                    <div class="timeline">
                        ${item.timeline.map((track, i) => `
                            <div class="timeline-item ${i <= item.timeline.length - 2 ? 'completed' : ''}">
                                <div class="timeline-time">${track.time}</div>
                                <div class="timeline-content">${track.content}</div>
                            </div>
                        `).join('')}
                    </div>
                    ${item.note ? `<div style="margin-top: var(--spacing-sm); color: var(--apple-gray-medium);">å¤‡æ³¨ï¼š${item.note}</div>` : ''}
                </div>
            `).join('');
        }

        // æŸ¥è¯¢ç‰©æµ
        function queryLogistics() {
            const company = document.getElementById('logisticsCompany').value;
            const number = document.getElementById('trackingNumber').value.trim();

            if (!company || !number) {
                showToast('è¯·é€‰æ‹©å¿«é€’å…¬å¸å¹¶è¾“å…¥å¿«é€’å•å·', 'error');
                return;
            }

            // æ¨¡æ‹Ÿç‰©æµæŸ¥è¯¢
            const logistics = {
                id: Date.now(),
                company: company,
                trackingNumber: number,
                status: 'è¿è¾“ä¸­',
                timeline: [
                    { time: new Date().toLocaleString(), content: 'å¿«ä»¶å·²å‘å‡º' },
                    { time: new Date(Date.now() + 86400000).toLocaleString(), content: 'å¿«ä»¶è¿è¾“ä¸­...' }
                ],
                createdAt: new Date().toISOString()
            };

            appData.logistics.unshift(logistics);
            saveData();
            renderLogisticsList();
            showToast('ç‰©æµä¿¡æ¯å·²æ·»åŠ ', 'success');

            // æ¸…ç©ºè¡¨å•
            document.getElementById('logisticsCompany').value = '';
            document.getElementById('trackingNumber').value = '';
        }

        // æ˜¾ç¤ºæ·»åŠ å¿«é€’æ¨¡æ€æ¡†
        function showAddTrackingModal() {
            document.getElementById('addTrackingModal').classList.add('active');
        }

        // æ·»åŠ å¿«é€’
        function addTracking() {
            const company = document.getElementById('trackingCompany').value;
            const number = document.getElementById('trackingNumberInput').value.trim();
            const note = document.getElementById('trackingNote').value.trim();
            const relatedOrder = document.getElementById('relatedOrder').value;

            if (!company || !number) {
                showToast('è¯·å¡«å†™å¿«é€’å…¬å¸å’Œå•å·', 'error');
                return;
            }

            const logistics = {
                id: Date.now(),
                company: company,
                trackingNumber: number,
                note: note || '',
                orderId: relatedOrder || null,
                status: 'å¾…å‘è´§',
                timeline: [
                    { time: new Date().toLocaleString(), content: 'å¿«é€’ä¿¡æ¯å·²åˆ›å»º' }
                ],
                createdAt: new Date().toISOString()
            };

            appData.logistics.unshift(logistics);
            saveData();
            
            closeModal('addTrackingModal');
            renderLogisticsList();
            showToast('å¿«é€’ä¿¡æ¯å·²æ·»åŠ ', 'success');

            // æ¸…ç©ºè¡¨å•
            document.getElementById('trackingNumberInput').value = '';
            document.getElementById('trackingNote').value = '';
            document.getElementById('relatedOrder').value = '';
        }

        // æ›´æ–°è®¢å•é€‰æ‹©æ¡†
        function updateOrderSelect() {
            const select = document.getElementById('relatedOrder');
            if (!select) return;

            const orders = appData.orders.filter(order => !order.logisticsId);
            select.innerHTML = '<option value="">ä¸å…³è”è®¢å•</option>' + 
                orders.map(order => `<option value="${order.id}">è®¢å• #${order.id} - ${order.total.toFixed(2)}å…ƒ</option>`).join('');
        }

        // æ¸²æŸ“è®ºå›é¡µé¢
        function renderForumPage() {
            const postsContainer = document.getElementById('forumPosts');
            
            if (appData.posts.length === 0) {
                postsContainer.innerHTML = '<div class="empty-state">æš‚æ— å¸–å­ï¼Œå¿«æ¥å‘è¡¨ç¬¬ä¸€ä¸ªå¸–å­å§ï¼</div>';
                return;
            }

            postsContainer.innerHTML = appData.posts.map(post => `
                <div class="forum-post">
                    <div class="forum-post-header">
                        <div class="forum-post-avatar">${post.author.charAt(0)}</div>
                        <div class="forum-post-info">
                            <div class="forum-post-author">${post.author}</div>
                            <div class="forum-post-time">${formatTime(post.createdAt)}</div>
                        </div>
                        ${appData.isAdmin ? `
                            <button class="btn btn-danger" onclick="deletePost(${post.id})">åˆ é™¤</button>
                        ` : ''}
                    </div>
                    <div class="forum-post-title">${post.title}</div>
                    <div class="forum-post-content">${post.content}</div>
                    ${post.images && post.images.length > 0 ? `
                        <div class="image-preview" style="margin-top: var(--spacing-sm);">
                            ${post.images.map(img => `<img src="${img}" class="preview-image">`).join('')}
                        </div>
                    ` : ''}
                    <div class="forum-post-stats">
                        <span>â¤ï¸ ${post.likes} èµ</span>
                        <span>ğŸ’¬ ${post.comments} è¯„è®º</span>
                    </div>
                </div>
            `).join('');
        }

        // æ˜¾ç¤ºå‘è¡¨å¸–å­æ¨¡æ€æ¡†
        function showNewPostModal() {
            document.getElementById('newPostModal').classList.add('active');
        }

        // åˆ›å»ºå¸–å­
        function createPost() {
            const title = document.getElementById('postTitle').value.trim();
            const content = document.getElementById('postContent').value.trim();

            if (!title || !content) {
                showToast('è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹', 'error');
                return;
            }

            const post = {
                id: Date.now(),
                title: title,
                content: content,
                author: appData.currentUser?.username || 'åŒ¿åç”¨æˆ·',
                likes: 0,
                comments: 0,
                images: [], // è¿™é‡Œåº”è¯¥å¤„ç†å›¾ç‰‡ä¸Šä¼ 
                createdAt: new Date().toISOString()
            };

            appData.posts.push(post);
            saveData();
            
            closeModal('newPostModal');
            renderForumPage();
            showToast('å¸–å­å‘è¡¨æˆåŠŸ', 'success');

            // æ¸…ç©ºè¡¨å•
            document.getElementById('postTitle').value = '';
            document.getElementById('postContent').value = '';
        }

        // åˆ é™¤å¸–å­
        function deletePost(postId) {
            if (!appData.isAdmin) {
                showToast('åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ é™¤å¸–å­', 'error');
                return;
            }

            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¸–å­å—ï¼Ÿ')) {
                appData.posts = appData.posts.filter(p => p.id !== postId);
                saveData();
                renderForumPage();
                showToast('å¸–å­å·²åˆ é™¤', 'success');
            }
        }

        // æ¸²æŸ“å•†åŸé¡µé¢
        function renderShopPage() {
            renderProducts();
        }

        // æ¸²æŸ“å•†å“
        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            const searchTerm = document.getElementById('productSearch').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;

            let filteredProducts = appData.products.filter(product => {
                const matchesSearch = product.name.toLowerCase().includes(searchTerm) || 
                                     product.description.toLowerCase().includes(searchTerm);
                const matchesCategory = !categoryFilter || product.category === categoryFilter;
                return matchesSearch && matchesCategory;
            });

            if (filteredProducts.length === 0) {
                grid.innerHTML = '<div class="empty-state">æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å•†å“</div>';
                return;
            }

            grid.innerHTML = filteredProducts.map(product => `
                <div class="product-card" onclick="showProductDetail(${product.id})">
                    <img src="${product.image}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-price">Â¥${product.price.toFixed(2)}</div>
                        <div class="product-description">${product.description}</div>
                        <button class="btn" onclick="event.stopPropagation(); addToCartFromGrid(${product.id})">åŠ å…¥è´­ç‰©è½¦</button>
                    </div>
                </div>
            `).join('');
        }

        // ç­›é€‰å•†å“
        function filterProducts() {
            renderProducts();
        }

        // æ˜¾ç¤ºå•†å“è¯¦æƒ…
        function showProductDetail(productId) {
            const product = appData.products.find(p => p.id === productId);
            if (!product) return;

            const modal = document.getElementById('productModal');
            const title = document.getElementById('productTitle');
            const content = document.getElementById('productContent');

            title.textContent = product.name;
            content.innerHTML = `
                <img src="${product.image}" alt="${product.name}" style="width: 100%; max-height: 300px; object-fit: cover; border-radius: var(--border-radius-md);">
                <div style="margin-top: var(--spacing-md);">
                    <p style="font-size: 18px; font-weight: 600; color: var(--apple-red);">Â¥${product.price.toFixed(2)}</p>
                    <p style="margin-top: var(--spacing-sm);">${product.description}</p>
                    <p style="margin-top: var(--spacing-sm); color: var(--apple-gray-medium);">åº“å­˜ï¼š${product.stock}ä»¶</p>
                </div>
            `;

            modal.classList.add('active');
            appData.currentProductId = productId;
        }

        // ä»å•†å“åˆ—è¡¨åŠ å…¥è´­ç‰©è½¦
        function addToCartFromGrid(productId) {
            const product = appData.products.find(p => p.id === productId);
            if (!product) return;

            const existingItem = appData.cart.find(item => item.productId === productId);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                appData.cart.push({
                    productId: productId,
                    quantity: 1
                });
            }

            saveData();
            updateCartCount();
            showToast(`${product.name} å·²åŠ å…¥è´­ç‰©è½¦`, 'success');
        }

        // åŠ å…¥è´­ç‰©è½¦
        function addToCart() {
            addToCartFromGrid(appData.currentProductId);
            closeModal('productModal');
        }

        // æ›´æ–°è´­ç‰©è½¦æ•°é‡
        function updateCartCount() {
            const count = appData.cart.reduce((sum, item) => sum + item.quantity, 0);
            const countElement = document.getElementById('cartCount');
            countElement.textContent = count;
            countElement.style.display = count > 0 ? 'flex' : 'none';
        }

        // æ˜¾ç¤ºè´­ç‰©è½¦
        function showCart() {
            showPage('cart');
        }

        // æ¸²æŸ“è´­ç‰©è½¦é¡µé¢
        function renderCartPage() {
            const itemsContainer = document.getElementById('cartItems');
            
            if (appData.cart.length === 0) {
                itemsContainer.innerHTML = '<div class="empty-state">è´­ç‰©è½¦æ˜¯ç©ºçš„</div>';
                updateTotalPrice();
                return;
            }

            itemsContainer.innerHTML = appData.cart.map(item => {
                const product = appData.products.find(p => p.id === item.productId);
                if (!product) return '';

                return `
                    <div class="cart-item">
                        <img src="${product.image}" alt="${product.name}" class="cart-item-image">
                        <div class="cart-item-info">
                            <div class="cart-item-name">${product.name}</div>
                            <div class="cart-item-price">Â¥${product.price.toFixed(2)}</div>
                        </div>
                        <div class="cart-item-quantity">
                            <button class="quantity-btn" onclick="updateQuantity(${item.productId}, -1)">-</button>
                            <span style="margin: 0 8px;">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${item.productId}, 1)">+</button>
                        </div>
                        <div style="margin-left: var(--spacing-sm); font-weight: 600; color: var(--apple-red);">
                            Â¥${(product.price * item.quantity).toFixed(2)}
                        </div>
                        <button class="btn btn-danger" style="margin-left: var(--spacing-sm); padding: 4px 8px;" onclick="removeFromCart(${item.productId})">åˆ é™¤</button>
                    </div>
                `;
            }).join('');

            updateTotalPrice();
        }

        // æ›´æ–°æ•°é‡
        function updateQuantity(productId, change) {
            const item = appData.cart.find(item => item.productId === productId);
            if (!item) return;

            item.quantity += change;
            if (item.quantity <= 0) {
                removeFromCart(productId);
            } else {
                saveData();
                renderCartPage();
                updateCartCount();
            }
        }

        // ä»è´­ç‰©è½¦ç§»é™¤
        function removeFromCart(productId) {
            appData.cart = appData.cart.filter(item => item.productId !== productId);
            saveData();
            renderCartPage();
            updateCartCount();
            showToast('å•†å“å·²ä»è´­ç‰©è½¦ç§»é™¤', 'success');
        }

        // æ›´æ–°æ€»ä»·
        function updateTotalPrice() {
            const total = appData.cart.reduce((sum, item) => {
                const product = appData.products.find(p => p.id === item.productId);
                return sum + (product ? product.price * item.quantity : 0);
            }, 0);
            document.getElementById('totalPrice').textContent = `Â¥${total.toFixed(2)}`;
        }

        // ç»“ç®—
        function checkout() {
            if (appData.cart.length === 0) {
                showToast('è´­ç‰©è½¦æ˜¯ç©ºçš„', 'error');
                return;
            }

            const order = {
                id: Date.now(),
                items: [...appData.cart],
                total: calculateTotal(),
                status: 'å¾…æ”¯ä»˜',
                createdAt: new Date().toISOString()
            };

            appData.orders.push(order);
            appData.cart = [];
            saveData();
            
            renderCartPage();
            updateCartCount();
            showToast('è®¢å•å·²åˆ›å»ºï¼Œè¯·å®Œæˆæ”¯ä»˜', 'success');
        }

        // è®¡ç®—æ€»ä»·
        function calculateTotal() {
            return appData.cart.reduce((sum, item) => {
                const product = appData.products.find(p => p.id === item.productId);
                return sum + (product ? product.price * item.quantity : 0);
            }, 0);
        }

        // æ˜¾ç¤ºä¸ªäººä¸­å¿ƒ
        function showProfile() {
            showPage('profile');
        }

        // æ¸²æŸ“ä¸ªäººä¸­å¿ƒ
        function renderProfilePage() {
            const usernameInput = document.getElementById('profileUsername');
            const emailInput = document.getElementById('profileEmail');
            
            if (appData.currentUser) {
                usernameInput.value = appData.currentUser.username || '';
                emailInput.value = appData.currentUser.email || '';
            }

            // æ¸²æŸ“ç”¨æˆ·è®¢å•
            renderUserOrders();
        }

        // æ›´æ–°ä¸ªäººä¿¡æ¯
        function updateProfile() {
            const username = document.getElementById('profileUsername').value.trim();
            const email = document.getElementById('profileEmail').value.trim();

            if (!username) {
                showToast('è¯·è¾“å…¥ç”¨æˆ·å', 'error');
                return;
            }

            appData.currentUser = {
                username: username,
                email: email
            };

            saveData();
            showToast('ä¸ªäººä¿¡æ¯å·²æ›´æ–°', 'success');
        }

        // æ¸²æŸ“ç”¨æˆ·è®¢å•
        function renderUserOrders() {
            const container = document.getElementById('userOrders');
            const orders = appData.orders;

            if (orders.length === 0) {
                container.innerHTML = '<div class="empty-state">æš‚æ— è®¢å•</div>';
                return;
            }

            container.innerHTML = orders.map(order => `
                <div class="logistics-item">
                    <div class="logistics-header">
                        <div>
                            <div class="logistics-company">è®¢å• #${order.id}</div>
                            <div class="logistics-number">åˆ›å»ºæ—¶é—´ï¼š${formatTime(order.createdAt)}</div>
                        </div>
                        <div class="logistics-status">${order.status}</div>
                    </div>
                    <div style="margin-top: var(--spacing-sm);">
                        <div>å•†å“æ•°é‡ï¼š${order.items.length} ä»¶</div>
                        <div style="font-weight: 600; color: var(--apple-red);">æ€»ä»·ï¼šÂ¥${order.total.toFixed(2)}</div>
                    </div>
                </div>
            `).join('');
        }

        // æ˜¾ç¤ºè®¢å•é¡µé¢
        function showOrders() {
            showPage('orders');
        }

        // æ¸²æŸ“è®¢å•é¡µé¢
        function renderOrdersPage() {
            const container = document.getElementById('ordersList');
            const orders = appData.orders;

            if (orders.length === 0) {
                container.innerHTML = '<div class="empty-state">æš‚æ— è®¢å•</div>';
                return;
            }

            container.innerHTML = orders.map(order => `
                <div class="logistics-item">
                    <div class="logistics-header">
                        <div>
                            <div class="logistics-company">è®¢å• #${order.id}</div>
                            <div class="logistics-number">ä¸‹å•æ—¶é—´ï¼š${formatTime(order.createdAt)}</div>
                        </div>
                        <div class="logistics-status">${order.status}</div>
                    </div>
                    <div style="margin-top: var(--spacing-sm);">
                        ${order.items.map(item => {
                            const product = appData.products.find(p => p.id === item.productId);
                            return product ? `
                                <div style="display: flex; align-items: center; gap: var(--spacing-sm); margin-bottom: var(--spacing-xs);">
                                    <img src="${product.image}" alt="${product.name}" style="width: 40px; height: 40px; object-fit: cover; border-radius: var(--border-radius-sm);">
                                    <div>
                                        <div>${product.name}</div>
                                        <div style="color: var(--apple-gray-medium);">æ•°é‡ï¼š${item.quantity} Ã— Â¥${product.price.toFixed(2)}</div>
                                    </div>
                                </div>
                            ` : '';
                        }).join('')}
                        <div style="margin-top: var(--spacing-sm); padding-top: var(--spacing-sm); border-top: 1px solid var(--apple-border); font-weight: 600; color: var(--apple-red);">
                            æ€»è®¡ï¼šÂ¥${order.total.toFixed(2)}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // æ˜¾ç¤ºç®¡ç†å‘˜ç™»å½•æ¨¡æ€æ¡†
        function showLoginModal() {
            document.getElementById('loginModal').classList.add('active');
        }

        // ç®¡ç†å‘˜ç™»å½•
        function adminLogin() {
            const username = document.getElementById('adminUsername').value.trim();
            const password = document.getElementById('adminPassword').value.trim();

            if (username === 'abc123' && password === 'abc123') {
                appData.isAdmin = true;
                saveData();
                
                closeModal('loginModal');
                showToast('ç™»å½•æˆåŠŸ', 'success');
                
                // æ›´æ–°ç•Œé¢
                document.getElementById('logoutBtn').style.display = 'block';
                document.getElementById('addCatBtn').style.display = 'inline-block';
                showPage('admin');
            } else {
                showToast('è´¦å·æˆ–å¯†ç é”™è¯¯', 'error');
            }
        }

        // ç®¡ç†å‘˜ç™»å‡º
        function adminLogout() {
            appData.isAdmin = false;
            saveData();
            
            document.getElementById('logoutBtn').style.display = 'none';
            document.getElementById('addCatBtn').style.display = 'none';
            showPage('home');
            showToast('å·²é€€å‡ºç™»å½•', 'success');
        }

        // æ¸²æŸ“ç®¡ç†å‘˜é¡µé¢
        function renderAdminPage() {
            // æ›´æ–°ç»Ÿè®¡æ•°æ®
            document.getElementById('totalCats').textContent = appData.cats.length;
            document.getElementById('totalPosts').textContent = appData.posts.length;
            document.getElementById('totalComments').textContent = appData.comments.length;
            document.getElementById('totalOrders').textContent = appData.orders.length;

            // æ¸²æŸ“æœ€æ–°è¯„è®º
            const recentComments = document.getElementById('recentComments');
            const latestComments = appData.comments.slice(-5).reverse();

            if (latestComments.length === 0) {
                recentComments.innerHTML = '<div class="empty-state">æš‚æ— è¯„è®º</div>';
            } else {
                recentComments.innerHTML = latestComments.map(comment => `
                    <div class="activity-item">
                        <div class="activity-icon">ğŸ’¬</div>
                        <div class="activity-info">
                            <div class="activity-text">${comment.author}: ${comment.content.substring(0, 30)}...</div>
                            <div class="activity-time">${formatTime(comment.createdAt)}</div>
                        </div>
                    </div>
                `).join('');
            }

            // æ¸²æŸ“è®¢å•ç®¡ç†
            renderOrderManagement();
        }

        // æ¸²æŸ“è®¢å•ç®¡ç†
        function renderOrderManagement() {
            const container = document.getElementById('orderManagement');
            const orders = appData.orders.slice(-5).reverse();

            if (orders.length === 0) {
                container.innerHTML = '<div class="empty-state">æš‚æ— è®¢å•</div>';
            } else {
                container.innerHTML = orders.map(order => `
                    <div class="activity-item">
                        <div class="activity-icon">ğŸ“¦</div>
                        <div class="activity-info">
                            <div class="activity-text">è®¢å• #${order.id} - ${order.total.toFixed(2)}å…ƒ</div>
                            <div class="activity-time">${formatTime(order.createdAt)} - ${order.status}</div>
                        </div>
                    </div>
                `).join('');
            }
        }

        // åˆ‡æ¢ç”¨æˆ·èœå•
        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('active');
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // æ˜¾ç¤ºToastæç¤º
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toast.className = `toast ${type}`;
            toastMessage.textContent = message;
            toast.classList.add('active');
            
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        // æ ¼å¼åŒ–æ—¶é—´
        function formatTime(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) {
                return 'åˆšåˆš';
            } else if (diff < 3600000) {
                return Math.floor(diff / 60000) + 'åˆ†é’Ÿå‰';
            } else if (diff < 86400000) {
                return Math.floor(diff / 3600000) + 'å°æ—¶å‰';
            } else if (diff < 604800000) {
                return Math.floor(diff / 86400000) + 'å¤©å‰';
            } else {
                return date.toLocaleDateString('zh-CN');
            }
        }

        // é¢„è§ˆçŒ«å’ªå›¾ç‰‡
        function previewCatImages(event) {
            const files = event.target.files;
            const preview = document.getElementById('catImagePreview');
            
            preview.innerHTML = '';
            
            for (let file of files) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'preview-image';
                    preview.appendChild(img);
                };
                reader.readAsDataURL(file);
            }
        }

        // é¢„è§ˆå¸–å­å›¾ç‰‡
        function previewPostImages(event) {
            const files = event.target.files;
            const preview = document.getElementById('postImagePreview');
            
            preview.innerHTML = '';
            
            for (let file of files) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'preview-image';
                    preview.appendChild(img);
                };
                reader.readAsDataURL(file);
            }
        }

        // ç‚¹å‡»é¡µé¢å…¶ä»–åœ°æ–¹å…³é—­ä¸‹æ‹‰èœå•
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.user-menu')) {
                document.getElementById('userDropdown').classList.remove('active');
            }
        });

        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­æ¨¡æ€æ¡†
        document.addEventListener('click', function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        });
    </script>
</body>
</html>