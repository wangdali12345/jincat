<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>杭州自家小猫咪-李先生</title>
    
    <!-- 高德地图API -->
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=您的高德地图KEY&plugin=AMap.Geolocation,AMap.PlaceSearch,AMap.Geocoder"></script>
    
    <!-- 腾讯地图API（备用） -->
    <script charset="utf-8" src="https://map.qq.com/api/gljs?v=1.exp&key=您的腾讯地图KEY"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #FFF8E1 0%, #FFE0B2 100%);
            color: #1d1d1f;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* 导航栏 */
        nav {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-link {
            text-decoration: none;
            color: #1d1d1f;
            font-weight: 500;
            transition: color 0.3s ease;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
        }

        .nav-link:hover {
            color: #0071e3;
            background: rgba(0, 113, 227, 0.1);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
        }

        .mobile-menu-btn:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .logo {
            font-size: 18px;
            font-weight: 600;
            color: #1d1d1f;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* 英雄区域 */
        .hero {
            text-align: center;
            padding: 100px 0;
            background: linear-gradient(135deg, #fbfbfd 0%, #f5f5f7 100%);
        }

        .hero h1 {
            font-size: 56px;
            font-weight: 700;
            margin-bottom: 24px;
            background: linear-gradient(135deg, #1d1d1f 0%, #86868b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .hero p {
            font-size: 21px;
            color: #86868b;
            max-width: 600px;
            margin: 0 auto 40px;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            border-radius: 980px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 17px;
        }

        .btn-primary {
            background: #0071e3;
            color: white;
        }

        .btn-primary:hover {
            background: #0077ed;
            transform: scale(1.05);
        }

        /* 统计区域 */
        .stats {
            padding: 80px 0;
            background: white;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 40px;
            text-align: center;
        }

        .stat-item h3 {
            font-size: 48px;
            font-weight: 700;
            color: #1d1d1f;
            margin-bottom: 8px;
        }

        .stat-item p {
            font-size: 17px;
            color: #86868b;
        }

        /* 搜索区域 */
        .search-section {
            padding: 80px 0;
        }

        .search-card {
            background: white;
            border-radius: 18px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: 0 auto;
        }

        .search-input {
            width: 100%;
            padding: 16px 20px;
            border: 1px solid #d2d2d7;
            border-radius: 12px;
            font-size: 17px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #0071e3;
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }

        .filter-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .filter-select {
            padding: 12px 16px;
            border: 1px solid #d2d2d7;
            border-radius: 12px;
            font-size: 17px;
            background: white;
        }

        /* 猫咪网格 */
        .cats-section {
            padding: 80px 0;
            background: white;
        }

        .section-title {
            text-align: center;
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 16px;
            color: #1d1d1f;
        }

        .section-subtitle {
            text-align: center;
            font-size: 21px;
            color: #86868b;
            margin-bottom: 60px;
        }

        .cats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 32px;
        }

        .cat-card {
            background: white;
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
        }

        .cat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .cat-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            object-position: center;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            border-radius: 18px 18px 0 0;
        }

        .cat-info {
            padding: 24px;
        }

        .cat-name {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1d1d1f;
        }

        .cat-details {
            display: flex;
            flex-direction: column;
            gap: 4px;
            margin-bottom: 16px;
        }

        .cat-detail {
            font-size: 15px;
            color: #86868b;
        }

        .cat-personality {
            font-size: 15px;
            color: #86868b;
            line-height: 1.5;
        }

        /* 模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 18px;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            width: 90%;
        }

        .modal-header {
            position: relative;
            height: 400px;
            overflow: hidden;
        }

        .modal-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-body {
            padding: 40px;
        }

        .modal-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #1d1d1f;
        }

        .modal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .modal-item {
            text-align: center;
            padding: 20px;
            background: #f5f5f7;
            border-radius: 12px;
        }

        .modal-item-label {
            font-size: 14px;
            color: #86868b;
            margin-bottom: 4px;
        }

        .modal-item-value {
            font-size: 18px;
            font-weight: 600;
            color: #1d1d1f;
        }

        .modal-description {
            font-size: 17px;
            line-height: 1.6;
            color: #1d1d1f;
            margin-top: 30px;
        }

        .modal-actions {
            display: flex;
            gap: 16px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .like-btn {
            background: #ff3b30;
            color: white;
        }

        .like-btn.liked {
            background: #86868b;
        }

        .order-btn {
            background: #34c759;
            color: white;
        }

        .message-btn {
            background: #0071e3;
            color: white;
        }

        /* 订单模态框 */
        .order-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .order-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 18px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .order-header {
            padding: 30px 30px 20px;
            border-bottom: 1px solid #f0f0f0;
        }

        .order-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1d1d1f;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d2d2d7;
            border-radius: 12px;
            font-size: 17px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #0071e3;
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }

        .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d2d2d7;
            border-radius: 12px;
            font-size: 17px;
            min-height: 100px;
            resize: vertical;
            transition: all 0.3s ease;
        }

        .form-textarea:focus {
            outline: none;
            border-color: #0071e3;
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }

        .order-summary {
            background: #f5f5f7;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .summary-total {
            display: flex;
            justify-content: space-between;
            font-size: 18px;
            font-weight: 600;
            border-top: 1px solid #d2d2d7;
            padding-top: 10px;
            margin-top: 10px;
        }

        /* 私信模态框 */
        .message-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            backdrop-filter: blur(10px);
        }

        .message-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 18px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        /* 物流追踪 */
        .logistics-section {
            background: white;
            border-radius: 18px;
            padding: 30px;
            margin: 20px 0;
            display: none;
        }

        .logistics-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #1d1d1f;
        }

        .logistics-timeline {
            position: relative;
            padding-left: 30px;
        }

        .logistics-item {
            position: relative;
            padding-bottom: 20px;
            padding-left: 20px;
        }

        .logistics-item:before {
            content: '';
            position: absolute;
            left: -8px;
            top: 6px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #0071e3;
        }

        .logistics-item:after {
            content: '';
            position: absolute;
            left: -2px;
            top: 18px;
            width: 2px;
            height: calc(100% - 18px);
            background: #d2d2d7;
        }

        .logistics-item:last-child:after {
            display: none;
        }

        .logistics-time {
            font-size: 14px;
            color: #86868b;
            margin-bottom: 4px;
        }

        .logistics-text {
            font-size: 16px;
            color: #1d1d1f;
        }

        .logistics-item.completed:before {
            background: #34c759;
        }

        .logistics-item.current:before {
            background: #0071e3;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(0, 113, 227, 0.7);
            }
            50% {
                box-shadow: 0 0 0 8px rgba(0, 113, 227, 0);
            }
        }

        /* 用户中心 */
        .user-section {
            position: relative;
        }

        .user-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .user-btn:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            min-width: 200px;
            display: none;
            z-index: 1000;
        }

        .user-dropdown.show {
            display: block;
        }

        .dropdown-item {
            padding: 12px 16px;
            cursor: pointer;
            transition: background 0.3s ease;
            border-bottom: 1px solid #f0f0f0;
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item:hover {
            background: #f5f5f7;
        }

        .notification-badge {
            position: absolute;
            top: -2px;
            right: -2px;
            background: #ff3b30;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        /* 商城样式 */
        .shop-section {
            padding: 80px 0;
            background: white;
            display: none;
        }

        .shop-categories {
            display: flex;
            gap: 16px;
            margin-bottom: 40px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .category-btn {
            padding: 12px 24px;
            border: 1px solid #d2d2d7;
            border-radius: 25px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
        }

        .category-btn.active,
        .category-btn:hover {
            background: #0071e3;
            color: white;
            border-color: #0071e3;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }

        .product-card {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
        }

        .product-info {
            padding: 20px;
        }

        .product-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1d1d1f;
        }

        .product-price {
            font-size: 20px;
            font-weight: 700;
            color: #0071e3;
            margin-bottom: 12px;
        }

        .product-desc {
            font-size: 14px;
            color: #86868b;
            line-height: 1.4;
        }

        .add-to-cart {
            width: 100%;
            padding: 12px;
            background: #34c759;
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
            margin-top: 12px;
        }

        .add-to-cart:hover {
            background: #30d158;
        }

        /* 宠物医院样式 */
        .hospital-section {
            padding: 80px 0;
            background: #f5f5f7;
            display: none;
        }

        .hospital-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
        }

        .hospital-card {
            background: white;
            border-radius: 18px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .hospital-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .hospital-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .hospital-name {
            font-size: 20px;
            font-weight: 600;
            color: #1d1d1f;
        }

        .hospital-rating {
            display: flex;
            align-items: center;
            gap: 4px;
            color: #ff9500;
            font-weight: 600;
        }

        .hospital-address {
            color: #86868b;
            margin-bottom: 12px;
            font-size: 14px;
        }

        .hospital-phone {
            color: #0071e3;
            margin-bottom: 16px;
            font-size: 14px;
        }

        .hospital-services {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .service-tag {
            background: #f0f0f0;
            color: #1d1d1f;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
        }

        .hospital-actions {
            display: flex;
            gap: 12px;
        }

        .hospital-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .book-btn {
            background: #0071e3;
            color: white;
        }

        .book-btn:hover {
            background: #0077ed;
        }

        .review-btn {
            background: #f5f5f7;
            color: #1d1d1f;
        }

        .review-btn:hover {
            background: #e8e8ed;
        }

        /* 论坛样式 - 贴吧风格 */
        .forum-section {
            padding: 0;
            background: #f5f5f7;
            display: none;
            min-height: 100vh;
        }

        .forum-header {
            background: white;
            padding: 20px 0;
            border-bottom: 2px solid #e5e5e7;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .forum-title {
            font-size: 28px;
            font-weight: 700;
            color: #1d1d1f;
            text-align: center;
        }

        .forum-toolbar {
            background: white;
            padding: 15px 0;
            border-bottom: 1px solid #e5e5e7;
        }

        .toolbar-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .forum-tabs {
            display: flex;
            gap: 5px;
        }

        .forum-tab {
            padding: 10px 20px;
            background: none;
            border: none;
            font-size: 14px;
            font-weight: 500;
            color: #86868b;
            cursor: pointer;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .forum-tab.active {
            background: #0071e3;
            color: white;
        }

        .forum-tab:hover {
            background: #e8e8ed;
        }

        .post-new-btn {
            background: #0071e3;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .post-new-btn:hover {
            background: #0077ed;
        }

        .forum-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px 20px 40px;
        }

        .forum-post {
            background: white;
            border: 1px solid #e5e5e7;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .forum-post:hover {
            border-color: #0071e3;
            box-shadow: 0 4px 15px rgba(0, 113, 227, 0.1);
        }

        .post-main {
            display: flex;
            gap: 15px;
        }

        .author-section {
            text-align: center;
            min-width: 80px;
        }

        .author-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0071e3, #5856d6);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
            margin-bottom: 8px;
        }

        .author-name {
            font-size: 14px;
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 4px;
        }

        .author-level {
            font-size: 12px;
            color: #86868b;
            padding: 2px 8px;
            background: #f5f5f7;
            border-radius: 10px;
            display: inline-block;
        }

        .post-content-main {
            flex: 1;
        }

        .post-title {
            font-size: 18px;
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 12px;
            cursor: pointer;
            line-height: 1.4;
        }

        .post-title:hover {
            color: #0071e3;
        }

        .post-content {
            color: #1d1d1f;
            line-height: 1.6;
            margin-bottom: 15px;
            font-size: 14px;
        }

        .post-meta {
            display: flex;
            gap: 20px;
            align-items: center;
            font-size: 13px;
            color: #86868b;
            margin-bottom: 15px;
        }

        .post-type {
            background: #e3f2fd;
            color: #1976d2;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .post-actions {
            display: flex;
            gap: 25px;
            align-items: center;
            padding-top: 15px;
            border-top: 1px solid #f0f0f0;
        }

        .post-action {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #86868b;
            cursor: pointer;
            transition: color 0.3s ease;
            font-size: 13px;
        }

        .post-action:hover {
            color: #0071e3;
        }

        .post-action.liked {
            color: #ff3b30;
        }

        .post-comment-preview {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin-top: 10px;
        }

        .comment-item {
            font-size: 13px;
            color: #1d1d1f;
            margin-bottom: 5px;
        }

        .comment-author {
            color: #0071e3;
            font-weight: 600;
        }

        .hot-tag {
            background: #ff3b30;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            margin-left: 8px;
            font-weight: 600;
        }

        .new-tag {
            background: #34c759;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
            margin-left: 8px;
            font-weight: 600;
        }

        .new-post-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: #0071e3;
            color: white;
            border: none;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 113, 227, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .new-post-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(0, 113, 227, 0.4);
        }

        .forum-stats {
            background: white;
            border: 1px solid #e5e5e7;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            text-align: center;
        }

        .stat-item {
            flex: 1;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #1d1d1f;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 13px;
            color: #86868b;
        }

        /* 个人帖子管理样式 */
        .my-posts-tabs {
            display: flex;
            border-bottom: 1px solid #e5e5e7;
            margin-bottom: 20px;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #86868b;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            color: #0071e3;
            border-bottom-color: #0071e3;
        }

        .my-posts-content {
            padding: 20px 0;
        }

        .my-post-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .my-post-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .my-post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .my-post-title {
            font-size: 16px;
            font-weight: 600;
            color: #1d1d1f;
            cursor: pointer;
            flex: 1;
        }

        .my-post-actions {
            display: flex;
            gap: 10px;
        }

        .my-post-btn {
            background: #0071e3;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .my-post-btn.delete {
            background: #ff3b30;
        }

        .my-post-btn:hover {
            opacity: 0.8;
        }

        .my-post-meta {
            font-size: 13px;
            color: #86868b;
            margin-bottom: 10px;
        }

        .my-post-stats {
            display: flex;
            gap: 20px;
            font-size: 13px;
            color: #86868b;
        }

        /* 帖子详情样式 */
        .post-detail-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e5e5e7;
        }

        .post-detail-author {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .post-detail-content {
            line-height: 1.8;
            margin-bottom: 30px;
        }

        .post-detail-images {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .post-detail-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .post-detail-image:hover {
            transform: scale(1.05);
        }

        .post-detail-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .post-detail-comments {
            margin-top: 30px;
        }

        .comment-form {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .comment-input {
            width: 100%;
            height: 100px;
            padding: 12px;
            border: 1px solid #e5e5e7;
            border-radius: 8px;
            resize: vertical;
            margin-bottom: 10px;
        }

        .comment-item {
            background: white;
            border: 1px solid #e5e5e7;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .comment-author {
            font-weight: 600;
            color: #0071e3;
            margin-bottom: 5px;
        }

        .comment-time {
            font-size: 12px;
            color: #86868b;
            margin-bottom: 8px;
        }

        .comment-content {
            line-height: 1.6;
        }

        /* 猫咪评论样式 */
        .cat-info {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
        }

        .cat-info-img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 10px;
        }

        .comments-list {
            margin-bottom: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .empty-comments {
            text-align: center;
            color: #86868b;
            padding: 40px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0071e3, #5856d6);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
            margin-right: 10px;
        }

        /* 地图样式 */
        .map-section {
            padding: 20px;
            margin: 20px 0;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .map-container {
            width: 100%;
            height: 300px;
            border-radius: 12px;
            overflow: hidden;
            background: #e9ecef;
            position: relative;
        }

        .map-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .map-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #86868b;
        }

        .real-time-tracking {
            background: linear-gradient(135deg, #0071e3, #5856d6);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .tracking-header {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .tracking-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .tracking-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .tracking-label {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .tracking-value {
            font-size: 16px;
            font-weight: 600;
        }

        .location-badge {
            background: #34c759;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
            margin-left: 10px;
        }

        .delivery-estimation {
            background: #ff9500;
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin: 15px 0;
            text-align: center;
            font-weight: 600;
        }

        .route-map {
            background: white;
            border: 1px solid #e5e5e7;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }

        .route-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #1d1d1f;
        }

        .route-steps {
            position: relative;
            padding-left: 30px;
        }

        .route-step {
            position: relative;
            padding-bottom: 20px;
            padding-left: 20px;
        }

        .route-step:before {
            content: '';
            position: absolute;
            left: -8px;
            top: 6px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #0071e3;
            border: 2px solid white;
            box-shadow: 0 2px 8px rgba(0, 113, 227, 0.3);
        }

        .route-step:after {
            content: '';
            position: absolute;
            left: -2px;
            top: 18px;
            width: 2px;
            height: calc(100% - 18px);
            background: #d2d2d7;
        }

        .route-step:last-child:after {
            display: none;
        }

        .route-location {
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 4px;
        }

        .route-time {
            font-size: 13px;
            color: #86868b;
        }

        /* 发帖模态框 - 小红书风格 */
        .post-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 3000;
            backdrop-filter: blur(10px);
        }

        .post-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .post-header {
            padding: 25px 25px 20px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .post-title-text {
            font-size: 20px;
            font-weight: 700;
            color: #1d1d1f;
        }

        .post-body {
            padding: 25px;
        }

        .post-type-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .post-type-btn {
            padding: 12px 20px;
            border: 2px solid #f0f0f0;
            background: white;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .post-type-btn.active {
            background: #0071e3;
            border-color: #0071e3;
            color: white;
        }

        .post-form-group {
            margin-bottom: 25px;
        }

        .post-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
        }

        .post-input:focus {
            outline: none;
            border-color: #0071e3;
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }

        .post-textarea {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            font-size: 16px;
            min-height: 200px;
            resize: vertical;
            transition: all 0.3s ease;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif;
            line-height: 1.6;
        }

        .post-textarea:focus {
            outline: none;
            border-color: #0071e3;
            box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.1);
        }

        .post-image-upload {
            border: 2px dashed #d2d2d7;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .post-image-upload:hover {
            border-color: #0071e3;
            background: #f8faff;
        }

        .post-image-upload-icon {
            font-size: 40px;
            margin-bottom: 10px;
            color: #86868b;
        }

        .post-image-upload-text {
            color: #86868b;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .post-image-upload-hint {
            color: #d2d2d7;
            font-size: 12px;
        }

        .post-actions-footer {
            display: flex;
            gap: 15px;
            padding: 20px 25px;
            border-top: 1px solid #f0f0f0;
            background: #fafafa;
        }

        .post-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .post-cancel {
            background: #f0f0f0;
            color: #86868b;
        }

        .post-cancel:hover {
            background: #e8e8ed;
        }

        .post-submit {
            background: linear-gradient(135deg, #0071e3, #5856d6);
            color: white;
        }

        .post-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 113, 227, 0.3);
        }

        .post-submit:disabled {
            background: #d2d2d7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* 手机端优化 */
        @media (max-width: 768px) {
            .post-content {
                width: 95%;
                max-height: 95vh;
                border-radius: 20px 20px 0 0;
                top: auto;
                bottom: 0;
                left: 0;
                right: 0;
                transform: none;
            }

            .post-header {
                border-radius: 20px 20px 0 0;
                padding: 20px 20px 15px;
            }

            .post-title-text {
                font-size: 18px;
            }

            .post-body {
                padding: 20px;
            }

            .post-type-selector {
                gap: 10px;
            }

            .post-type-btn {
                padding: 10px 16px;
                font-size: 13px;
            }

            .post-input,
            .post-textarea {
                font-size: 16px; /* 防止iOS缩放 */
            }

            .post-textarea {
                min-height: 150px;
            }

            .post-actions-footer {
                padding: 15px 20px;
            }

            .forum-toolbar {
                padding: 10px 0;
            }

            .toolbar-content {
                flex-direction: column;
                gap: 15px;
            }

            .forum-tabs {
                overflow-x: auto;
                justify-content: flex-start;
                padding-bottom: 5px;
            }

            .forum-tab {
                flex-shrink: 0;
            }

            .post-new-btn {
                align-self: stretch;
            }

            .forum-content {
                padding: 15px 15px 30px;
            }
        }

        /* 地图样式 */
        .map-section {
            padding: 20px;
            background: white;
            border-radius: 12px;
            margin-bottom: 20px;
            display: none;
        }

        .map-container {
            width: 100%;
            height: 300px;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .map-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .map-btn {
            padding: 8px 16px;
            border: 1px solid #d2d2d7;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .map-btn:hover {
            background: #f5f5f7;
            border-color: #0071e3;
        }

        .location-info {
            padding: 10px;
            background: #f5f5f7;
            border-radius: 8px;
            font-size: 14px;
            color: #1d1d1f;
            margin-top: 10px;
        }

        /* 实时物流追踪 */
        .real-time-logistics {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .logistics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .refresh-btn {
            padding: 8px 16px;
            background: #0071e3;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s ease;
        }

        .refresh-btn:hover {
            background: #0077ed;
        }

        .logistics-map {
            width: 100%;
            height: 250px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .nav-menu {
                flex-direction: column;
                gap: 10px;
                position: absolute;
                top: 60px;
                right: 20px;
                background: white;
                padding: 15px;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
                display: none;
            }
            
            .nav-menu.show {
                display: flex;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .shop-categories {
                padding: 0 20px;
            }
            
            .products-grid,
            .hospital-grid {
                grid-template-columns: 1fr;
            }
            
            .forum-tabs {
                overflow-x: auto;
                white-space: nowrap;
            }
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 36px;
            }
            
            .hero p {
                font-size: 17px;
            }
            
            .section-title {
                font-size: 32px;
            }
            
            .filter-row {
                grid-template-columns: 1fr;
            }
            
            .modal-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 20px;
            }
        }

        /* 加载动画 */
        .fade-in {
            opacity: 0;
            animation: fadeIn 0.6s ease forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #86868b;
        }

        .no-results-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav>
        <div class="container">
        <div class="nav-content">
            <a href="#" class="logo">
                <span>🐱</span>
                <span>杭州自家小猫咪-李先生</span>
            </a>
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">☰</button>
            <div class="nav-menu" id="navMenu">
                <a href="#cats" class="nav-link">🏠 精选猫咪</a>
                <a href="#" class="nav-link" onclick="showShop()">🛒 宠物商城</a>
                <a href="#" class="nav-link" onclick="showHospitals()">🏥 宠物医院</a>
                <a href="#" class="nav-link" onclick="showForum()">💬 本地论坛</a>
                <a href="#" class="nav-link" onclick="showMyPosts()">📝 我的帖子</a>
            </div>
            <div class="user-section">
                <button class="user-btn" onclick="toggleUserDropdown()">
                    <span>👤</span>
                    <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                </button>
                <div class="user-dropdown" id="userDropdown">
                    <div class="dropdown-item" onclick="showOrders()">📦 我的订单</div>
                    <div class="dropdown-item" onclick="showShopOrders()">🛒 商城订单</div>
                    <div class="dropdown-item" onclick="showHospitalAppointments()">🏥 医院预约</div>
                    <div class="dropdown-item" onclick="showMessages()">💬 私信消息</div>
                    <div class="dropdown-item" onclick="showLogistics()">🚚 物流追踪</div>
                    <div class="dropdown-item" onclick="showFavorites()">❤️ 我的收藏</div>
                </div>
            </div>
        </div>
        </div>
    </nav>

    <!-- 英雄区域 -->
    <section class="hero">
        <div class="container">
            <h1>杭州自家小猫咪</h1>
            <p>精心培育的金渐层猫咪，每一只都是独一无二的珍贵宝贝。李先生的猫咪庄园，为您呈现最优雅的金渐层家族。</p>
            <a href="#cats" class="btn btn-primary">浏览猫咪</a>
        </div>
    </section>

    <!-- 统计区域 -->
    <section class="stats">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-item">
                    <h3 id="totalCats">6</h3>
                    <p>只珍贵猫咪</p>
                </div>
                <div class="stat-item">
                    <h3>100%</h3>
                    <p>纯种金渐层</p>
                </div>
                <div class="stat-item">
                    <h3>24/7</h3>
                    <p>精心照料</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 搜索区域 -->
    <section class="search-section">
        <div class="container">
            <div class="search-card">
                <h2 style="text-align: center; margin-bottom: 30px; font-size: 24px;">寻找您心仪的猫咪</h2>
                <input type="text" class="search-input" id="searchInput" placeholder="搜索猫咪名字、品种或性格...">
                <div class="filter-row">
                    <select class="filter-select" id="genderFilter">
                        <option value="all">所有性别</option>
                        <option value="公猫">公猫</option>
                        <option value="母猫">母猫</option>
                    </select>
                    <select class="filter-select" id="sortBy">
                        <option value="newest">最新添加</option>
                        <option value="oldest">最早添加</option>
                        <option value="name">按名字排序</option>
                        <option value="age">按年龄排序</option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <!-- 猫咪展示区域 -->
    <section id="catsSection" class="cats-section">
        <div class="container">
            <h2 class="section-title">精选猫咪</h2>
            <p class="section-subtitle" id="catsCount">共 6 只猫咪</p>
            <div class="cats-grid" id="catsGrid">
                <!-- 猫咪卡片将在这里动态生成 -->
            </div>
        </div>
    </section>

    <!-- 宠物商城区域 -->
    <section id="shopSection" class="shop-section">
        <div class="container">
            <h2 class="section-title">🛒 宠物用品商城</h2>
            <p class="section-subtitle">精选优质宠物用品，让您的爱猫生活更美好</p>
            
            <div class="shop-categories">
                <button class="category-btn active" onclick="filterProducts('all')">全部商品</button>
                <button class="category-btn" onclick="filterProducts('food')">猫粮零食</button>
                <button class="category-btn" onclick="filterProducts('toy')">玩具用品</button>
                <button class="category-btn" onclick="filterProducts('health')">医疗保健</button>
                <button class="category-btn" onclick="filterProducts('living')">生活用品</button>
            </div>
            
            <div class="products-grid" id="productsGrid">
                <!-- 商品将在这里动态生成 -->
            </div>
        </div>
    </section>

    <!-- 宠物医院区域 -->
    <section id="hospitalSection" class="hospital-section">
        <div class="container">
            <h2 class="section-title">🏥 附近宠物医院</h2>
            <p class="section-subtitle">专业宠物医疗服务，为爱宠健康保驾护航</p>
            
            <div class="hospital-grid" id="hospitalGrid">
                <!-- 医院信息将在这里动态生成 -->
            </div>
        </div>
    </section>

    <!-- 本地论坛区域 -->
    <section id="forumSection" class="forum-section">
        <div class="forum-header">
            <div class="container">
                <h1 class="forum-title">🐱 杭州宠物论坛</h1>
            </div>
        </div>
        
        <div class="forum-toolbar">
            <div class="container">
                <div class="toolbar-content">
                    <div class="forum-tabs">
                        <button class="forum-tab active" onclick="switchForumTab('all')">全部</button>
                        <button class="forum-tab" onclick="switchForumTab('dating')">宠物相亲</button>
                        <button class="forum-tab" onclick="switchForumTab('experience')">养宠经验</button>
                        <button class="forum-tab" onclick="switchForumTab('help')">求助问答</button>
                        <button class="forum-tab" onclick="switchForumTab('hot')">热门</button>
                    </div>
                    <button class="post-new-btn" onclick="showNewPostModal()">发帖</button>
                </div>
            </div>
        </div>
        
        <div class="forum-content" id="forumContent">
            <!-- 论坛统计和帖子将在这里动态生成 -->
        </div>
    </section>

    <!-- 发布帖子按钮 -->
    <button class="new-post-btn" onclick="showNewPostModal()">✏️</button>

    <!-- 发帖模态框 - 小红书风格 -->
    <div class="post-modal" id="postModal">
        <div class="post-content">
            <div class="post-header">
                <h2 class="post-title-text">✨ 发布新帖子</h2>
                <button class="modal-close" onclick="closePostModal()" style="font-size: 24px; background: none; border: none; cursor: pointer;">×</button>
            </div>
            <div class="post-body">
                <div class="post-type-selector">
                    <button class="post-type-btn active" data-type="experience" onclick="selectPostType(this)">养宠经验</button>
                    <button class="post-type-btn" data-type="dating" onclick="selectPostType(this)">宠物相亲</button>
                    <button class="post-type-btn" data-type="help" onclick="selectPostType(this)">求助问答</button>
                    <button class="post-type-btn" data-type="share" onclick="selectPostType(this)">日常分享</button>
                </div>

                <div class="post-form-group">
                    <input type="text" class="post-input" id="postTitle" placeholder="✍️ 输入一个吸引人的标题..." maxlength="50">
                    <div style="text-align: right; font-size: 12px; color: #86868b; margin-top: 5px;">
                        <span id="titleCount">0</span>/50
                    </div>
                </div>

                <div class="post-form-group">
                    <textarea class="post-textarea" id="postContent" placeholder="💝 分享你的精彩内容...&#10;&#10;📝 小贴士：&#10;• 养宠经验：分享护理心得、饲养技巧&#10;• 宠物相亲：详细介绍年龄、品种、性格、要求&#10;• 求助问答：描述问题、已有措施、需要帮助&#10;• 日常分享：记录有趣瞬间、可爱照片" maxlength="1000"></textarea>
                    <div style="text-align: right; font-size: 12px; color: #86868b; margin-top: 5px;">
                        <span id="contentCount">0</span>/1000
                    </div>
                </div>

                <div class="post-form-group">
                    <div class="post-image-upload" onclick="selectPostImages()">
                        <div class="post-image-upload-icon">📷</div>
                        <div class="post-image-upload-text">点击上传图片</div>
                        <div class="post-image-upload-hint">支持JPG、PNG格式，最多9张</div>
                    </div>
                    <div id="imagePreview" style="display: none; margin-top: 15px;"></div>
                </div>
            </div>
            <div class="post-actions-footer">
                <button class="post-btn post-cancel" onclick="closePostModal()">取消</button>
                <button class="post-btn post-submit" id="submitPostBtn" onclick="submitNewPost()">立即发布</button>
            </div>
        </div>
    </div>

    <!-- 猫咪详情模态框 -->
    <div class="modal" id="catModal">
        <div class="modal-content">
            <div class="modal-header">
                <img class="modal-image" id="modalImage" src="" alt="">
                <button class="modal-close" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body">
                <h2 class="modal-title" id="modalTitle"></h2>
                <div class="modal-grid">
                    <div class="modal-item">
                        <div class="modal-item-label">年龄</div>
                        <div class="modal-item-value" id="modalAge"></div>
                    </div>
                    <div class="modal-item">
                        <div class="modal-item-label">性别</div>
                        <div class="modal-item-value" id="modalGender"></div>
                    </div>
                    <div class="modal-item">
                        <div class="modal-item-label">体重</div>
                        <div class="modal-item-value" id="modalWeight"></div>
                    </div>
                    <div class="modal-item">
                        <div class="modal-item-label">品种</div>
                        <div class="modal-item-value" id="modalBreed"></div>
                    </div>
                </div>
                <div class="modal-description" id="modalDescription"></div>
                <div class="modal-actions">
                    <button class="btn like-btn" id="likeBtn" onclick="toggleLike()">❤️ 喜欢</button>
                    <button class="btn order-btn" onclick="openOrderModal()">🛒 立即购买</button>
                    <button class="btn comment-btn" onclick="openCatCommentModal()">💬 评论留言</button>
                    <button class="btn message-btn" onclick="sendCatPrivateMessage()">📨 私信管理员</button>
                    <button class="btn btn-primary" onclick="shareCat()">🔗 分享</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 订单模态框 -->
    <div class="order-modal" id="orderModal">
        <div class="order-content">
            <div class="order-header">
                <h2>确认订单</h2>
                <button class="modal-close" onclick="closeOrderModal()">×</button>
            </div>
            <div class="order-body">
                <div class="form-group">
                    <label class="form-label">收货人姓名</label>
                    <input type="text" class="form-input" id="customerName" placeholder="请输入您的姓名">
                </div>
                <div class="form-group">
                    <label class="form-label">联系电话</label>
                    <input type="tel" class="form-input" id="customerPhone" placeholder="请输入您的手机号">
                </div>
                <div class="form-group">
                    <label class="form-label">收货地址</label>
                    <textarea class="form-textarea" id="customerAddress" placeholder="请输入详细收货地址"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">备注信息</label>
                    <textarea class="form-textarea" id="orderNote" placeholder="有什么特殊要求可以在这里说明"></textarea>
                </div>
                <div class="order-summary">
                    <div class="summary-item">
                        <span>猫咪名称：</span>
                        <span id="orderCatName">-</span>
                    </div>
                    <div class="summary-item">
                        <span>品种：</span>
                        <span id="orderCatBreed">-</span>
                    </div>
                    <div class="summary-item">
                        <span>运费：</span>
                        <span>¥200</span>
                    </div>
                    <div class="summary-total">
                        <span>总计：</span>
                        <span>¥12,800</span>
                    </div>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="submitOrder()">确认下单</button>
            </div>
        </div>
    </div>

    <!-- 私信模态框 -->
    <div class="message-modal" id="messageModal">
        <div class="message-content">
            <div class="order-header">
                <h2>私信咨询</h2>
                <button class="modal-close" onclick="closeMessageModal()">×</button>
            </div>
            <div class="order-body">
                <div class="form-group">
                    <label class="form-label">您的称呼</label>
                    <input type="text" class="form-input" id="senderName" placeholder="请输入您的称呼">
                </div>
                <div class="form-group">
                    <label class="form-label">联系电话</label>
                    <input type="tel" class="form-input" id="senderPhone" placeholder="请输入您的联系方式">
                </div>
                <div class="form-group">
                    <label class="form-label">咨询内容</label>
                    <textarea class="form-textarea" id="messageContent" placeholder="请输入您想咨询的问题，我们会尽快回复您"></textarea>
                </div>
                <button class="btn btn-primary" style="width: 100%;" onclick="sendMessage()">发送消息</button>
            </div>
        </div>
    </div>

    <!-- 物流信息模态框 -->
    <div class="order-modal" id="logisticsModal">
        <div class="order-content">
            <div class="order-header">
                <h2>物流追踪</h2>
                <button class="modal-close" onclick="closeLogisticsModal()">×</button>
            </div>
            <div class="order-body">
                <div class="order-summary">
                    <div class="summary-item">
                        <span>订单号：</span>
                        <span>HK20240801001</span>
                    </div>
                    <div class="summary-item">
                        <span>物流公司：</span>
                        <span>顺丰速运</span>
                    </div>
                    <div class="summary-item">
                        <span>运单号：</span>
                        <span>SF1234567890</span>
                    </div>
                </div>
                <!-- 实时追踪信息 -->
                <div class="real-time-tracking">
                    <div class="tracking-header">📍 实时位置</div>
                    <div class="tracking-info">
                        <div class="tracking-item">
                            <div class="tracking-label">当前位置</div>
                            <div class="tracking-value" id="currentLocation">杭州市上城区</div>
                        </div>
                        <div class="tracking-item">
                            <div class="tracking-label">快递员</div>
                            <div class="tracking-value" id="courierName">张师傅</div>
                        </div>
                        <div class="tracking-item">
                            <div class="tracking-label">联系电话</div>
                            <div class="tracking-value" id="courierPhone">138****5678</div>
                        </div>
                        <div class="tracking-item">
                            <div class="tracking-label">预计送达</div>
                            <div class="tracking-value" id="estimatedDelivery">今日 18:00</div>
                        </div>
                    </div>
                </div>

                <!-- 地图显示 -->
                <div class="map-section">
                    <div class="route-title">🗺️ 配送路线地图</div>
                    <div class="map-container">
                        <div class="map-loading" id="mapLoading">
                            <div>🗺️</div>
                            <div>地图加载中...</div>
                        </div>
                        <iframe 
                            id="deliveryMap"
                            class="map-iframe" 
                            style="display: none;"
                            src=""
                            allowfullscreen>
                        </iframe>
                    </div>
                </div>

                <!-- 配送路线 -->
                <div class="route-map">
                    <div class="route-title">📍 配送路线</div>
                    <div class="route-steps" id="routeSteps">
                        <!-- 路线步骤将动态生成 -->
                    </div>
                </div>

                <div class="logistics-section" style="display: block;">
                    <div class="logistics-title">📦 物流详情</div>
                    <div class="logistics-timeline" id="logisticsTimeline">
                            <div class="logistics-item completed">
                                <div class="logistics-time">2024-08-01 14:30</div>
                                <div class="logistics-text">您的订单已发货</div>
                            </div>
                            <div class="logistics-item completed">
                                <div class="logistics-time">2024-08-01 16:45</div>
                                <div class="logistics-text">快递已揽收</div>
                            </div>
                            <div class="logistics-item completed">
                                <div class="logistics-time">2024-08-02 08:20</div>
                                <div class="logistics-text">运输中 - 已到达杭州分拣中心</div>
                            </div>
                            <div class="logistics-item current">
                                <div class="logistics-time">2024-08-02 14:15</div>
                                <div class="logistics-text">派送中 - 快递员正在派送</div>
                            </div>
                            <div class="logistics-item">
                                <div class="logistics-time">预计送达</div>
                                <div class="logistics-text">今日 18:00 前</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <!-- 个人帖子管理模态框 -->
        <div class="modal" id="myPostsModal">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h2>📝 我的帖子管理</h2>
                    <button class="modal-close" onclick="closeMyPostsModal()">×</button>
                </div>
                <div class="modal-body" style="max-height: 600px; overflow-y: auto;">
                    <div class="my-posts-tabs">
                        <button class="tab-btn active" onclick="showMyPostsTab('published')">已发布</button>
                        <button class="tab-btn" onclick="showMyPostsTab('drafts')">草稿箱</button>
                        <button class="tab-btn" onclick="showMyPostsTab('liked')">我的点赞</button>
                    </div>
                    <div id="myPostsContent" class="my-posts-content">
                        <!-- 动态内容 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 帖子详情模态框 -->
        <div class="modal" id="postDetailModal">
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <h2 id="detailPostTitle">帖子详情</h2>
                    <button class="modal-close" onclick="closePostDetailModal()">×</button>
                </div>
                <div class="modal-body" style="max-height: 600px; overflow-y: auto;">
                    <div id="postDetailContent">
                        <!-- 动态内容 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 宠物评论模态框 -->
        <div class="modal" id="catCommentModal">
            <div class="modal-content" style="max-width: 600px;">
                <div class="modal-header">
                    <h2>💬 留言评论</h2>
                    <button class="modal-close" onclick="closeCatCommentModal()">×</button>
                </div>
                <div class="modal-body" style="max-height: 500px; overflow-y: auto;">
                    <div class="cat-info" id="commentCatInfo" style="text-align: center; margin-bottom: 20px;">
                        <!-- 猫咪信息 -->
                    </div>
                    
                    <div class="comments-section">
                        <h3>💬 评论区</h3>
                        <div id="catCommentsList" class="comments-list">
                            <!-- 评论列表 -->
                        </div>
                        
                        <div class="add-comment">
                            <textarea id="newComment" placeholder="写下您的评论..." style="width: 100%; height: 80px; padding: 10px; border: 1px solid #ddd; border-radius: 8px; resize: vertical;"></textarea>
                            <button class="btn btn-primary" style="margin-top: 10px; width: 100%;" onclick="addCatComment()">发表评论</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
        // 全局数据存储
        let currentUser = {
            id: 'user_' + Date.now(),
            name: '访客用户',
            avatar: '访',
            level: '见习铲屎官'
        };

        // 初始化用户数据
        function initUserData() {
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
            }
        }

        // 保存用户数据
        function saveUserData() {
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
        }

        // 用户发帖数据
        let userPosts = JSON.parse(localStorage.getItem('userPosts') || '[]');

        // 猫咪评论数据
        let catComments = JSON.parse(localStorage.getItem('catComments') || '{}');

        // 私信数据
        let privateMessages = JSON.parse(localStorage.getItem('privateMessages') || '[]');

        // 论坛数据 - 更丰富的贴吧风格数据
        const catsData = [
            {
                id: 1,
                name: '金宝',
                age: '2岁',
                breed: '英国金渐层',
                personality: '沉稳大气，王者风范',
                description: '金宝是李先生家的镇宅之宝，拥有纯正的12色金渐层血统。体型健硕，毛色金黄发亮，在阳光下闪烁着迷人的光芒。性格沉稳温和，不喜欢吵闹，喜欢安静地趴在主人身边看书。已经完成绝育手术，身体健康，定期体检。特别喜欢在阳台上晒太阳，享受悠闲的午后时光。',
                image: 'https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?w=800&h=600&fit=crop&auto=format',
                gender: '公猫',
                weight: '5.8kg',
                color: '12色金渐层',
                vaccinated: true,
                neutered: true,
                addedDate: '2024-01-15'
            },
            {
                id: 2,
                name: '蜜桃',
                age: '1岁4个月',
                breed: '英国金渐层',
                personality: '甜美可人，撒娇专家',
                description: '蜜桃像她的名字一样甜美，是家里的温柔小公主。拥有圆润的脸庞和大大的绿色眼睛，毛色呈现出蜜桃般的暖色调。特别喜欢黏着主人，会用软软的身体蹭人的腿，发出满足的呼噜声。已经学会使用猫砂盆，吃饭习惯很好，不挑食。最适合有小孩的家庭，对小朋友特别有耐心。',
                image: 'https://images.unsplash.com/photo-1513245543132-31f507417b26?w=800&h=600&fit=crop&auto=format',
                gender: '母猫',
                weight: '4.2kg',
                color: '11色金渐层',
                vaccinated: true,
                neutered: true,
                addedDate: '2024-02-20'
            },
            {
                id: 3,
                name: '元宝',
                age: '3岁',
                breed: '英国金渐层',
                personality: '憨厚老实，食量大王',
                description: '元宝是家里的开心果，体型微胖但非常健康。拥有金灿灿的被毛和圆滚滚的身体，看起来就像一个行走的元宝。性格憨厚老实，从不主动惹事，但对食物有着执着的爱。每天定时定量喂食，已经养成良好的饮食习惯。特别喜欢被挠下巴，只要一挠就会发出满足的呼噜声。是理想的陪伴型猫咪。',
                image: 'https://images.unsplash.com/photo-1495360010541-f48722b34f7d?w=800&h=600&fit=crop&auto=format',
                gender: '公猫',
                weight: '6.8kg',
                color: '12色金渐层',
                vaccinated: true,
                neutered: true,
                addedDate: '2024-03-10'
            },
            {
                id: 4,
                name: '雪球',
                age: '11个月',
                breed: '英国金渐层',
                personality: '活泼好动，好奇心强',
                description: '雪球是家里最小但最活泼的成员，虽然年纪小但已经展现出金渐层的优秀品质。毛色纯白中带着淡淡的金色，就像一个雪白的小绒球。特别爱玩，对任何会动的东西都充满好奇，喜欢追逐激光笔和逗猫棒。已经学会使用猫砂，吃饭很乖巧。因为是幼猫，还需要更多关注和陪伴，非常适合喜欢和猫咪互动的家庭。',
                image: 'https://images.unsplash.com/photo-1573865526739-10659fec78a5?w=800&h=600&fit=crop&auto=format',
                gender: '母猫',
                weight: '3.6kg',
                color: '11色金渐层',
                vaccinated: true,
                neutered: false,
                addedDate: '2024-05-15'
            }
        ];

        let filteredCats = [...catsData];
        let currentCat = null;
        let likedCats = new Set();
        let orders = [];
        let messages = [];
        let notifications = 0;
        let cart = [];
        let shopOrders = [];
        let appointments = [];
        let forumPosts = [];
        let currentSection = 'cats';

        // ========== 个人帖子管理功能 ==========
        
        // 显示我的帖子管理
        function showMyPosts() {
            document.getElementById('myPostsModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            showMyPostsTab('published');
        }

        // 关闭我的帖子管理
        function closeMyPostsModal() {
            document.getElementById('myPostsModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 显示我的帖子标签页
        function showMyPostsTab(tab) {
            // 更新标签按钮状态
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const content = document.getElementById('myPostsContent');
            let html = '';
            
            switch(tab) {
                case 'published':
                    html = renderPublishedPosts();
                    break;
                case 'drafts':
                    html = renderDraftPosts();
                    break;
                case 'liked':
                    html = renderLikedPosts();
                    break;
            }
            
            content.innerHTML = html;
        }

        // 渲染已发布的帖子
        function renderPublishedPosts() {
            const myPublishedPosts = userPosts.filter(post => post.status === 'published');
            
            if (myPublishedPosts.length === 0) {
                return '<div class="empty-comments">您还没有发布过帖子</div>';
            }
            
            return myPublishedPosts.map(post => `
                <div class="my-post-item">
                    <div class="my-post-header">
                        <div class="my-post-title" onclick="viewPostDetail(${post.id})">${post.title}</div>
                        <div class="my-post-actions">
                            <button class="my-post-btn" onclick="editPost(${post.id})">编辑</button>
                            <button class="my-post-btn delete" onclick="deletePost(${post.id})">删除</button>
                        </div>
                    </div>
                    <div class="my-post-meta">
                        发布时间：${new Date(post.createTime).toLocaleString()} | 
                        类型：${post.typeName} | 
                        浏览：${post.views || 0} 次
                    </div>
                    <div class="my-post-stats">
                        <span>👍 ${post.likes || 0} 点赞</span>
                        <span>💬 ${post.comments?.length || 0} 评论</span>
                    </div>
                </div>
            `).join('');
        }

        // 渲染草稿
        function renderDraftPosts() {
            const myDrafts = userPosts.filter(post => post.status === 'draft');
            
            if (myDrafts.length === 0) {
                return '<div class="empty-comments">您没有草稿</div>';
            }
            
            return myDrafts.map(post => `
                <div class="my-post-item">
                    <div class="my-post-header">
                        <div class="my-post-title" onclick="editPost(${post.id})">${post.title || '无标题'}</div>
                        <div class="my-post-actions">
                            <button class="my-post-btn" onclick="publishDraft(${post.id})">发布</button>
                            <button class="my-post-btn delete" onclick="deletePost(${post.id})">删除</button>
                        </div>
                    </div>
                    <div class="my-post-meta">
                        创建时间：${new Date(post.createTime).toLocaleString()}
                    </div>
                </div>
            `).join('');
        }

        // 渲染点赞的帖子
        function renderLikedPosts() {
            const likedPostIds = JSON.parse(localStorage.getItem('likedPosts') || '[]');
            const likedPosts = forumPostsData.filter(post => likedPostIds.includes(post.id));
            
            if (likedPosts.length === 0) {
                return '<div class="empty-comments">您还没有点赞过任何帖子</div>';
            }
            
            return likedPosts.map(post => `
                <div class="my-post-item">
                    <div class="my-post-title" onclick="viewPostDetail(${post.id})">${post.title}</div>
                    <div class="my-post-meta">
                        作者：${post.author} | 发布时间：${post.time}
                    </div>
                    <div class="my-post-stats">
                        <span>👍 ${post.likes} 点赞</span>
                        <span>💬 ${post.comments} 评论</span>
                        <span>👁 ${post.views} 浏览</span>
                    </div>
                </div>
            `).join('');
        }

        // 查看帖子详情
        function viewPostDetail(postId) {
            const post = forumPostsData.find(p => p.id === postId);
            if (!post) return;
            
            document.getElementById('detailPostTitle').textContent = post.title;
            const content = document.getElementById('postDetailContent');
            
            // 获取帖子的评论
            const postComments = JSON.parse(localStorage.getItem(`postComments_${postId}`) || '[]');
            
            content.innerHTML = `
                <div class="post-detail-header">
                    <div class="post-detail-author">
                        <div class="user-avatar">${post.avatar}</div>
                        <div>
                            <div>${post.author}</div>
                            <div class="author-level">${post.level}</div>
                        </div>
                    </div>
                    <div class="post-type">${post.typeName}</div>
                </div>
                
                <div class="post-detail-content">${post.content.replace(/\n/g, '<br>')}</div>
                
                <div class="post-detail-stats">
                    <span>👍 ${post.likes} 点赞</span>
                    <span>💬 ${post.comments} 评论</span>
                    <span>👁 ${post.views} 浏览</span>
                    <span>📅 ${post.time}</span>
                </div>
                
                <div class="post-detail-comments">
                    <h3>💬 评论 (${postComments.length})</h3>
                    
                    <div class="comment-form">
                        <textarea id="detailCommentInput" class="comment-input" placeholder="写下您的评论..."></textarea>
                        <button class="btn btn-primary" onclick="addPostComment(${postId})">发表评论</button>
                    </div>
                    
                    <div id="postCommentsList">
                        ${postComments.map(comment => `
                            <div class="comment-item">
                                <div class="comment-author">${comment.author}</div>
                                <div class="comment-time">${new Date(comment.time).toLocaleString()}</div>
                                <div class="comment-content">${comment.content}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('postDetailModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // 关闭帖子详情
        function closePostDetailModal() {
            document.getElementById('postDetailModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 添加帖子评论
        function addPostComment(postId) {
            const content = document.getElementById('detailCommentInput').value.trim();
            if (!content) {
                alert('请输入评论内容');
                return;
            }
            
            const comments = JSON.parse(localStorage.getItem(`postComments_${postId}`) || '[]');
            const newComment = {
                id: Date.now(),
                postId: postId,
                author: currentUser.name,
                avatar: currentUser.avatar,
                content: content,
                time: new Date().toISOString()
            };
            
            comments.push(newComment);
            localStorage.setItem(`postComments_${postId}`, JSON.stringify(comments));
            
            // 更新帖子评论数
            const post = forumPostsData.find(p => p.id === postId);
            if (post) {
                post.comments = comments.length;
            }
            
            document.getElementById('detailCommentInput').value = '';
            viewPostDetail(postId); // 刷新评论列表
        }

        // 编辑帖子
        function editPost(postId) {
            const post = userPosts.find(p => p.id === postId);
            if (!post) return;
            
            // 这里可以打开编辑模态框或导航到编辑页面
            alert('编辑功能开发中，敬请期待！');
        }

        // 发布草稿
        function publishDraft(postId) {
            const postIndex = userPosts.findIndex(p => p.id === postId);
            if (postIndex === -1) return;
            
            userPosts[postIndex].status = 'published';
            userPosts[postIndex].publishTime = new Date().toISOString();
            
            // 添加到论坛数据
            const forumPost = {
                ...userPosts[postIndex],
                time: '刚刚',
                isNew: true
            };
            forumPostsData.unshift(forumPost);
            
            localStorage.setItem('userPosts', JSON.stringify(userPosts));
            
            alert('帖子发布成功！');
            showMyPostsTab('published');
        }

        // 删除帖子
        function deletePost(postId) {
            if (!confirm('确定要删除这个帖子吗？')) return;
            
            // 从用户帖子中删除
            const postIndex = userPosts.findIndex(p => p.id === postId);
            if (postIndex !== -1) {
                userPosts.splice(postIndex, 1);
                localStorage.setItem('userPosts', JSON.stringify(userPosts));
            }
            
            // 从论坛数据中删除
            const forumIndex = forumPostsData.findIndex(p => p.id === postId);
            if (forumIndex !== -1) {
                forumPostsData.splice(forumIndex, 1);
            }
            
            alert('帖子已删除');
            showMyPostsTab('published');
        }

        // ========== 猫咪评论和私信功能 ==========
        
        // 打开猫咪评论模态框
        function openCatCommentModal() {
            if (!currentCat) return;
            
            const catInfo = document.getElementById('commentCatInfo');
            catInfo.innerHTML = `
                <img src="${currentCat.image}" class="cat-info-img" alt="${currentCat.name}">
                <h3>${currentCat.name}</h3>
                <p>${currentCat.breed} | ${currentCat.age} | ${currentCat.gender}</p>
            `;
            
            renderCatComments();
            document.getElementById('catCommentModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            closeModal(); // 关闭猫咪详情模态框
        }

        // 关闭猫咪评论模态框
        function closeCatCommentModal() {
            document.getElementById('catCommentModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 渲染猫咪评论
        function renderCatComments() {
            const comments = catComments[currentCat.id] || [];
            const commentsList = document.getElementById('catCommentsList');
            
            if (comments.length === 0) {
                commentsList.innerHTML = '<div class="empty-comments">暂无评论，快来抢沙发吧！</div>';
                return;
            }
            
            commentsList.innerHTML = comments.map(comment => `
                <div class="comment-item">
                    <div style="display: flex; align-items: center; margin-bottom: 8px;">
                        <div class="user-avatar">${comment.avatar}</div>
                        <div>
                            <div class="comment-author">${comment.author}</div>
                            <div class="comment-time">${new Date(comment.time).toLocaleString()}</div>
                        </div>
                    </div>
                    <div class="comment-content">${comment.content}</div>
                </div>
            `).join('');
        }

        // 添加猫咪评论
        function addCatComment() {
            const content = document.getElementById('newComment').value.trim();
            if (!content) {
                alert('请输入评论内容');
                return;
            }
            
            if (!catComments[currentCat.id]) {
                catComments[currentCat.id] = [];
            }
            
            const newComment = {
                id: Date.now(),
                author: currentUser.name,
                avatar: currentUser.avatar,
                content: content,
                time: new Date().toISOString()
            };
            
            catComments[currentCat.id].push(newComment);
            localStorage.setItem('catComments', JSON.stringify(catComments));
            
            document.getElementById('newComment').value = '';
            renderCatComments();
            
            alert('评论发表成功！');
        }

        // 发送猫咪私信给管理员
        function sendCatPrivateMessage() {
            if (!currentCat) return;
            
            const content = prompt(`请输入您想对李先生咨询的关于${currentCat.name}的问题：`);
            if (!content) return;
            
            const message = {
                id: Date.now(),
                type: 'cat_inquiry',
                catId: currentCat.id,
                catName: currentCat.name,
                sender: currentUser.name,
                senderPhone: '', // 可以在后续版本中添加
                content: content,
                createTime: new Date().toISOString(),
                status: 'unread',
                reply: ''
            };
            
            privateMessages.push(message);
            localStorage.setItem('privateMessages', JSON.stringify(privateMessages));
            
            alert(`私信发送成功！李先生会尽快回复您关于${currentCat.name}的问题。`);
        }

        // 初始化
        function init() {
            initUserData();
            renderCats();
            updateCounts();
            setupEventListeners();
        }

        // 设置事件监听器
        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', filterCats);
            document.getElementById('genderFilter').addEventListener('change', filterCats);
            document.getElementById('sortBy').addEventListener('change', filterCats);
        }

        // 渲染猫咪卡片
        function renderCats() {
            const grid = document.getElementById('catsGrid');
            
            if (filteredCats.length === 0) {
                grid.innerHTML = `
                    <div class="no-results" style="grid-column: 1/-1;">
                        <div class="no-results-icon">🔍</div>
                        <h3>没有找到匹配的猫咪</h3>
                        <p>试试调整搜索条件来找到您心仪的猫咪。</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filteredCats.map((cat, index) => `
                <div class="cat-card fade-in" style="animation-delay: ${index * 0.1}s" onclick="showCatDetail(${cat.id})">
                    <img class="cat-image" src="${cat.image}" alt="${cat.name}">
                    <div class="cat-info">
                        <h3 class="cat-name">${cat.name}</h3>
                        <div class="cat-details">
                            <div class="cat-detail">${cat.age} • ${cat.gender} • ${cat.weight}</div>
                            <div class="cat-detail">${cat.breed}</div>
                        </div>
                        <div class="cat-personality">${cat.personality}</div>
                    </div>
                </div>
            `).join('');
        }

        // 筛选猫咪
        function filterCats() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const genderFilter = document.getElementById('genderFilter').value;
            const sortBy = document.getElementById('sortBy').value;

            let result = [...catsData];

            // 搜索筛选
            if (searchTerm) {
                result = result.filter(cat => 
                    cat.name.toLowerCase().includes(searchTerm) ||
                    cat.breed.toLowerCase().includes(searchTerm) ||
                    cat.personality.toLowerCase().includes(searchTerm)
                );
            }

            // 性别筛选
            if (genderFilter !== 'all') {
                result = result.filter(cat => cat.gender === genderFilter);
            }

            // 排序
            switch (sortBy) {
                case 'newest':
                    result.sort((a, b) => new Date(b.addedDate) - new Date(a.addedDate));
                    break;
                case 'oldest':
                    result.sort((a, b) => new Date(a.addedDate) - new Date(b.addedDate));
                    break;
                case 'name':
                    result.sort((a, b) => a.name.localeCompare(b.name, 'zh-CN'));
                    break;
                case 'age':
                    result.sort((a, b) => {
                        const ageA = parseInt(a.age) || 0;
                        const ageB = parseInt(b.age) || 0;
                        return ageB - ageA;
                    });
                    break;
            }

            filteredCats = result;
            renderCats();
            updateCounts();
        }

        // 更新计数
        function updateCounts() {
            document.getElementById('totalCats').textContent = catsData.length;
            document.getElementById('catsCount').textContent = `共 ${filteredCats.length} 只猫咪`;
        }

        // 显示猫咪详情
        function showCatDetail(catId) {
            currentCat = catsData.find(cat => cat.id === catId);
            if (!currentCat) return;

            document.getElementById('modalImage').src = currentCat.image;
            document.getElementById('modalTitle').textContent = currentCat.name;
            document.getElementById('modalAge').textContent = currentCat.age;
            document.getElementById('modalGender').textContent = currentCat.gender;
            document.getElementById('modalWeight').textContent = currentCat.weight;
            document.getElementById('modalBreed').textContent = currentCat.breed;
            document.getElementById('modalDescription').textContent = currentCat.description;

            const likeBtn = document.getElementById('likeBtn');
            if (likedCats.has(catId)) {
                likeBtn.classList.add('liked');
                likeBtn.textContent = '💚 已喜欢';
            } else {
                likeBtn.classList.remove('liked');
                likeBtn.textContent = '❤️ 喜欢';
            }

            document.getElementById('catModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // 关闭模态框
        function closeModal() {
            document.getElementById('catModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 切换喜欢状态
        function toggleLike() {
            if (!currentCat) return;

            const likeBtn = document.getElementById('likeBtn');
            if (likedCats.has(currentCat.id)) {
                likedCats.delete(currentCat.id);
                likeBtn.classList.remove('liked');
                likeBtn.textContent = '❤️ 喜欢';
            } else {
                likedCats.add(currentCat.id);
                likeBtn.classList.add('liked');
                likeBtn.textContent = '💚 已喜欢';
            }
        }

        // 分享猫咪
        function shareCat() {
            if (!currentCat) return;

            const shareText = `来看看${currentCat.name}，一只${currentCat.age}的${currentCat.breed}！${currentCat.personality}`;
            const shareUrl = window.location.href;

            if (navigator.share) {
                navigator.share({
                    title: `${currentCat.name} - 杭州自家小猫咪`,
                    text: shareText,
                    url: shareUrl
                });
            } else {
                // 复制到剪贴板
                navigator.clipboard.writeText(`${shareText} ${shareUrl}`).then(() => {
                    alert('分享链接已复制到剪贴板！');
                });
            }
        }

        // 点击模态框外部关闭
        document.getElementById('catModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // ESC键关闭模态框
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // 用户下拉菜单
        function toggleUserDropdown() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('show');
        }

        // 移动端菜单切换
        function toggleMobileMenu() {
            const menu = document.getElementById('navMenu');
            menu.classList.toggle('show');
        }

        // 点击外部关闭下拉菜单
        document.addEventListener('click', function(e) {
            const userSection = document.querySelector('.user-section');
            if (!userSection.contains(e.target)) {
                document.getElementById('userDropdown').classList.remove('show');
            }
            
            // 关闭移动端菜单
            const navMenu = document.getElementById('navMenu');
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            if (!navMenu.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                navMenu.classList.remove('show');
            }
        });

        // 打开订单模态框
        function openOrderModal() {
            if (!currentCat) return;
            
            document.getElementById('orderCatName').textContent = currentCat.name;
            document.getElementById('orderCatBreed').textContent = currentCat.breed;
            document.getElementById('orderModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            closeModal(); // 关闭猫咪详情模态框
        }

        // 关闭订单模态框
        function closeOrderModal() {
            document.getElementById('orderModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 提交订单
        function submitOrder() {
            const name = document.getElementById('customerName').value.trim();
            const phone = document.getElementById('customerPhone').value.trim();
            const address = document.getElementById('customerAddress').value.trim();
            const note = document.getElementById('orderNote').value.trim();

            if (!name || !phone || !address) {
                alert('请填写完整的收货信息');
                return;
            }

            const order = {
                id: Date.now(),
                catId: currentCat.id,
                catName: currentCat.name,
                customerName: name,
                customerPhone: phone,
                customerAddress: address,
                note: note,
                totalAmount: 12800,
                status: 'pending',
                createTime: new Date().toISOString(),
                logistics: {
                    company: '顺丰速运',
                    trackingNumber: 'SF' + Date.now(),
                    status: 'preparing'
                }
            };

            orders.push(order);
            localStorage.setItem('orders', JSON.stringify(orders));
            
            alert('订单提交成功！我们会尽快与您联系确认。');
            closeOrderModal();
            
            // 清空表单
            document.getElementById('customerName').value = '';
            document.getElementById('customerPhone').value = '';
            document.getElementById('customerAddress').value = '';
            document.getElementById('orderNote').value = '';
        }

        // 打开私信模态框
        function openMessageModal() {
            if (!currentCat) return;
            
            document.getElementById('messageModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            closeModal(); // 关闭猫咪详情模态框
        }

        // 关闭私信模态框
        function closeMessageModal() {
            document.getElementById('messageModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 发送私信
        function sendMessage() {
            const name = document.getElementById('senderName').value.trim();
            const phone = document.getElementById('senderPhone').value.trim();
            const content = document.getElementById('messageContent').value.trim();

            if (!name || !phone || !content) {
                alert('请填写完整的私信信息');
                return;
            }

            const message = {
                id: Date.now(),
                catId: currentCat.id,
                catName: currentCat.name,
                senderName: name,
                senderPhone: phone,
                content: content,
                createTime: new Date().toISOString(),
                status: 'unread',
                reply: ''
            };

            messages.push(message);
            localStorage.setItem('messages', JSON.stringify(messages));
            
            alert('私信发送成功！李先生会尽快回复您。');
            closeMessageModal();
            
            // 清空表单
            document.getElementById('senderName').value = '';
            document.getElementById('senderPhone').value = '';
            document.getElementById('messageContent').value = '';
        }

        // 显示订单列表
        function showOrders() {
            const ordersList = JSON.parse(localStorage.getItem('orders') || '[]');
            
            if (ordersList.length === 0) {
                alert('您还没有订单');
                return;
            }

            let ordersHtml = '📦 我的订单\n\n';
            ordersList.forEach((order, index) => {
                ordersHtml += `${index + 1}. ${order.catName} - ${order.totalAmount}元\n`;
                ordersHtml += `   状态: ${getOrderStatus(order.status)}\n`;
                ordersHtml += `   时间: ${new Date(order.createTime).toLocaleString()}\n\n`;
            });

            alert(ordersHtml);
        }

        // 显示私信列表
        function showMessages() {
            const messagesList = JSON.parse(localStorage.getItem('messages') || '[]');
            
            if (messagesList.length === 0) {
                alert('您还没有私信记录');
                return;
            }

            let messagesHtml = '💬 私信消息\n\n';
            messagesList.forEach((message, index) => {
                messagesHtml += `${index + 1}. 咨询${message.catName}\n`;
                messagesHtml += `   内容: ${message.content}\n`;
                messagesHtml += `   时间: ${new Date(message.createTime).toLocaleString()}\n`;
                if (message.reply) {
                    messagesHtml += `   回复: ${message.reply}\n`;
                }
                messagesHtml += '\n';
            });

            alert(messagesHtml);
            updateNotificationBadge();
        }

        // 物流追踪数据
        const logisticsData = {
            orderNumber: 'HK20240801001',
            company: '顺丰速运',
            trackingNumber: 'SF1234567890',
            currentLocation: '杭州市上城区解放路88号',
            courierName: '张师傅',
            courierPhone: '13812345678',
            estimatedDelivery: '今日 18:00',
            route: [
                {
                    location: '杭州分拣中心',
                    address: '杭州市江干区',
                    time: '08:20',
                    status: 'completed',
                    lat: 30.2741,
                    lng: 120.1551
                },
                {
                    location: '杭州配送站',
                    address: '杭州市上城区',
                    time: '12:30',
                    status: 'completed',
                    lat: 30.2594,
                    lng: 120.1697
                },
                {
                    location: '您的地址',
                    address: '杭州市上城区解放路88号',
                    time: '14:15',
                    status: 'current',
                    lat: 30.2628,
                    lng: 120.1752
                }
            ],
            timeline: [
                {
                    time: '2024-08-01 14:30',
                    status: 'completed',
                    text: '您的订单已发货'
                },
                {
                    time: '2024-08-01 16:45',
                    status: 'completed',
                    text: '快递已揽收'
                },
                {
                    time: '2024-08-02 08:20',
                    status: 'completed',
                    text: '运输中 - 已到达杭州分拣中心'
                },
                {
                    time: '2024-08-02 12:30',
                    status: 'completed',
                    text: '已到达杭州配送站'
                },
                {
                    time: '2024-08-02 14:15',
                    status: 'current',
                    text: '派送中 - 快递员正在派送'
                },
                {
                    time: '预计送达',
                    status: 'pending',
                    text: '今日 18:00 前'
                }
            ]
        };

        // 显示物流追踪
        function showLogistics() {
            document.getElementById('logisticsModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            initLogisticsMap();
            updateLogisticsInfo();
        }

        // 关闭物流模态框
        function closeLogisticsModal() {
            document.getElementById('logisticsModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 初始化物流地图
        function initLogisticsMap() {
            // 更新基本信息
            document.getElementById('trackingOrderNumber').textContent = logisticsData.orderNumber;
            document.getElementById('trackingCompany').textContent = logisticsData.company;
            document.getElementById('trackingNumber').textContent = logisticsData.trackingNumber;

            // 更新实时信息
            document.getElementById('currentLocation').textContent = logisticsData.currentLocation;
            document.getElementById('courierName').textContent = logisticsData.courierName;
            document.getElementById('courierPhone').textContent = logisticsData.courierPhone.replace(/(\d{3})\d{4}(\d{4})/, '$1****$2');
            document.getElementById('estimatedDelivery').textContent = logisticsData.estimatedDelivery;
            document.getElementById('finalEstimate').textContent = logisticsData.estimatedDelivery;

            // 渲染路线步骤
            renderDeliveryRoute();

            // 渲染物流时间线
            renderLogisticsTimeline();

            // 初始化地图
            setTimeout(() => {
                loadDeliveryMap();
            }, 1000);
        }

        // 渲染配送路线
        function renderDeliveryRoute() {
            const routeSteps = document.getElementById('routeSteps');
            routeSteps.innerHTML = logisticsData.route.map((step, index) => `
                <div class="route-step">
                    <div class="route-location">${step.location}</div>
                    <div class="route-time">${step.time} - ${step.address}</div>
                </div>
            `).join('');
        }

        // 渲染物流时间线
        function renderLogisticsTimeline() {
            const timeline = document.getElementById('logisticsTimeline');
            timeline.innerHTML = logisticsData.timeline.map((item, index) => `
                <div class="logistics-item ${item.status}">
                    <div class="logistics-time">${item.time}</div>
                    <div class="logistics-text">${item.text}</div>
                </div>
            `).join('');
        }

        // 加载配送地图
        function loadDeliveryMap() {
            const mapLoading = document.getElementById('mapLoading');
            const deliveryMap = document.getElementById('deliveryMap');

            // 构建地图URL - 使用OpenStreetMap
            const currentStep = logisticsData.route.find(step => step.status === 'current');
            if (currentStep) {
                const mapUrl = `https://www.openstreetmap.org/export/embed.html?bbox=${currentStep.lng-0.01},${currentStep.lat-0.01},${currentStep.lng+0.01},${currentStep.lat+0.01}&layer=mapnik&marker=${currentStep.lat},${currentStep.lng}`;
                
                deliveryMap.src = mapUrl;
                deliveryMap.style.display = 'block';
                mapLoading.style.display = 'none';
            }
        }

        // 刷新物流信息
        function refreshTracking() {
            // 模拟刷新效果
            const refreshBtn = event.target;
            refreshBtn.textContent = '🔄 刷新中...';
            refreshBtn.disabled = true;

            setTimeout(() => {
                // 模拟更新位置
                const locations = [
                    '杭州市上城区解放路88号附近',
                    '杭州市上城区解放路88号',
                    '已到达目的地，正在联系收件人'
                ];
                const randomLocation = locations[Math.floor(Math.random() * locations.length)];
                
                document.getElementById('currentLocation').textContent = randomLocation;
                document.getElementById('estimatedDelivery').textContent = '15分钟内';
                document.getElementById('finalEstimate').textContent = '15分钟内';

                refreshBtn.textContent = '🔄 刷新';
                refreshBtn.disabled = false;

                alert('物流信息已更新！');
            }, 2000);
        }

        // 显示收藏
        function showFavorites() {
            if (likedCats.size === 0) {
                alert('您还没有收藏的猫咪');
                return;
            }

            const favoriteCats = catsData.filter(cat => likedCats.has(cat.id));
            let favoritesHtml = '❤️ 我的收藏\n\n';
            favoriteCats.forEach((cat, index) => {
                favoritesHtml += `${index + 1}. ${cat.name} - ${cat.age} - ${cat.personality}\n`;
            });

            alert(favoritesHtml);
        }

        // 获取订单状态文本
        function getOrderStatus(status) {
            const statusMap = {
                'pending': '待确认',
                'confirmed': '已确认',
                'preparing': '准备中',
                'shipped': '已发货',
                'delivered': '已送达',
                'cancelled': '已取消'
            };
            return statusMap[status] || '未知状态';
        }

        // 更新通知角标
        function updateNotificationBadge() {
            const messagesList = JSON.parse(localStorage.getItem('messages') || '[]');
            const unreadCount = messagesList.filter(msg => msg.status === 'unread').length;
            
            const badge = document.getElementById('notificationBadge');
            if (unreadCount > 0) {
                badge.textContent = unreadCount;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }

        // 商城数据
        const productsData = [
            {
                id: 1,
                name: '皇家猫粮 成猫专用',
                price: 298,
                category: 'food',
                desc: '营养均衡，适合成年猫咪日常食用，富含优质蛋白质和维生素',
                image: 'https://images.unsplash.com/photo-1589926414471-4341d13b7a76?w=400&h=300&fit=crop&auto=format'
            },
            {
                id: 2,
                name: '智能逗猫棒套装',
                price: 89,
                category: 'toy',
                desc: '电动互动玩具，自动移动，让猫咪爱不释手，锻炼猫咪反应能力',
                image: 'https://images.unsplash.com/photo-1606214174555-259fd1c62692?w=400&h=300&fit=crop&auto=format'
            },
            {
                id: 3,
                name: '猫用维生素片',
                price: 156,
                category: 'health',
                desc: '复合维生素，增强免疫力，促进毛发健康，适合各年龄段猫咪',
                image: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=300&fit=crop&auto=format'
            },
            {
                id: 4,
                name: '豪华猫窝',
                price: 399,
                category: 'living',
                desc: '舒适柔软，冬季保暖夏季透气，可拆洗，多种尺寸可选',
                image: 'https://images.unsplash.com/photo-1574158622682-e40e69881006?w=400&h=300&fit=crop&auto=format'
            },
            {
                id: 5,
                name: '进口猫零食罐头',
                price: 128,
                category: 'food',
                desc: '天然食材，无添加剂，口感丰富，可作为奖励或补充营养',
                image: 'https://images.unsplash.com/photo-1596854407944-bf87f6fdd49e?w=400&h=300&fit=crop&auto=format'
            },
            {
                id: 6,
                name: '猫爬架',
                price: 599,
                category: 'living',
                desc: '多层结构，剑麻柱，适合多猫家庭，满足猫咪攀爬天性',
                image: 'https://images.unsplash.com/photo-1513245543132-31f507417b26?w=400&h=300&fit=crop&auto=format'
            }
        ];

        // 医院数据（包含真实坐标）
        const hospitalsData = [
            {
                id: 1,
                name: '杭州宠物总医院',
                rating: 4.8,
                address: '杭州市上城区解放路88号',
                phone: '0571-88888888',
                services: ['24小时急诊', '宠物手术', '疫苗接种', '体检服务'],
                distance: '1.2km',
                coordinates: {
                    lat: 30.274084,
                    lng: 120.155069
                },
                realAddress: '浙江省杭州市上城区解放路88号'
            },
            {
                id: 2,
                name: '爱心宠物诊所',
                rating: 4.6,
                address: '杭州市西湖区文三路66号',
                phone: '0571-66666666',
                services: ['日常诊疗', '美容护理', '寄养服务'],
                distance: '2.5km',
                coordinates: {
                    lat: 30.262834,
                    lng: 120.127629
                },
                realAddress: '浙江省杭州市西湖区文三路66号'
            },
            {
                id: 3,
                name: '宠康动物医院',
                rating: 4.9,
                address: '杭州市拱墅区体育场路99号',
                phone: '0571-77777777',
                services: ['专科诊疗', '中医理疗', '康复护理', '营养咨询'],
                distance: '3.1km',
                coordinates: {
                    lat: 30.314539,
                    lng: 120.168386
                },
                realAddress: '浙江省杭州市拱墅区体育场路99号'
            },
            {
                id: 4,
                name: '杭州协和宠物医院',
                rating: 4.7,
                address: '杭州市滨江区江南大道588号',
                phone: '0571-55555555',
                services: ['24小时急诊', '宠物手术', '专科诊疗', '美容护理'],
                distance: null,
                coordinates: {
                    lat: 30.208458,
                    lng: 120.212316
                },
                realAddress: '浙江省杭州市滨江区江南大道588号'
            },
            {
                id: 5,
                name: '爱宠动物诊所',
                rating: 4.5,
                address: '杭州市江干区钱江路168号',
                phone: '0571-44444444',
                services: ['疫苗接种', '体检服务', '寄养服务', '营养咨询'],
                distance: null,
                coordinates: {
                    lat: 30.274128,
                    lng: 120.215634
                },
                realAddress: '浙江省杭州市江干区钱江路168号'
            },
            {
                id: 6,
                name: '宠物康健中心',
                rating: 4.8,
                address: '杭州市余杭区文一西路888号',
                phone: '0571-33333333',
                services: ['24小时急诊', '宠物手术', '中医理疗', '康复护理'],
                distance: null,
                coordinates: {
                    lat: 30.284527,
                    lng: 120.031278
                },
                realAddress: '浙江省杭州市余杭区文一西路888号'
            }
        ];

        // 用户位置
        let userLocation = null;

        // 论坛数据 - 更丰富的贴吧风格数据
        const forumPostsData = [
            {
                id: 1,
                type: 'dating',
                typeName: '宠物相亲',
                title: '【相亲】寻找英短蓝猫配偶，我家公猫2岁了<span class="hot-tag">热</span>',
                content: '家里有一只纯种英短蓝猫，2岁，性格温顺，毛色纯正，已经做过体检，想找一只健康的母猫配对。有意者请联系，价格面议。可以上门看猫，保证血统纯正。',
                author: '猫爸王先生',
                avatar: '王',
                level: '资深铲屎官',
                time: '2小时前',
                likes: 23,
                comments: 15,
                views: 156,
                isHot: true,
                latestComments: [
                    { author: '猫咪爱好者', content: '我家的母猫可以考虑，加微信详聊' },
                    { author: '专业繁育人', content: '品相不错，有血统证书吗？' }
                ]
            },
            {
                id: 2,
                type: 'experience',
                typeName: '养宠经验',
                title: '【经验】分享：金渐层猫咪的日常护理心得<span class="hot-tag">精华</span>',
                content: '养金渐层3年了，总结了一些护理经验，包括毛发护理、饮食搭配、日常运动等，希望对新手有帮助。\n\n1. 毛发护理：每天梳毛，使用专用猫粮\n2. 饮食搭配：荤素搭配，补充维生素\n3. 日常运动：每天陪玩30分钟以上\n\n详细经验欢迎交流...',
                author: '猫咪达人',
                avatar: '猫',
                level: '金牌铲屎官',
                time: '5小时前',
                likes: 56,
                comments: 32,
                views: 423,
                isHot: true,
                latestComments: [
                    { author: '新手小白', content: '学到了，收藏了！' },
                    { author: '养猫老手', content: '很实用的分享，感谢' }
                ]
            },
            {
                id: 3,
                type: 'help',
                typeName: '求助问答',
                title: '【求助】猫咪突然不爱吃饭怎么办？<span class="new-tag">新</span>',
                content: '我家猫咪平时很能吃，但是从昨天开始就不怎么吃饭了，精神状态还可以，请问大家这是怎么回事？需要去医院吗？猫咪3岁，平时饮食规律，没有其他异常。',
                author: '新手铲屎官',
                avatar: '新',
                level: '见习铲屎官',
                time: '1天前',
                likes: 12,
                comments: 28,
                views: 89,
                isNew: true,
                latestComments: [
                    { author: '兽医小王', content: '可能是天气原因，先观察一天' },
                    { author: '经验丰富', content: '检查一下猫粮是不是变质了' }
                ]
            },
            {
                id: 4,
                type: 'dating',
                typeName: '宠物相亲',
                title: '【相亲】美短猫咪找对象，要求对方健康活泼',
                content: '家里有只美短，8个月大，活泼可爱，已接种所有疫苗，想找个同龄的猫咪玩伴，以后也可以考虑配对。要求对方健康活泼，品种不限。',
                author: '美短妈妈',
                avatar: '美',
                level: '中级铲屎官',
                time: '2天前',
                likes: 34,
                comments: 19,
                views: 234,
                latestComments: [
                    { author: '布偶家长', content: '我家的布偶可以考虑' },
                    { author: '专业繁育', content: '品相不错，多大年龄配对比较好？' }
                ]
            },
            {
                id: 5,
                type: 'experience',
                typeName: '养宠经验',
                title: '【分享】新手养猫必备清单，避免踩坑！',
                content: '作为一名养猫3年的老手，总结出新手必备物品清单：\n✅ 猫砂盆（推荐开放式）\n✅ 优质猫粮（根据年龄段选择）\n✅ 猫抓板（必备，防止抓坏家具）\n✅ 玩具（逗猫棒、激光笔等）\n\n其他注意事项...',
                author: '养猫老司机',
                avatar: '老',
                level: '金牌铲屎官',
                time: '3天前',
                likes: 78,
                comments: 45,
                views: 567,
                isHot: true,
                latestComments: [
                    { author: '准铲屎官', content: '太有用了，准备接猫回家' },
                    { author: '猫舍主人', content: '总结得很到位，支持一下' }
                ]
            },
            {
                id: 6,
                type: 'help',
                typeName: '求助问答',
                title: '【求助】猫咪总在我睡觉时候叫怎么办？',
                content: '我家猫咪总是在我睡觉的时候叫个不停，严重影响睡眠。试了很多方法都不管用，请问有什么好办法吗？猫咪1岁多，白天很正常。',
                author: '失眠铲屎官',
                avatar: '失',
                level: '见习铲屎官',
                time: '4天前',
                likes: 25,
                comments: 38,
                views: 312,
                latestComments: [
                    { author: '睡眠专家', content: '睡前陪它玩累就好了' },
                    { author: '行为专家', content: '可能是缺乏安全感，试试一起睡' }
                ]
            }
        ];

        // 显示商城
        function showShop() {
            hideAllSections();
            document.getElementById('shopSection').style.display = 'block';
            currentSection = 'shop';
            renderProducts('all');
            window.scrollTo(0, 0);
        }

        // 渲染商品
        function renderProducts(category) {
            const grid = document.getElementById('productsGrid');
            let products = category === 'all' ? productsData : productsData.filter(p => p.category === category);
            
            grid.innerHTML = products.map(product => `
                <div class="product-card">
                    <img class="product-image" src="${product.image}" alt="${product.name}">
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-price">¥${product.price}</div>
                        <p class="product-desc">${product.desc}</p>
                        <button class="add-to-cart" onclick="addToCart(${product.id})">加入购物车</button>
                    </div>
                </div>
            `).join('');
        }

        // 筛选商品
        function filterProducts(category) {
            // 更新按钮状态
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            renderProducts(category);
        }

        // 加入购物车
        function addToCart(productId) {
            const product = productsData.find(p => p.id === productId);
            cart.push(product);
            localStorage.setItem('cart', JSON.stringify(cart));
            alert(`${product.name} 已加入购物车`);
        }

        // 显示医院
        function showHospitals() {
            hideAllSections();
            document.getElementById('hospitalSection').style.display = 'block';
            currentSection = 'hospitals';
            
            // 先获取用户位置，再渲染医院
            getUserLocation(() => {
                calculateDistances();
                renderHospitals();
            });
            
            window.scrollTo(0, 0);
        }

        // 渲染医院
        function renderHospitals() {
            const grid = document.getElementById('hospitalGrid');
            grid.innerHTML = hospitalsData.map((hospital, index) => `
                <div class="hospital-card ${index === 0 ? 'nearest' : ''}">
                    ${index === 0 ? '<div style="background: #34c759; color: white; padding: 6px 12px; border-radius: 12px; font-size: 12px; font-weight: 600; margin-bottom: 10px; display: inline-block;">📍 最近</div>' : ''}
                    <div class="hospital-header">
                        <h3 class="hospital-name">${hospital.name}</h3>
                        <div class="hospital-rating">
                            ⭐ ${hospital.rating}
                        </div>
                    </div>
                    <div class="hospital-address">
                        📍 ${hospital.address}
                        ${hospital.distance !== null ? `<span style="color: #0071e3; font-weight: 600; margin-left: 8px;">(${hospital.distance.toFixed(1)}km)</span>` : '<span style="color: #86868b; margin-left: 8px;">(获取距离中...)</span>'}
                    </div>
                    <div class="hospital-phone">📞 ${hospital.phone}</div>
                    <div class="hospital-services">
                        ${hospital.services.map(service => `<span class="service-tag">${service}</span>`).join('')}
                    </div>
                    <div class="hospital-actions">
                        <button class="hospital-btn book-btn" onclick="bookHospital(${hospital.id})">预约挂号</button>
                        <button class="hospital-btn review-btn" onclick="reviewHospital(${hospital.id})">查看评价</button>
                        <button class="hospital-btn" style="background: #0071e3; color: white;" onclick="showHospitalOnMap(${hospital.id})">🗺️ 地图</button>
                    </div>
                    <div class="map-section" id="hospitalMap${hospital.id}" style="display: none;">
                        <div class="route-title">🗺️ ${hospital.name} 位置</div>
                        <div class="map-container">
                            <iframe 
                                id="map${hospital.id}"
                                class="map-iframe" 
                                src="https://www.openstreetmap.org/export/embed.html?bbox=${hospital.coordinates.lng-0.01},${hospital.coordinates.lat-0.01},${hospital.coordinates.lng+0.01},${hospital.coordinates.lat+0.01}&layer=mapnik&marker=${hospital.coordinates.lat},${hospital.coordinates.lng}"
                                allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                </div>
            `).join('');
        }
                    </div>
                    <div class="map-section" id="hospitalMap${hospital.id}">
                        <div class="map-container" id="map${hospital.id}"></div>
                        <div class="map-actions">
                            <button class="map-btn" onclick="navigateToHospital(${hospital.id})">🧭 导航前往</button>
                            <button class="map-btn" onclick="callHospital(${hospital.phone})">📞 拨打电话</button>
                        </div>
                        <div class="location-info" id="locationInfo${hospital.id}">
                            <strong>详细地址：</strong>${hospital.realAddress}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // 预约医院
        function bookHospital(hospitalId) {
            const hospital = hospitalsData.find(h => h.id === hospitalId);
            const phone = prompt(`请输入您的联系电话，${hospital.name}会主动联系您：`);
            if (phone) {
                const appointment = {
                    id: Date.now(),
                    hospitalId: hospitalId,
                    hospitalName: hospital.name,
                    customerPhone: phone,
                    status: 'pending',
                    createTime: new Date().toISOString()
                };
                appointments.push(appointment);
                localStorage.setItem('appointments', JSON.stringify(appointments));
                alert('预约成功！医院会尽快联系您确认时间。');
            }
        }

        // 查看评价
        function reviewHospital(hospitalId) {
            const hospital = hospitalsData.find(h => h.id === hospitalId);
            alert(`${hospital.name}\n\n⭐ 评分：${hospital.rating}/5.0\n\n用户评价精选：\n• 医生态度很好，专业负责\n• 价格透明，没有乱收费\n• 环境干净，设备先进\n• 24小时急诊很方便`);
        }

        // 显示论坛
        function showForum() {
            hideAllSections();
            document.getElementById('forumSection').style.display = 'block';
            currentSection = 'forum';
            renderForum('all');
            window.scrollTo(0, 0);
        }

        // 渲染论坛内容
        function renderForum(type) {
            const content = document.getElementById('forumContent');
            let posts = type === 'all' ? forumPostsData : 
                      type === 'hot' ? forumPostsData.filter(p => p.isHot) : 
                      forumPostsData.filter(p => p.type === type);
            
            // 排序：热门帖子在前
            posts.sort((a, b) => {
                if (type === 'hot') return b.likes - a.likes;
                if (type === 'all') return b.views - a.views;
                return b.id - a.id;
            });

            // 论坛统计
            const stats = {
                total: forumPostsData.length,
                today: forumPostsData.filter(p => p.time.includes('小时前')).length,
                hot: forumPostsData.filter(p => p.isHot).length
            };

            content.innerHTML = `
                <div class="forum-stats">
                    <div class="stat-item">
                        <div class="stat-number">${stats.total}</div>
                        <div class="stat-label">总帖子</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">${stats.today}</div>
                        <div class="stat-label">今日新帖</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">${stats.hot}</div>
                        <div class="stat-label">热门帖子</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">${posts.reduce((sum, p) => sum + p.likes, 0)}</div>
                        <div class="stat-label">总点赞</div>
                    </div>
                </div>
            ` + posts.map(post => `
                <div class="forum-post">
                    <div class="post-main">
                        <div class="author-section">
                            <div class="author-avatar">${post.avatar}</div>
                            <div class="author-name">${post.author}</div>
                            <div class="author-level">${post.level}</div>
                        </div>
                        <div class="post-content-main">
                            <h3 class="post-title" onclick="viewPostDetail(${post.id})">${post.title}</h3>
                            <div class="post-content">${post.content}</div>
                            <div class="post-meta">
                                <span class="post-type">${post.typeName}</span>
                                <span>🕐 ${post.time}</span>
                                <span>👁️ ${post.views} 浏览</span>
                            </div>
                            <div class="post-actions">
                                <div class="post-action" onclick="togglePostLike(${post.id})">
                                    <span>👍</span>
                                    <span>${post.likes}</span>
                                </div>
                                <div class="post-action" onclick="commentOnPost(${post.id})">
                                    <span>💬</span>
                                    <span>${post.comments}</span>
                                </div>
                                <div class="post-action" onclick="sharePost(${post.id})">
                                    <span>🔗</span>
                                    <span>分享</span>
                                </div>
                                <div class="post-action" onclick="collectPost(${post.id})">
                                    <span>⭐</span>
                                    <span>收藏</span>
                                </div>
                            </div>
                            ${post.latestComments && post.latestComments.length > 0 ? `
                                <div class="post-comment-preview">
                                    ${post.latestComments.map(comment => `
                                        <div class="comment-item">
                                            <span class="comment-author">${comment.author}:</span>
                                            ${comment.content}
                                        </div>
                                    `).join('')}
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // 切换论坛标签
        function switchForumTab(type) {
            document.querySelectorAll('.forum-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            renderForum(type);
        }

        // 查看帖子详情
        function viewPostDetail(postId) {
            const post = forumPostsData.find(p => p.id === postId);
            if (!post) return;
            
            alert(`帖子详情\n\n标题：${post.title.replace(/<[^>]*>/g, '')}\n\n作者：${post.author}\n时间：${post.time}\n\n${post.content.replace(/<[^>]*>/g, '')}\n\n👍 ${post.likes} 赞  💬 ${post.comments} 评论  👁️ ${post.views} 浏览`);
        }

        // 收藏帖子
        function collectPost(postId) {
            const post = forumPostsData.find(p => p.id === postId);
            alert(`已收藏帖子：${post.title.replace(/<[^>]*>/g, '')}\n\n您可以在个人中心查看收藏的帖子。`);
        }

        // 切换帖子点赞
        function togglePostLike(postId) {
            const post = forumPostsData.find(p => p.id === postId);
            if (!post) return;
            
            post.likes = post.liked ? Math.max(0, post.likes - 1) : post.likes + 1;
            post.liked = !post.liked;
            renderForum(getCurrentForumType());
        }

        // 获取当前论坛类型
        function getCurrentForumType() {
            const activeTab = document.querySelector('.forum-tab.active');
            if (activeTab.textContent.includes('全部')) return 'all';
            if (activeTab.textContent.includes('热门')) return 'hot';
            if (activeTab.textContent.includes('相亲')) return 'dating';
            if (activeTab.textContent.includes('经验')) return 'experience';
            if (activeTab.textContent.includes('求助')) return 'help';
            return 'all';
        }

        // 全局变量
        let selectedPostType = 'experience';
        let selectedImages = [];

        // 显示发布帖子模态框
        function showNewPostModal() {
            document.getElementById('postModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            // 重置表单
            document.getElementById('postTitle').value = '';
            document.getElementById('postContent').value = '';
            document.getElementById('titleCount').textContent = '0';
            document.getElementById('contentCount').textContent = '0';
            document.getElementById('imagePreview').innerHTML = '';
            document.getElementById('imagePreview').style.display = 'none';
            selectedImages = [];
            
            // 设置默认类型
            selectPostType(document.querySelector('.post-type-btn.active'));
            
            // 监听输入
            setupPostInputListeners();
        }

        // 关闭发帖模态框
        function closePostModal() {
            document.getElementById('postModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // 选择帖子类型
        function selectPostType(element) {
            document.querySelectorAll('.post-type-btn').forEach(btn => btn.classList.remove('active'));
            element.classList.add('active');
            selectedPostType = element.dataset.type;
            
            // 根据类型更新输入提示
            const titleInput = document.getElementById('postTitle');
            const contentInput = document.getElementById('postContent');
            
            const placeholders = {
                experience: {
                    title: '✍️ 分享你的养宠心得...',
                    content: '💝 分享你的精彩内容...&#10;&#10;📝 小贴士：&#10;• 分享猫咪护理经验&#10;• 介绍饲养技巧和心得&#10;• 推荐好用产品和方法'
                },
                dating: {
                    title: '💕 为你的爱猫寻找对象...',
                    content: '💝 分享你的精彩内容...&#10;&#10;📝 小贴士：&#10;• 介绍猫咪年龄、品种、性格&#10;• 说明对另一半的要求&#10;• 附上猫咪萌照效果更佳'
                },
                help: {
                    title: '❓ 寻求大家的帮助...',
                    content: '💝 分享你的精彩内容...&#10;&#10;📝 小贴士：&#10;• 详细描述遇到的问题&#10;• 说明已经尝试的解决方法&#10;• 提供必要的背景信息'
                },
                share: {
                    title: '📸 记录美好的养宠瞬间...',
                    content: '💝 分享你的精彩内容...&#10;&#10;📝 小贴士：&#10;• 分享猫咪的可爱日常&#10;• 记录有趣的互动瞬间&#10;• 晒出萌照和视频'
                }
            };
            
            const placeholder = placeholders[selectedPostType];
            titleInput.placeholder = placeholder.title;
            contentInput.placeholder = placeholder.content;
        }

        // 设置输入监听器
        function setupPostInputListeners() {
            const titleInput = document.getElementById('postTitle');
            const contentInput = document.getElementById('postContent');
            
            titleInput.addEventListener('input', function() {
                document.getElementById('titleCount').textContent = this.value.length;
            });
            
            contentInput.addEventListener('input', function() {
                document.getElementById('contentCount').textContent = this.value.length;
            });
        }

        // 选择图片
        function selectPostImages() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.multiple = true;
            input.max = '9';
            
            input.addEventListener('change', function(e) {
                handleImageSelection(e.target.files);
            });
            
            input.click();
        }

        // 处理图片选择
        function handleImageSelection(files) {
            const maxImages = 9;
            let newImages = Array.from(files).slice(0, maxImages - selectedImages.length);
            
            newImages.forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        selectedImages.push({
                            name: file.name,
                            url: e.target.result,
                            size: file.size
                        });
                        updateImagePreview();
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        // 更新图片预览
        function updateImagePreview() {
            const preview = document.getElementById('imagePreview');
            
            if (selectedImages.length === 0) {
                preview.style.display = 'none';
                return;
            }
            
            preview.style.display = 'block';
            preview.innerHTML = `
                <div style="font-size: 14px; color: #1d1d1f; margin-bottom: 10px; font-weight: 600;">
                    📷 已选择 ${selectedImages.length} 张图片
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px;">
                    ${selectedImages.map((img, index) => `
                        <div style="position: relative; aspect-ratio: 1; border-radius: 8px; overflow: hidden; border: 2px solid #f0f0f0;">
                            <img src="${img.url}" style="width: 100%; height: 100%; object-fit: cover;">
                            <button onclick="removeImage(${index})" style="position: absolute; top: -5px; right: -5px; width: 20px; height: 20px; border-radius: 50%; background: #ff3b30; color: white; border: none; cursor: pointer; font-size: 12px;">×</button>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // 移除图片
        function removeImage(index) {
            selectedImages.splice(index, 1);
            updateImagePreview();
        }

        // 提交新帖子
        function submitNewPost() {
            const title = document.getElementById('postTitle').value.trim();
            const content = document.getElementById('postContent').value.trim();
            
            if (!title) {
                alert('请输入帖子标题');
                return;
            }
            
            if (!content) {
                alert('请输入帖子内容');
                return;
            }
            
            if (title.length < 5) {
                alert('标题至少需要5个字');
                return;
            }
            
            if (content.length < 10) {
                alert('内容至少需要10个字');
                return;
            }
            
            const typeNames = {
                experience: '养宠经验',
                dating: '宠物相亲',
                help: '求助问答',
                share: '日常分享'
            };
            
            const newPost = {
                id: Date.now(),
                type: selectedPostType,
                typeName: typeNames[selectedPostType],
                title: title + (selectedImages.length > 0 ? ' <span class="new-tag">图</span>' : ''),
                content: content,
                author: currentUser.name,
                avatar: currentUser.avatar,
                level: currentUser.level,
                time: '刚刚',
                likes: 0,
                comments: 0,
                views: 0,
                isNew: true,
                latestComments: [],
                images: selectedImages.length > 0 ? selectedImages : null
            };
            
            // 保存到用户帖子列表
            const userPost = {
                ...newPost,
                status: 'published',
                createTime: new Date().toISOString()
            };
            userPosts.push(userPost);
            localStorage.setItem('userPosts', JSON.stringify(userPosts));
            
            // 保存到论坛帖子列表
            forumPosts.unshift(newPost);
            localStorage.setItem('forumPosts', JSON.stringify(forumPosts));
            
            // 添加到论坛数据用于显示
            forumPostsData.unshift(newPost);
            
            closePostModal();
            alert('🎉 帖子发布成功！大家可以看到你的帖子了');
            
            // 刷新论坛显示
            if (currentSection === 'forum') {
                renderForum(getCurrentForumType());
            }
        }

        // 隐藏所有区域
        function hideAllSections() {
            document.getElementById('catsSection').style.display = 'none';
            document.getElementById('shopSection').style.display = 'none';
            document.getElementById('hospitalSection').style.display = 'none';
            document.getElementById('forumSection').style.display = 'none';
        }

        // 显示商城订单
        function showShopOrders() {
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            if (cart.length === 0) {
                alert('购物车是空的');
                return;
            }
            
            let orderHtml = '🛒 购物车商品\n\n';
            let total = 0;
            cart.forEach((item, index) => {
                orderHtml += `${index + 1}. ${item.name} - ¥${item.price}\n`;
                total += item.price;
            });
            orderHtml += `\n总计: ¥${total}\n\n去结算请联系客服`;
            
            alert(orderHtml);
        }

        // 显示医院预约
        function showHospitalAppointments() {
            const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            if (appointments.length === 0) {
                alert('您还没有预约记录');
                return;
            }
            
            let aptHtml = '🏥 医院预约记录\n\n';
            appointments.forEach((apt, index) => {
                aptHtml += `${index + 1}. ${apt.hospitalName}\n`;
                aptHtml += `   电话: ${apt.customerPhone}\n`;
                aptHtml += `   状态: ${apt.status === 'pending' ? '待确认' : '已确认'}\n`;
                aptHtml += `   时间: ${new Date(apt.createTime).toLocaleString()}\n\n`;
            });
            
            alert(aptHtml);
        }

        // 地图初始化
        function initMap(containerId, coordinates, title) {
            try {
                // 尝试使用高德地图
                if (typeof AMap !== 'undefined') {
                    const map = new AMap.Map(containerId, {
                        zoom: 15,
                        center: [coordinates.lng, coordinates.lat]
                    });
                    
                    const marker = new AMap.Marker({
                        position: [coordinates.lng, coordinates.lat],
                        title: title,
                        map: map
                    });
                    
                    const infoWindow = new AMap.InfoWindow({
                        content: `<div style="padding: 10px;"><strong>${title}</strong></div>`
                    });
                    
                    marker.on('click', function() {
                        infoWindow.open(map, marker.getPosition());
                    });
                    
                    return map;
                }
            } catch (error) {
                console.log('地图初始化失败，使用备用方案');
            }
        }

        // 获取用户位置
        function getUserLocation(callback) {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        console.log('用户位置获取成功：', userLocation);
                        if (callback) callback();
                    },
                    (error) => {
                        console.log('位置获取失败：', error.message);
                        // 使用默认位置（杭州市中心）
                        userLocation = {
                            lat: 30.274084,
                            lng: 120.155069
                        };
                        if (callback) callback();
                    }
                );
            } else {
                // 浏览器不支持定位，使用默认位置
                userLocation = {
                    lat: 30.274084,
                    lng: 120.155069
                };
                if (callback) callback();
            }
        }

        // 计算距离
        function calculateDistances() {
            if (!userLocation) return;
            
            hospitalsData.forEach(hospital => {
                const distance = getDistance(
                    userLocation.lat, 
                    userLocation.lng, 
                    hospital.coordinates.lat, 
                    hospital.coordinates.lng
                );
                hospital.distance = distance;
            });
            
            // 按距离排序
            hospitalsData.sort((a, b) => a.distance - b.distance);
        }

        // 计算两点之间距离（千米）
        function getDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // 地球半径（千米）
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                      Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        }

        // 显示医院地图
        function showHospitalOnMap(hospitalId) {
            const hospital = hospitalsData.find(h => h.id === hospitalId);
            const mapSection = document.getElementById(`hospitalMap${hospitalId}`);
            
            // 切换地图显示
            if (mapSection.style.display === 'block') {
                mapSection.style.display = 'none';
                return;
            }
            
            // 隐藏其他地图
            document.querySelectorAll('.map-section').forEach(section => {
                section.style.display = 'none';
            });
            
            mapSection.style.display = 'block';
            
            // 滚动到地图位置
            setTimeout(() => {
                mapSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        }

        // 导航到医院
        function navigateToHospital(hospitalId) {
            const hospital = hospitalsData.find(h => h.id === hospitalId);
            
            if (userLocation) {
                // 高德地图导航
                const navUrl = `https://uri.amap.com/navigation?to=${hospital.coordinates.lng},${hospital.coordinates.lat},${hospital.name}&mode=car`;
                window.open(navUrl, '_blank');
            } else {
                // 备用方案：打开地图应用
                const mapUrl = `https://amap.com/search?query=${encodeURIComponent(hospital.realAddress)}`;
                window.open(mapUrl, '_blank');
            }
        }

        // 拨打医院电话
        function callHospital(phone) {
            if (confirm(`确定要拨打 ${phone} 吗？`)) {
                window.location.href = `tel:${phone}`;
            }
        }

        // 实时物流追踪
        function initLogisticsMap() {
            try {
                // 模拟物流路径点
                const logisticsPoints = [
                    { lng: 120.155069, lat: 30.274084, status: '发货点' },
                    { lng: 120.170843, lat: 30.276080, status: '中转站' },
                    { lng: 120.127629, lat: 30.262834, status: '配送中' },
                    { lng: 120.145777, lat: 30.289459, status: '目的地' }
                ];
                
                if (typeof AMap !== 'undefined') {
                    const map = new AMap.Map('logisticsMap', {
                        zoom: 12,
                        center: [120.155069, 30.274084]
                    });
                    
                    // 绘制路径
                    const path = logisticsPoints.map(point => [point.lng, point.lat]);
                    const polyline = new AMap.Polyline({
                        path: path,
                        strokeColor: '#0071e3',
                        strokeWeight: 4,
                        strokeStyle: 'solid'
                    });
                    map.add(polyline);
                    
                    // 添加标记点
                    logisticsPoints.forEach((point, index) => {
                        const marker = new AMap.Marker({
                            position: [point.lng, point.lat],
                            title: point.status,
                            map: map
                        });
                        
                        const infoWindow = new AMap.InfoWindow({
                            content: `<div style="padding: 10px;"><strong>${point.status}</strong></div>`
                        });
                        
                        marker.on('click', function() {
                            infoWindow.open(map, marker.getPosition());
                        });
                    });
                }
            } catch (error) {
                console.log('物流地图初始化失败');
            }
        }

        // 刷新物流信息
        function refreshLogistics() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '🔄 刷新中...';
            btn.disabled = true;
            
            // 模拟实时更新
            setTimeout(() => {
                const timeline = document.getElementById('logisticsTimeline');
                const newStatus = document.createElement('div');
                newStatus.className = 'logistics-item completed';
                newStatus.innerHTML = `
                    <div class="logistics-time">${new Date().toLocaleString()}</div>
                    <div class="logistics-text">物流信息已更新 - 实时位置：杭州市西湖区</div>
                `;
                
                timeline.insertBefore(newStatus, timeline.firstChild);
                
                btn.textContent = originalText;
                btn.disabled = false;
                
                // 重新初始化地图
                initLogisticsMap();
            }, 2000);
        }

        // 页面加载时从localStorage恢复数据
        function loadFromStorage() {
            const savedOrders = localStorage.getItem('orders');
            const savedMessages = localStorage.getItem('messages');
            const savedCart = localStorage.getItem('cart');
            const savedShopOrders = localStorage.getItem('shopOrders');
            const savedAppointments = localStorage.getItem('appointments');
            const savedForumPosts = localStorage.getItem('forumPosts');
            const savedUserPosts = localStorage.getItem('userPosts');
            const savedCatComments = localStorage.getItem('catComments');
            const savedPrivateMessages = localStorage.getItem('privateMessages');
            
            if (savedOrders) orders = JSON.parse(savedOrders);
            if (savedMessages) messages = JSON.parse(savedMessages);
            if (savedCart) cart = JSON.parse(savedCart);
            if (savedShopOrders) shopOrders = JSON.parse(savedShopOrders);
            if (savedAppointments) appointments = JSON.parse(savedAppointments);
            if (savedForumPosts) {
                forumPosts = JSON.parse(savedForumPosts);
                // 合并默认数据和用户发布的数据
                forumPosts.forEach(userPost => {
                    if (!forumPostsData.find(p => p.id === userPost.id)) {
                        forumPostsData.push(userPost);
                    }
                });
            }
            if (savedUserPosts) userPosts = JSON.parse(savedUserPosts);
            if (savedCatComments) catComments = JSON.parse(savedCatComments);
            if (savedPrivateMessages) privateMessages = JSON.parse(savedPrivateMessages);
            
            updateNotificationBadge();
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            init();
            loadFromStorage();
            getUserLocation(); // 获取用户位置（后台静默获取）
            
            // 设置默认显示猫咪区域
            document.getElementById('catsSection').style.display = 'block';
        });
    </script>
</body>
</html>